<!doctype html><html lang=ja><head><meta charset=UTF-8><meta content="width=device-width,initial-scale=1" name=viewport><link href=https://blog.ymgyt.io/favicon.ico rel=icon sizes=any><link href=https://blog.ymgyt.io/icon.svg rel=icon type=image/svg+xml><link href=https://blog.ymgyt.io/apple-touch-icon.png rel=apple-touch-icon><link href=https://blog.ymgyt.io/manifest.webmanifest rel=manifest><link href=https://blog.ymgyt.io/style.css rel=stylesheet><link href=https://blog.ymgyt.io/atom.xml rel=alternate title=Atom type=application/atom+xml><script src="https://www.googletagmanager.com/gtag/js?id=G-GTB0KMLN90" async></script><script>window.dataLayer = window.dataLayer || [];
	function gtag() {dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-GTB0KMLN90');</script><title>ğŸ¦€ Rustã®API Guidelinesã‚’èª­ã‚“ã§ã¿ã‚‹ | Happy developing</title><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><body><div class=world><div class=content-container><header class=blog-header-container><div class=blog-logo><a href=https://blog.ymgyt.io>Happy developing</a></div><div class=blog-nav><nav><ul><li><a href=https://blog.ymgyt.io/entry/>Entries</a><li><a href=https://blog.ymgyt.io/tags/>Tags</a><li><a href=https://blog.ymgyt.io/about/>About</a><li><a href=https://github.com/ymgyt> <img alt=Github class=icon src=https://blog.ymgyt.io/images/icon/github.svg> </a><li><a href="https://twitter.com/YAmaguchixt "> <img alt=Twitter class=icon src=https://blog.ymgyt.io/images/icon/twitter.svg> </a></ul></nav></div></header><main class=blog-main><article><header class=entry-header><h1 class=entry-title>ğŸ¦€ Rustã®API Guidelinesã‚’èª­ã‚“ã§ã¿ã‚‹</h1><div class=entry-meta><p class=entry-meta-item>ğŸ—“ 2022-07-25<p class=entry-meta-item>ğŸ· <span class=tag><a href=https://blog.ymgyt.io/tags/rust/>rust</a></span></div></header><aside class=entry-toc><nav><ul class=entry-toc-toplevel-list><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#guidelinesnowei-zhi-fu-ke>Guidelinesã®ä½ç½®ä»˜ã‘</a><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#naming>Naming</a> <ul><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#casing-conforms-to-rfc-430-c-case>Casing conforms to RFC 430 (C-CASE)</a><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#ad-hoc-conversions-follow-at-to-conventions-c-conv>Ad-hoc conversions follow at_,to_ conventions (C-CONV)</a><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#getter-names-follow-rust-convention-c-getter>Getter names follow Rust convention (C_GETTER)</a><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#methods-on-collections-that-produce-iterators-follow-iter-iter-mut-into-iter-c-iter>Methods on collections that produce iterators follow iter,iter_mut,into_iter (C-ITER)</a><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#feature-names-are-free-of-placeholder-words-c-feature>Feature names are free of placeholder words (C_FEATURE)</a><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#names-use-a-consistent-word-order-c-word-order>Names use a consistent word order (C-WORD_ORDER)</a></ul><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#interoperability>Interoperability</a> <ul><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#types-eagerly-implement-common-traits-c-common-traits>Types eagerly implement common traits (C-COMMON_TRAITS)</a><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#conversions-use-the-standard-traits-from-asref-asmut-c-conv-traits>Conversions use the standard traits From, AsRef, AsMut (C-CONV-TRAITS)</a><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#collections-implement-fromiterator-and-extend-c-collect>Collections implement FromIterator and Extend (C-COLLECT)</a><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#data-structures-implement-serde-s-serialize-deserialize-c-serde>Data structures implement Serde's Serialize, Deserialize (C-SERDE)</a><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#types-are-send-and-sync-where-possible-c-send-sync>Types are Send and Sync where possible (C-SEND_SYNC)</a><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#error-types-are-meaningful-and-well-behaved-c-good-err>Error types are meaningful and well-behaved (C-GOOD-ERR)</a><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#binary-number-types-provide-hex-octal-binary-formatting-c-num-fmt>Binary number types provide Hex, Octal, Binary formatting (C-NUM_FMT)</a><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#generic-reader-writer-functions-take-r-read-and-w-write-by-value-c-rw-value>Generic reader/writer functions take R: Read and W: Write by value (C-RW-VALUE)</a></ul><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#macros>Macros</a> <ul><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#input-syntax-is-evocative-of-the-output-c-evocative>Input syntax is evocative of the output (C-EVOCATIVE)</a><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#item-macros-compose-well-with-attributes-c-macro-attr>Item macros compose well with attributes (C-MACRO-ATTR)</a><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#item-macros-work-anywhere-that-items-are-allowed-c-anywhere>Item macros work anywhere that items are allowed (C-ANYWHERE)</a><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#item-macros-support-visibility-specifiers-c-macro-vis>Item macros support visibility specifiers (C-MACRO-VIS)</a><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#type-fragments-are-flexible-c-macro-ty>Type fragments are flexible (C-MACRO-TY)</a></ul><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#documentation>Documentation</a> <ul><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#crate-level-docs-are-thorough-and-include-examples-c-crate-doc>Crate level docs are thorough and include examples (C-CRATE-DOC)</a><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#all-items-have-a-rustdoc-example-c-example>All items have a rustdoc example (C-EXAMPLE)</a><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#examples-use-not-try-not-unwrap-c-question-mark>Examples use ?, not try!, not unwrap (C-QUESTION-MARK)</a><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#function-docs-include-error-panic-and-safety-considerations-c-failure>Function docs include error, panic, and safety considerations (C-FAILURE)</a><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#prose-contains-hyperlinks-to-relevant-things-c-link>Prose contains hyperlinks to relevant things (C-LINK)</a><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#cargo-toml-includes-all-common-metadata-c-metadata>Cargo.toml includes all common metadata (C-METADATA)</a><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#release-notes-document-all-significant-changes-c-relnotes>Release notes document all significant changes (C-RELNOTES)</a></ul><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#predictability>Predictability</a> <ul><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#smart-pointers-do-not-add-inherent-methods-c-smart-ptr>Smart pointers do not add inherent methods (C-SMART-PTR)</a><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#conversions-live-on-the-most-specific-type-involved-c-conv-specific>Conversions live on the most specific type involved (C-CONV-SPECIFIC)</a><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#functions-with-a-clear-receiver-are-methods-c-method>Functions with a clear receiver are methods (C-METHOD)</a><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#functions-do-not-take-out-parameters-c-no-out>Functions do not take out-parameters (C-NO-OUT)</a><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#operator-overloads-are-unsurprising-c-overload>Operator overloads are unsurprising (C-OVERLOAD)</a><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#only-smart-pointers-implement-deref-and-derefmut-c-deref>Only smart pointers implement Deref and DerefMut (C-DEREF)</a><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#constructors-are-static-inherent-methods-c-ctor>Constructors are static, inherent methods (C-CTOR)</a></ul><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#flexibility>Flexibility</a> <ul><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#functions-expose-intermediate-results-to-avoid-duplicate-work-c-intermediate>Functions expose intermediate results to avoid duplicate work (C-INTERMEDIATE)</a><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#caller-decides-where-to-copy-and-place-data-c-caller-control>Caller decides where to copy and place data (C-CALLER_CONTROL)</a><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#functions-minimize-assumptions-about-parameters-by-using-generics-c-generic>Functions minimize assumptions about parameters by using generics (C-GENERIC)</a><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#traits-are-object-safe-if-they-may-be-useful-as-a-trait-object-c-object>Traits are object-safe if they may be useful as a trait object (C-OBJECT)</a></ul><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#type-safety>Type safety</a> <ul><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#newtypes-provide-static-distinctions-c-newtype>Newtypes provide static distinctions (C-NEWTYPE)</a><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#arguments-convery-meaning-through-types-not-bool-or-option-c-custom-type>Arguments convery meaning through types, not bool or Option (C-CUSTOM-TYPE)</a><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#types-for-a-set-of-flags-are-bitflags-not-enums-c-bitflag>Types for a set of flags are bitflags, not enums (C-BITFLAG)</a><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#builders-enable-construction-of-complex-values-c-builder>Builders enable construction of complex values (C-BUILDER)</a></ul><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#dependability>Dependability</a> <ul><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#functions-validate-their-arguments-c-validate>Functions validate their arguments (C-VALIDATE)</a><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#destructors-never-fail-c-dtor-fail>Destructors never fail (C-DTOR-FAIL)</a><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#destructors-that-may-block-have-alternatives-c-dtor-block>Destructors that may block have alternatives (C-DTOR-BLOCK)</a></ul><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#debuggability>Debuggability</a> <ul><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#all-public-types-implement-debug-c-debug>All public types implement Debug (C-DEBUG)</a><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#debug-representation-is-never-empty-c-debug-nonempty>Debug representation is never empty (C-DEBUG-NONEMPTY)</a></ul><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#future-proofing>Future proofing</a> <ul><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#sealed-traits-protect-against-downstream-implementations-c-sealed>Sealed traits protect against downstream implementations (C-SEALED)</a><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#structs-have-private-fields-c-struct-private>Structs have private fields (C-STRUCT-PRIVATE)</a><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#newtypes-encapsulate-implementation-details-c-newtype-hide>Newtypes encapsulate implementation details (C-NEWTYPE-HIDE)</a><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#data-structures-do-not-duplicate-derived-trait-bound-c-struct-bounds>Data structures do not duplicate derived trait bound (C-STRUCT-BOUNDS)</a></ul><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#necessities>Necessities</a> <ul><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#public-dependencies-of-a-stable-crate-are-stable-c-stable>Public dependencies of a stable crate are stable (C-STABLE)</a><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#crate-and-its-dependencies-have-a-permissive-licence-c-permissive>Crate and its dependencies have a permissive licence (C-PERMISSIVE)</a></ul><li><a href=https://blog.ymgyt.io/entry/rust_api_guidelines/#matome>ã¾ã¨ã‚</a></ul></nav></aside><div class=entry-content><p>Rustã®ãƒ–ãƒ­ã‚°è¨˜äº‹ã§ã‚ˆãè¨€åŠã•ã‚Œã‚‹ã“ã¨ãŒå¤šã„ã®ã§ã€<a href=https://rust-lang.github.io/api-guidelines/ rel=external>API Guidelines</a>ã‚’èª­ã‚“ã§ã¿ã¾ã—ãŸã€‚<br> æœ¬Guidelinesã¯Rustã®library teamã«ã‚ˆã£ã¦ãƒ¡ãƒ³ãƒ†ã•ã‚Œã¦ã„ã‚‹ã¿ãŸã„ã§ã™ã€‚<h2 id=guidelinesnowei-zhi-fu-ke><a aria-label="Anchor link for: guidelinesnowei-zhi-fu-ke" class=zola-anchor href=#guidelinesnowei-zhi-fu-ke>Guidelinesã®ä½ç½®ä»˜ã‘</a></h2><p>æœ¬Guidelinesã®ä½ç½®ä»˜ã‘ã¯<a href=https://rust-lang.github.io/api-guidelines/about.html rel=external>About</a>ã§è¿°ã¹ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚<blockquote><p>These guidelines should not in any way be considered a mandate that crate authors must follow, though they may find that crates that conform well to these guidelines integrate better with the existing crate ecosystem than those that do not.</blockquote><p>å¼·åˆ¶ã§ã¯ãªã„ãŒã€Guidelinesã«æ²¿ã£ã¦ãŠãã“ã¨ã§æ—¢å­˜ã®ecosystemã¨ã‚ˆãé¦´æŸ“ã‚€ã¨ã„ã†ãã‚‰ã„ã®ãƒ‹ãƒ¥ã‚¢ãƒ³ã‚¹ã§ã—ã‚‡ã†ã‹ã€‚<h2 id=naming><a aria-label="Anchor link for: naming" class=zola-anchor href=#naming><a href=https://rust-lang.github.io/api-guidelines/naming.html#naming rel=external>Naming</a></a></h2><p>å‘½åè¦å‰‡ã«ã¤ã„ã¦ã€‚é›°å›²æ°—ã§æ±ºã‚ã¦ã„ã¾ã—ãŸãŒã“ã†ã‚„ã£ã¦è¨€èªåŒ–ã—ã¦ãã‚Œã¦ã„ã‚‹ã®ã¯éå¸¸ã«åŠ©ã‹ã‚Šã¾ã™ã€‚<br> ã¨ãã«è¤‡æ•°äººé–‹ç™ºã§ã€å‘½åãŒã¶ã‚Œã¦ããŸã¨ãã«å¥½ã¿ã§ã¯ãªãã“ã®ã‚ãŸã‚Šã‚’å‚ç…§ã—ã¦è­°è«–ã—ã¦ã¿ã‚‹ã¨è‰¯ã„ã®ã§ã¯ãªã„ã§ã—ã‚‡ã†ã‹ã€‚<h3 id=casing-conforms-to-rfc-430-c-case><a aria-label="Anchor link for: casing-conforms-to-rfc-430-c-case" class=zola-anchor href=#casing-conforms-to-rfc-430-c-case><a href=https://rust-lang.github.io/api-guidelines/naming.html#casing-conforms-to-rfc-430-c-case rel=external>Casing conforms to RFC 430 (C-CASE)</a></a></h3><p>moduleã¯<code>snake_case</code>ã§å‹ã¯<code>UpperCamelCase</code>ã®ã‚ˆã†ãªå‘½åè¦å‰‡ã«ã¤ã„ã¦è¿°ã¹ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚<br> ä¸€èˆ¬çš„ã«ã¯å‹ã®æ–‡è„ˆã§ã¯<code>UpperCamelCase</code>ã€å€¤ã®æ–‡è„ˆã§ã¯<code>snake_case</code>ã¨èª¬æ˜ã•ã‚Œã¦ãŠã‚Šãªã‚‹ã»ã©ã¨æ€ã„ã¾ã—ãŸã€‚<p>UUIDã‚„HTMLã¨ã„ã£ãŸacronymsã¯<code>Uuid</code>,<code>Html</code>ã®ã‚ˆã†ã«æ›¸ãã‚ˆã†ã«è¨€ã‚ã‚Œã¦ã„ã¾ã™ã€‚<br> Goã§ã¯ã€<code>HTML</code>ã®ã‚ˆã†ã«å¤§æ–‡å­—ãªã®ã§æœ€åˆã¯é•å’Œæ„Ÿã‚ã£ãŸã®ã§ã™ãŒã€ä»Šã§ã¯UpperCamelCaseã®ã»ã†ãŒè‡ªç„¶ã«æ„Ÿã˜ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚å®Ÿç”¨çš„ãªæ„å‘³ã§ã‚‚ã€ã‚³ãƒ¼ãƒ‰ç”Ÿæˆã®æ–‡è„ˆã§ã¯<code>UpperCamelCase</code>ã®ã»ã†ãŒã‚ˆã„ã¨è€ƒãˆã¦ã„ã¾ã™ã€‚ç‰¹ã«å¤šè¨€èªã‚„protobuf,sqlç­‰ã‹ã‚‰ã®å¤‰æ›ã§ã¯ã€<code>html_parser</code>ã‚’<code>HTMLParser</code>ã®ã‚ˆã†ã«ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã€ãªã‚“ã‚‰ã‹ã®æ–¹æ³•ã§<code>HTML</code>ã‚„<code>UUID</code>ã‚’ç‰¹åˆ¥æ‰±ã„ã™ã‚‹ä»•çµ„ã¿ãŒå¿…è¦ã«ãªã‚Šã€gormãªã‚“ã‹ã¯è‡ªå‰ã§è¾æ›¸ã‚’ãƒ¡ãƒ³ãƒ†ã—ã¦ã„ãŸã‚Šã—ã¦ã„ã¾ã—ãŸã€‚<p>æ„å¤–ãªã®ãŒã€å°‚ã‚‰libraryã‚’æ›¸ãäººå‘ã‘ã®Guidelinesã§libraryã®top levelã§ã‚ã‚‹cratesã«ã¤ã„ã¦ã¯<a href=https://github.com/rust-lang/api-guidelines/issues/29 rel=external>unclear</a>ã«ãªã£ã¦ã„ãŸç‚¹ã§ã—ãŸã€‚(ãŸã ã—å‚ç…§ã•ã‚Œã¦ã„ã‚‹<a href=https://github.com/rust-lang/rfcs/blob/master/text/0430-finalizing-naming-conventions.md rel=external>RFC 430</a>ã§ã¯, <code>snake_case</code> (but prefer single word)ã¨ã•ã‚Œã¦ã„ã¾ã™)<br> å€‹äººçš„ã«ã¯ã€packageã¯"-"ã€crateã¯"_"ã‚’ä½¿ã†ã®ãŒã„ã„ã‹ãªã¨æ€ã£ã¦ãŠã‚Šã¾ã™ã€‚<h3 id=ad-hoc-conversions-follow-at-to-conventions-c-conv><a aria-label="Anchor link for: ad-hoc-conversions-follow-at-to-conventions-c-conv" class=zola-anchor href=#ad-hoc-conversions-follow-at-to-conventions-c-conv><a href=https://rust-lang.github.io/api-guidelines/naming.html#ad-hoc-conversions-follow-as_-to_-into_-conventions-c-conv rel=external>Ad-hoc conversions follow <code>at_</code>,<code>to_</code> conventions (C-CONV)</a></a></h3><p><code>as_</code>,<code>to_</code>,<code>into_</code>ã®ä½¿ã„åˆ†ã‘ã«é–¢ã™ã‚‹guideã€‚ownershipã¨å®Ÿè¡Œã‚³ã‚¹ãƒˆã®è¦³ç‚¹ã‹ã‚‰ä½¿ã„åˆ†ã‘ã‚‰ã‚Œã¦ãŠã‚Šã¾ã™ã€‚ä¾‹ãˆã°ã€<code>Path</code>ã‹ã‚‰<code>str</code>ã¯borrowed -> borrowedãªã®ã§ã™ãŒã€OSã®pathåã¯utf8ã§ã‚ã‚‹ä¿è¨¼ãŒãªã„ã®ã§ã€<code>str</code>å¤‰æ›æ™‚ã«ç¢ºèªå‡¦ç†ãŒã¯ã„ã‚‹ã®ã§ã€ã“ã®å¤‰æ›ã¯<a href=https://doc.rust-lang.org/std/path/struct.Path.html#method.to_str rel=external><code>Path::to_str</code></a>ã«ãªã‚Šã¾ã™ã€‚<br> ã“ã®ç‚¹ã‚’å«Œã£ã¦ã‹ã€UTF-8ã®<code>Path</code>å‹ã‚’æä¾›ã™ã‚‹<a href=https://github.com/camino-rs/camino rel=external><code>camino</code></a>ãŒã‚ã‚Šã¾ã™ã€‚<br> <a href=https://github.com/camino-rs/camino rel=external><code>camino</code></a>ã§ã¯ã€<code>Path::to_str() -> Option&lt;&str></code>ãŒã€<a href=https://docs.rs/camino/1.0.9/camino/struct.Utf8Path.html#method.as_str rel=external><code>Utf8Path::as_str() -> &str</code></a>ã«ãªã£ã¦ã„ã¾ã™ã€‚<p><code>into_</code>ã«ã¤ã„ã¦ã¯costã¯é«˜ã„å ´åˆã¨ä½ã„å ´åˆä¸¡æ–¹ã‚ã‚Šå¾—ã¾ã™ã€‚<br> ä¾‹ãˆã°ã€<a href=https://doc.rust-lang.org/std/string/struct.String.html#method.into_bytes rel=external><code>String::into_bytes()</code></a>ã¯å†…éƒ¨çš„ã«ä¿æŒã—ã¦ã„ã‚‹<code>Vec&lt;u8></code>ã‚’è¿”ã™ã ã‘ãªã®ã§ä½ã„ã®ã§ã™ãŒã€<a href=https://doc.rust-lang.org/std/io/struct.BufWriter.html#method.into_inner rel=external><code>BufWriter::into_inner()</code></a>ã¯bufferã•ã‚Œã¦ã„ã‚‹dataã‚’æ›¸ãè¾¼ã‚€å‡¦ç†ãŒèµ°ã‚‹ã®ã§é‡ãŸã„å‡¦ç†ã«ãªã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚<p>ã¾ãŸã€<code>as_</code>ã¨<code>into_</code>ã¯å†…éƒ¨çš„ã«ä¿æŒã—ã¦ã„ã‚‹ãƒ‡ãƒ¼ã‚¿ã«å¤‰æ›ã™ã‚‹ã®ã§æŠ½è±¡åº¦ã‚’ä¸‹ã’ã‚‹åƒããŒã‚ã‚‹ä¸€æ–¹ã§ã€<code>to_</code>ã¯ãã®é™ã‚Šã§ãªã„ã¨ã„ã†èª¬æ˜ãŒãŠã‚‚ã—ã‚ã‹ã£ãŸã§ã™ã€‚<h3 id=getter-names-follow-rust-convention-c-getter><a aria-label="Anchor link for: getter-names-follow-rust-convention-c-getter" class=zola-anchor href=#getter-names-follow-rust-convention-c-getter><a href=https://rust-lang.github.io/api-guidelines/naming.html#getter-names-follow-rust-convention-c-getter rel=external>Getter names follow Rust convention (C_GETTER)</a></a></h3><p>structã®fieldã®å–å¾—ã¯ã€<code>get_field</code>ã§ã¯ãªãã€<code>field</code>ã¨ãã®ã¾ã¾ä½¿ãŠã†ã¨ã„ã†ã“ã¨ã€‚<br> ãŸã ã—ã€<a href=https://doc.rust-lang.org/std/cell/struct.Cell.html#method.get rel=external><code>Cell::get</code></a>ã®ã‚ˆã†ã«<code>get</code>ã®å¯¾è±¡ãŒæ˜ç¢ºãªã¨ãã¯ã€<code>get</code>ã‚’ä½¿ã„ã¾ã™ã€‚<br> ã¾ãŸã€getterã®ä¸­ã§ãªã‚“ã‚‰ã‹ã®validationã‚’ã—ã¦ã„ã‚‹éš›ã¯ã€<code>unsafe fn get_unchecked(&self)</code>ã®variantsã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã‚‚ææ¡ˆã•ã‚Œã¦ã„ã¾ã™ã€‚<h3 id=methods-on-collections-that-produce-iterators-follow-iter-iter-mut-into-iter-c-iter><a aria-label="Anchor link for: methods-on-collections-that-produce-iterators-follow-iter-iter-mut-into-iter-c-iter" class=zola-anchor href=#methods-on-collections-that-produce-iterators-follow-iter-iter-mut-into-iter-c-iter><a href=https://rust-lang.github.io/api-guidelines/naming.html#methods-on-collections-that-produce-iterators-follow-iter-iter_mut-into_iter-c-iter rel=external>Methods on collections that produce iterators follow <code>iter</code>,<code>iter_mut</code>,<code>into_iter</code> (C-ITER)</a></a></h3><p>collectionã®elementã®å‹ãŒ<code>T</code>ã ã£ãŸã¨ã—ãŸã¨ãã«ã€<code>Iterator</code>ã‚’è¿”ã™methodã®signatureã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ã—ã‚ˆã†ã¨ã„ã†ã“ã¨ã€‚<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=rust><span class=giallo-l><span style=color:#81a1c1>fn</span><span style=color:#88c0d0> iter</span><span style=color:#eceff4>(</span><span style=color:#81a1c1>&self</span><span style=color:#eceff4>)</span><span style=color:#81a1c1> -> impl</span><span style=color:#8fbcbb> Iterator</span><span style=color:#eceff4>&lt;</span><span style=color:#8fbcbb>Item</span><span style=color:#81a1c1> = &</span><span style=color:#8fbcbb>T</span><span style=color:#eceff4>> {}</span></span>
<span class=giallo-l><span style=color:#81a1c1>fn</span><span style=color:#88c0d0> iter_mut</span><span style=color:#eceff4>(</span><span style=color:#81a1c1>&mut self</span><span style=color:#eceff4>)</span><span style=color:#81a1c1> -> impl</span><span style=color:#8fbcbb> Iterator</span><span style=color:#eceff4>&lt;</span><span style=color:#8fbcbb>Item</span><span style=color:#81a1c1> = &mut</span><span style=color:#8fbcbb> T</span><span style=color:#eceff4>> {}</span></span>
<span class=giallo-l><span style=color:#81a1c1>fn</span><span style=color:#88c0d0> into_iter</span><span style=color:#eceff4>(</span><span style=color:#81a1c1>self</span><span style=color:#eceff4>)</span><span style=color:#81a1c1> -> impl</span><span style=color:#8fbcbb> Iterator</span><span style=color:#eceff4>&lt;</span><span style=color:#8fbcbb>Item</span><span style=color:#81a1c1> =</span><span style=color:#8fbcbb> T</span><span style=color:#eceff4>> {}</span></span></code></pre><p>ãŸã ã—ã€ã“ã®guideã¯æ¦‚å¿µçš„ã«åŒç¨®(conceptually homogeneous)ãªcollectionã«ã‚ã¦ã¯ã¾ã‚‹ã¨ã•ã‚Œã€<code>str</code>ã¯ãã®é™ã‚Šã§ãªã„ã®ã§ã€<code>iter_</code>ã§ã¯ãªãã€<a href=https://doc.rust-lang.org/std/primitive.str.html#method.bytes rel=external><code>str::bytes</code></a>ã‚„<a href=https://doc.rust-lang.org/std/primitive.str.html#method.chars rel=external><code>str::chars</code></a>ãŒæä¾›ã•ã‚Œã¦ã„ã‚‹ä¾‹ãŒç´¹ä»‹ã•ã‚Œã¦ã„ã¾ã™ã€‚<p>ã¾ãŸã€é©ç”¨ç¯„å›²ã¯methodãªã®ã§ã€iteratorã‚’è¿”ã™functionã«ã¯å½“ã¦ã¯ã¾ã‚‰ãªã„ã¨ã‚‚æ›¸ã‹ã‚Œã¦ã„ã¾ã™ã€‚ åŠ ãˆã¦ã€iteratorã®å‹ã¯ãã‚Œã‚’è¿”ã™methodã«åˆè‡´ã—ãŸã‚‚ã®ã«ã™ã‚‹ã“ã¨ã‚‚<a href=https://rust-lang.github.io/api-guidelines/naming.html#iterator-type-names-match-the-methods-that-produce-them-c-iter-ty rel=external>Iterator type names match the methods that produce them (C-ITER_TY)</a>ã§æ›¸ã‹ã‚Œã¦ã„ã¾ã™ã€‚(<code>into_iter()</code>ã¯<code>IntoIter</code>å‹ã‚’è¿”ã™)<br> ã“ã®ç‚¹ã«ã¤ã„ã¦ã¯ã€existential typeã§, <code>impl Iterator&lt;Item=T></code>ã®ã‚ˆã†ã«ã—ã¦å…·ä½“å‹ã‚’éš è”½ã™ã‚‹æ–¹æ³•ã‚‚ã‚ã‚‹ã¨æ€ã†ã®ã§ã™ãŒã€ã©ã¡ã‚‰ãŒã‚ˆã„ã®ã‹ãªã¨æ€ã„ã¾ã—ãŸã€‚<h3 id=feature-names-are-free-of-placeholder-words-c-feature><a aria-label="Anchor link for: feature-names-are-free-of-placeholder-words-c-feature" class=zola-anchor href=#feature-names-are-free-of-placeholder-words-c-feature><a href=https://rust-lang.github.io/api-guidelines/naming.html#feature-names-are-free-of-placeholder-words-c-feature rel=external>Feature names are free of placeholder words (C_FEATURE)</a></a></h3><p>feature <code>abc</code>ã‚’<code>use-abc</code>ã‚„<code>with-abc</code>ã®ã‚ˆã†ã«ã—ãªã„ã“ã¨ã€‚<br> ã¾ãŸã€featureã¯additiveãªã®ã§ã€<code>no-abc</code>ã¨ã„ã£ãŸæ©Ÿèƒ½ã‚’åˆ©ç”¨ã—ãªã„å½¢ã§ã®featureã«ã—ãªã„ã“ã¨ã€‚<h3 id=names-use-a-consistent-word-order-c-word-order><a aria-label="Anchor link for: names-use-a-consistent-word-order-c-word-order" class=zola-anchor href=#names-use-a-consistent-word-order-c-word-order><a href=https://rust-lang.github.io/api-guidelines/naming.html#names-use-a-consistent-word-order-c-word-order rel=external>Names use a consistent word order (C-WORD_ORDER)</a></a></h3><p><code>JoinPathsError</code>, <code>ParseIntError</code>ã®ã‚ˆã†ãªã‚¨ãƒ©ãƒ¼å‹ã‚’å®šç¾©ã—ã¦ã„ãŸãªã‚‰ã€addressã®parseã«å¤±æ•—ã—ãŸå ´åˆã®ã‚¨ãƒ©ãƒ¼ã¯<code>ParseAddrError</code>ã«ã™ã‚‹ã€‚(<code>AddrParseError</code>ã§ã¯ãªã„)<br> verb-object-errorã¨ã„ã†é †ç•ªã«ã™ã‚‹ã¨ã„ã†guideã§ã¯ãªãã€crateå†…ã§ä¸€è²«æ€§ã‚’ã‚‚ãŸã›ã‚ˆã†ã¨ã„ã†ã“ã¨ã€‚<h2 id=interoperability><a aria-label="Anchor link for: interoperability" class=zola-anchor href=#interoperability><a href=https://rust-lang.github.io/api-guidelines/interoperability.html rel=external>Interoperability</a></a></h2><p>ç›´è¨³ã™ã‚‹ã¨ç›¸äº’é‹ç”¨æ€§ã‚‰ã—ã„ã®ã§ã™ãŒã€ã„ã¾ã„ã¡ãƒ”ãƒ³ã¨ã“ãšã€‚ecosystemã¨ã®è¦ªå’Œæ€§ã¿ãŸã„ãªãƒ‹ãƒ¥ã‚¢ãƒ³ã‚¹ãªã®ã§ã—ã‚‡ã†ã‹ã€‚<h3 id=types-eagerly-implement-common-traits-c-common-traits><a aria-label="Anchor link for: types-eagerly-implement-common-traits-c-common-traits" class=zola-anchor href=#types-eagerly-implement-common-traits-c-common-traits><a href=https://rust-lang.github.io/api-guidelines/interoperability.html#types-eagerly-implement-common-traits-c-common-traits rel=external>Types eagerly implement common traits (C-COMMON_TRAITS)</a></a></h3><p>Rustã®orphan ruleã«ã‚ˆã£ã¦ã€åŸºæœ¬çš„ã«ã¯<code>impl</code>ã¯ãã®å‹ã‚’å®šç¾©ã—ã¦ã„ã‚‹crateã‹å®Ÿè£…ã—ã‚ˆã†ã¨ã—ã¦ã„ã‚‹traitå´ã«ãªã‘ã‚Œã°ã„ã‘ãªã„ã€‚<br> ã—ãŸãŒã£ã¦ã€ãƒ¦ãƒ¼ã‚¶ãŒå®šç¾©ã—ãŸå‹ã«ã¤ã„ã¦stdã§å®šç¾©ã•ã‚Œã¦ã„ã‚‹traitã¯å½“è©²crateã§ã—ã‹å®šç¾©ã§ããªã„ã€‚<br> ä¾‹ãˆã°ã€<code>url::Url</code>ãŒ<code>std::fmt::Display</code>ã‚’<code>impl</code>ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã€applicationå´ã§<code>Url</code>ã«<code>Display</code>ã‚’å®šç¾©ã™ã‚‹ã“ã¨ã¯ã§ããªã„ã€‚<p>ã“ã®ç‚¹ã«ã¤ã„ã¦ã¯<a href=https://blog.ymgyt.io/entry/books/rust_for_rustaceans rel=external>RUST FOR RUSTACEANS</a>ã§ã‚‚è¿°ã¹ã‚‰ã‚Œã¦ã„ã¾ã—ãŸã€‚<br> featureã§serdeã®Serializeç­‰ã‚’è¿½åŠ ã§ãã‚‹ã‚ˆã†ã«ã—ã¦ã‚ã‚‹crateãªã‚“ã‹ã‚‚ã‚ã‚‹ãªãƒ¼ã¨æ€ã£ã¦ã„ãŸã‚‰(C-SERDE)ã§è¿°ã¹ã‚‰ã‚Œã¦ã„ã¾ã—ãŸã€‚<h3 id=conversions-use-the-standard-traits-from-asref-asmut-c-conv-traits><a aria-label="Anchor link for: conversions-use-the-standard-traits-from-asref-asmut-c-conv-traits" class=zola-anchor href=#conversions-use-the-standard-traits-from-asref-asmut-c-conv-traits><a href=https://rust-lang.github.io/api-guidelines/interoperability.html#conversions-use-the-standard-traits-from-asref-asmut-c-conv-traits rel=external>Conversions use the standard traits <code>From</code>, <code>AsRef</code>, <code>AsMut</code> (C-CONV-TRAITS)</a></a></h3><p><code>From</code>,<code>TryFrom</code>,<code>AsRef</code>,<code>AsMut</code>ã¯å¯èƒ½ãªã‚‰å®Ÿè£…ã—ã¦ã‚ã‚‹ã¨ã‚ˆã„ã€‚<code>Into</code>ã¨<code>TryInto</code>ã¯<code>From</code>å´ã«blanket implãŒã‚ã‚‹ã®ã§å®Ÿè£…ã—ãªã„ã“ã¨ã€‚<br> <code>u32</code>ã¨<code>u16</code>ã®ã‚ˆã†ã«å®‰å…¨ã«å¤‰æ›ã§ãã‚‹å ´åˆã¨ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹å¤‰æ›ãŒã‚ã‚‹å ´åˆã¯ã€ãã‚Œãã‚Œ<code>From</code>ã¨<code>TryFrom</code>ã§è¡¨ç¾ã§ãã‚‹ã€‚<h3 id=collections-implement-fromiterator-and-extend-c-collect><a aria-label="Anchor link for: collections-implement-fromiterator-and-extend-c-collect" class=zola-anchor href=#collections-implement-fromiterator-and-extend-c-collect><a href=https://rust-lang.github.io/api-guidelines/interoperability.html#collections-implement-fromiterator-and-extend-c-collect rel=external>Collections implement <code>FromIterator</code> and <code>Extend</code> (C-COLLECT)</a></a></h3><p>collectionã‚’å®šç¾©ã—ãŸã‚‰ã€<code>FromIterator</code>ã¨<code>Extend</code>ã‚’å®šç¾©ã—ã¦ãŠãã€‚<h3 id=data-structures-implement-serde-s-serialize-deserialize-c-serde><a aria-label="Anchor link for: data-structures-implement-serde-s-serialize-deserialize-c-serde" class=zola-anchor href=#data-structures-implement-serde-s-serialize-deserialize-c-serde><a href=https://rust-lang.github.io/api-guidelines/interoperability.html#data-structures-implement-serdes-serialize-deserialize-c-serde rel=external>Data structures implement Serde's <code>Serialize</code>, <code>Deserialize</code> (C-SERDE)</a></a></h3><p>data structureã®å½¹å‰²ã‚’æ‹…ã†å‹ã¯<code>Serialize</code>ã¨<code>Deserialize</code>ã‚’å®Ÿè£…ã™ã‚‹ã€‚<br> ã‚ã‚‹å‹ãŒdata structureã‹ã©ã†ã‹ã¯å¿…ãšã—ã‚‚æ˜ç¢ºã§ãªã„å ´åˆãŒã‚ã‚‹ãŒã€<code>LinkedHashMap</code>ã‚„<code>IpAddr</code>ã‚’Jsonã‹ã‚‰èª­ã‚“ã ã‚Šã€ãƒ—ãƒ­ã‚»ã‚¹é–“é€šä¿¡ã§åˆ©ç”¨ã§ãã‚‹ã‚ˆã†ã«ã—ã¦ãŠãã®ã¯ç†ã«ã‹ãªã£ã¦ã„ã‚‹ã€‚<br> å®Ÿè£…ã‚’featureã«ã—ã¦ãŠãã“ã¨ã§ã€downstreamå´ã§å¿…è¦ãªã¨ãã«ã‚³ã‚¹ãƒˆã‚’æ‰•ã†ã“ã¨ãŒã§ãã‚‹ã«å®Ÿè£…ã™ã‚‹ã“ã¨ã‚‚ã§ãã‚‹ã€‚<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=toml><span class=giallo-l><span style=background-color:#bf616a>dependencies]</span></span>
<span class=giallo-l><span>serde</span><span style=color:#eceff4> = {</span><span> version</span><span style=color:#eceff4> = "</span><span style=color:#a3be8c>1.0</span><span style=color:#eceff4>",</span><span> optional</span><span style=color:#eceff4> =</span><span style=color:#81a1c1> true</span><span style=color:#eceff4> }</span></span></code></pre><pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=rust><span class=giallo-l><span style=color:#81a1c1>pub struct</span><span style=color:#8fbcbb> T</span><span style=color:#eceff4> {</span><span style=color:#616e88> /* ... */</span><span style=color:#eceff4> }</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#5e81ac>#[cfg(feature = "</span><span style=color:#a3be8c>serde</span><span style=color:#5e81ac>")]</span></span>
<span class=giallo-l><span style=color:#81a1c1>impl</span><span style=color:#8fbcbb> Serialize</span><span style=color:#81a1c1> for</span><span style=color:#8fbcbb> T</span><span style=color:#eceff4> {</span><span style=color:#616e88> /* ... */</span><span style=color:#eceff4> }</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#5e81ac>#[cfg(feature = "</span><span style=color:#a3be8c>serde</span><span style=color:#5e81ac>")]</span></span>
<span class=giallo-l><span style=color:#81a1c1>impl</span><span style=color:#eceff4>&lt;'</span><span style=color:#8fbcbb>de</span><span style=color:#eceff4>></span><span style=color:#8fbcbb> Deserialize</span><span style=color:#eceff4>&lt;'</span><span style=color:#8fbcbb>de</span><span style=color:#eceff4>></span><span style=color:#81a1c1> for</span><span style=color:#8fbcbb> T</span><span style=color:#eceff4> {</span><span style=color:#616e88> /* ... */</span><span style=color:#eceff4> }</span></span></code></pre><p>ã®ã‚ˆã†ã«ã—ãŸã‚Šã€deriveã‚’åˆ©ç”¨ã™ã‚‹å ´åˆã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ã§ãã‚‹ã€‚<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=toml><span class=giallo-l><span style=color:#eceff4>[</span><span>dependencies</span><span style=color:#eceff4>]</span></span>
<span class=giallo-l><span>serde</span><span style=color:#eceff4> = {</span><span> version</span><span style=color:#eceff4> = "</span><span style=color:#a3be8c>1.0</span><span style=color:#eceff4>",</span><span> optional</span><span style=color:#eceff4> =</span><span style=color:#81a1c1> true</span><span style=color:#eceff4>,</span><span> features</span><span style=color:#eceff4> = ["</span><span style=color:#a3be8c>derive</span><span style=color:#eceff4>"] }</span></span></code></pre><pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=rust><span class=giallo-l><span style=color:#5e81ac>#[cfg_attr(feature = "</span><span style=color:#a3be8c>serde</span><span style=color:#5e81ac>", derive(</span><span style=color:#8fbcbb>Serialize</span><span style=color:#5e81ac>,</span><span style=color:#8fbcbb> Deserialize</span><span style=color:#5e81ac>))]</span></span>
<span class=giallo-l><span style=color:#81a1c1>pub struct</span><span style=color:#8fbcbb> T</span><span style=color:#eceff4> {</span><span style=color:#616e88> /* ... */</span><span style=color:#eceff4> }</span></span></code></pre><h3 id=types-are-send-and-sync-where-possible-c-send-sync><a aria-label="Anchor link for: types-are-send-and-sync-where-possible-c-send-sync" class=zola-anchor href=#types-are-send-and-sync-where-possible-c-send-sync><a href=https://rust-lang.github.io/api-guidelines/interoperability.html#types-are-send-and-sync-where-possible-c-send-sync rel=external>Types are <code>Send</code> and <code>Sync</code> where possible (C-SEND_SYNC)</a></a></h3><p><code>Send</code>ã¨<code>Sync</code>ã¯compilerãŒè‡ªå‹•ã§å®Ÿè£…ã™ã‚‹ã®ã§ã€å¿…è¦ãªã‚‰ä»¥ä¸‹ã®ãƒ†ã‚¹ãƒˆã‚’æ›¸ã„ã¦ãŠãã€‚<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=rust><span class=giallo-l><span style=color:#5e81ac>#[test]</span></span>
<span class=giallo-l><span style=color:#81a1c1>fn</span><span style=color:#88c0d0> test_send</span><span style=color:#eceff4>() {</span></span>
<span class=giallo-l><span style=color:#81a1c1>    fn</span><span style=color:#88c0d0> assert_send</span><span style=color:#eceff4>&lt;</span><span style=color:#8fbcbb>T</span><span style=color:#81a1c1>:</span><span style=color:#8fbcbb> Send</span><span style=color:#eceff4>>() {}</span></span>
<span class=giallo-l><span style=color:#88c0d0>    assert_send</span><span style=color:#81a1c1>::</span><span style=color:#eceff4>&lt;</span><span style=color:#8fbcbb>MyStrangeType</span><span style=color:#eceff4>>();</span></span>
<span class=giallo-l><span style=color:#eceff4>}</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#5e81ac>#[test]</span></span>
<span class=giallo-l><span style=color:#81a1c1>fn</span><span style=color:#88c0d0> test_sync</span><span style=color:#eceff4>() {</span></span>
<span class=giallo-l><span style=color:#81a1c1>    fn</span><span style=color:#88c0d0> assert_sync</span><span style=color:#eceff4>&lt;</span><span style=color:#8fbcbb>T</span><span style=color:#81a1c1>:</span><span style=color:#8fbcbb> Sync</span><span style=color:#eceff4>>() {}</span></span>
<span class=giallo-l><span style=color:#88c0d0>    assert_sync</span><span style=color:#81a1c1>::</span><span style=color:#eceff4>&lt;</span><span style=color:#8fbcbb>MyStrangeType</span><span style=color:#eceff4>>();</span></span>
<span class=giallo-l><span style=color:#eceff4>}</span></span></code></pre><p>æ™‚ã€…ã“ã†ã„ã†testã‚’è¦‹ã‹ã‘ã¦ã„ãŸã®ã§ã™ãŒã€guidelineã«ã‚ã£ãŸã‚“ã§ã™ã­ã€‚<h3 id=error-types-are-meaningful-and-well-behaved-c-good-err><a aria-label="Anchor link for: error-types-are-meaningful-and-well-behaved-c-good-err" class=zola-anchor href=#error-types-are-meaningful-and-well-behaved-c-good-err><a href=https://rust-lang.github.io/api-guidelines/interoperability.html#error-types-are-meaningful-and-well-behaved-c-good-err rel=external>Error types are meaningful and well-behaved (C-GOOD-ERR)</a></a></h3><p><code>Result&lt;T,E></code>ã«åˆ©ç”¨ã™ã‚‹<code>E</code>ã«ã¯ã€<code>std::error::Error</code>ã€<code>Send</code>,<code>Sync</code>ã‚’å®Ÿè£…ã—ã¦ãŠãã¨ã‚¨ãƒ©ãƒ¼é–¢é€£ã®ecosystemã§ä½¿ã„ã‚„ã™ã„ã€‚<br> ã‚¨ãƒ©ãƒ¼å‹ã¨ã—ã¦ã€<code>()</code>ã¯ä½¿ã‚ãªã„ã€‚å¿…è¦ãªã‚‰<a href=https://doc.rust-lang.org/std/str/struct.ParseBoolError.html rel=external><code>ParseBoolError</code></a>ã®ã‚ˆã†ã«å‹ã‚’å®šç¾©ã™ã‚‹ã€‚<h3 id=binary-number-types-provide-hex-octal-binary-formatting-c-num-fmt><a aria-label="Anchor link for: binary-number-types-provide-hex-octal-binary-formatting-c-num-fmt" class=zola-anchor href=#binary-number-types-provide-hex-octal-binary-formatting-c-num-fmt><a href=https://rust-lang.github.io/api-guidelines/interoperability.html#binary-number-types-provide-hex-octal-binary-formatting-c-num-fmt rel=external>Binary number types provide Hex, Octal, Binary formatting (C-NUM_FMT)</a></a></h3><p><code>|</code>ã‚„<code>&</code>ã¨ã„ã£ãŸbitæ¼”ç®—ãŒå®šç¾©ã•ã‚Œã‚‹ã‚ˆã†ãªnumber typeã«ã¯ã€<code>std::fmt::{UpperHex, LowerHex,Octal,Binary}</code>ã‚’å®šç¾©ã—ã¦ãŠãã€‚<h3 id=generic-reader-writer-functions-take-r-read-and-w-write-by-value-c-rw-value><a aria-label="Anchor link for: generic-reader-writer-functions-take-r-read-and-w-write-by-value-c-rw-value" class=zola-anchor href=#generic-reader-writer-functions-take-r-read-and-w-write-by-value-c-rw-value><a href=https://rust-lang.github.io/api-guidelines/interoperability.html#generic-readerwriter-functions-take-r-read-and-w-write-by-value-c-rw-value rel=external>Generic reader/writer functions take <code>R: Read</code> and <code>W: Write</code> by value (C-RW-VALUE)</a></a></h3><p>read/writeå‡¦ç†ã‚’è¡Œã†é–¢æ•°ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«å®šç¾©ã™ã‚‹ã€‚<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=rust><span class=giallo-l><span style=color:#81a1c1>use</span><span> std</span><span style=color:#81a1c1>::</span><span>io</span><span style=color:#81a1c1>::</span><span style=color:#8fbcbb>Read</span><span style=color:#eceff4>;</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#81a1c1>fn</span><span style=color:#88c0d0> do_read</span><span style=color:#eceff4>&lt;</span><span style=color:#8fbcbb>R</span><span style=color:#81a1c1>:</span><span style=color:#8fbcbb> Read</span><span style=color:#eceff4>>(</span><span>_r</span><span style=color:#81a1c1>:</span><span style=color:#8fbcbb> R</span><span style=color:#eceff4>) {}</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#81a1c1>fn</span><span style=color:#88c0d0> main</span><span style=color:#eceff4>() {</span></span>
<span class=giallo-l><span style=color:#81a1c1>    let mut</span><span> stdin</span><span style=color:#81a1c1> =</span><span> std</span><span style=color:#81a1c1>::</span><span>io</span><span style=color:#81a1c1>::</span><span style=color:#88c0d0>stdin</span><span style=color:#eceff4>();</span></span>
<span class=giallo-l><span style=color:#88c0d0>    do_read</span><span style=color:#eceff4>(</span><span style=color:#81a1c1>&mut</span><span> stdin</span><span style=color:#eceff4>);</span></span>
<span class=giallo-l><span style=color:#eceff4>}</span></span></code></pre><p>ã“ã‚ŒãŒcompileã§ãã‚‹ã®ã¯ã€stdã§<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=rust><span class=giallo-l></span>
<span class=giallo-l><span style=color:#81a1c1>impl</span><span style=color:#eceff4>&lt;'</span><span style=color:#8fbcbb>a</span><span style=color:#eceff4>,</span><span style=color:#8fbcbb> R</span><span style=color:#81a1c1>:</span><span style=color:#8fbcbb> Read</span><span style=color:#81a1c1> + ?</span><span style=color:#8fbcbb>Sized</span><span style=color:#eceff4>></span><span style=color:#8fbcbb> Read</span><span style=color:#81a1c1> for &</span><span style=color:#eceff4>'</span><span style=color:#8fbcbb>a</span><span style=color:#81a1c1> mut</span><span style=color:#8fbcbb> R</span><span style=color:#eceff4> {</span><span style=color:#616e88> /* ... */</span><span style=color:#eceff4> }</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#81a1c1>impl</span><span style=color:#eceff4>&lt;'</span><span style=color:#8fbcbb>a</span><span style=color:#eceff4>,</span><span style=color:#8fbcbb> W</span><span style=color:#81a1c1>:</span><span style=color:#8fbcbb> Write</span><span style=color:#81a1c1> + ?</span><span style=color:#8fbcbb>Sized</span><span style=color:#eceff4>></span><span style=color:#8fbcbb> Write</span><span style=color:#81a1c1> for &</span><span style=color:#eceff4>'</span><span style=color:#8fbcbb>a</span><span style=color:#81a1c1> mut</span><span style=color:#8fbcbb> W</span><span style=color:#eceff4> {</span><span style=color:#616e88> /* ... */</span><span style=color:#eceff4> }</span></span></code></pre><p>ãŒå®šç¾©ã•ã‚Œã¦ã„ã‚‹ã®ã§ã€<code>&mut stdin</code>ã‚‚<code>Read</code>ã«ãªã‚‹ã‹ã‚‰ã€‚é–¢æ•°å´ãŒ<code>r: &R</code>ã®ã‚ˆã†ã«å‚ç…§ã§å®šç¾©ã•ã‚Œã¦ã„ãªã„ã®ã§ã€<code>do_read(stdin)</code>ã®ã‚ˆã†ã«moveã•ã›ã¦ã—ã¾ã„ã€loopã§ä½¿ãˆãªããªã‚‹ã®ãŒNew Rust usersã«ã‚ˆãã‚ã‚‹ã‚‰ã—ã„ã€‚<br> é€†ã«é–¢æ•°å´ãŒã€<code>fn do_read_ref&lt;'a, R: Read + ?Sized>(_r: &'a mut R)</code>ã®ã‚ˆã†ã«å®£è¨€ã•ã‚Œã¦ã„ã‚‹ä¾‹ã‚‚ã¿ãŸã‚Šã™ã‚‹ã®ã§ã™ãŒã€ã“ã®guideã«å¾“ã†ã‹ãã¯ä¸è¦ã¨ã„ã†ã“ã¨ãªã®ã§ã—ã‚‡ã†ã‹ã€‚<br> ä¾‹ãˆã°ã€<a href=http://phsym.github.io/prettytable-rs/master/prettytable/struct.Table.html#method.print rel=external><code>prettytable-rs::Table::print</code></a><h2 id=macros><a aria-label="Anchor link for: macros" class=zola-anchor href=#macros><a href=https://rust-lang.github.io/api-guidelines/macros.html rel=external>Macros</a></a></h2><p>å°‚ã‚‰ã€declarative macroã«ã¤ã„ã¦è¿°ã¹ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚<h3 id=input-syntax-is-evocative-of-the-output-c-evocative><a aria-label="Anchor link for: input-syntax-is-evocative-of-the-output-c-evocative" class=zola-anchor href=#input-syntax-is-evocative-of-the-output-c-evocative><a href=https://rust-lang.github.io/api-guidelines/macros.html rel=external>Input syntax is evocative of the output (C-EVOCATIVE)</a></a></h3><p>å…¥åŠ›ã®syntaxãŒå‡ºåŠ›ã‚’æƒ³èµ·ã•ã›ã‚‹ã¨ã„ã†æ„å‘³ã§ã—ã‚‡ã†ã‹ã€‚<br> macroã‚’ä½¿ãˆã°å®Ÿè³ªçš„ã«ã©ã‚“ãªsyntaxã‚’ä½¿ã†ã“ã¨ã‚‚ã§ãã‚‹ãŒã€ã§ãã‚‹ã ã‘æ—¢å­˜ã®syntaxã«ã‚ˆã›ã‚ˆã†ã¨ã„ã†ã‚‚ã®ã€‚<br> ä¾‹ãˆã°ã€macroã®ä¸­ã§structã‚’å®£è¨€ã™ã‚‹ãªã‚‰ã€keywordã«structã‚’ä½¿ã†ç­‰ã€‚<h3 id=item-macros-compose-well-with-attributes-c-macro-attr><a aria-label="Anchor link for: item-macros-compose-well-with-attributes-c-macro-attr" class=zola-anchor href=#item-macros-compose-well-with-attributes-c-macro-attr><a href=https://rust-lang.github.io/api-guidelines/macros.html rel=external>Item macros compose well with attributes (C-MACRO-ATTR)</a></a></h3><p>macroã®ä¸­ã«attributeã‚’æ›¸ã‘ã‚‹ã‚ˆã†ã«ã—ã¦ãŠã“ã†ã€‚<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=rust><span class=giallo-l><span style=color:#88c0d0;font-weight:700>bitflags!</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#5e81ac>    #[derive(</span><span style=color:#8fbcbb>Default</span><span style=color:#5e81ac>,</span><span style=color:#8fbcbb> Serialize</span><span style=color:#5e81ac>)]</span></span>
<span class=giallo-l><span style=color:#81a1c1>    struct</span><span style=color:#8fbcbb> Flags</span><span style=color:#81a1c1>:</span><span style=color:#8fbcbb> u8</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#81a1c1>        const</span><span> ControlCenter</span><span style=color:#81a1c1> =</span><span style=color:#b48ead> 0b001</span><span style=color:#eceff4>;</span></span>
<span class=giallo-l><span style=color:#81a1c1>        const</span><span> Terminal</span><span style=color:#81a1c1> =</span><span style=color:#b48ead> 0b010</span><span style=color:#eceff4>;</span></span>
<span class=giallo-l><span style=color:#eceff4>    }</span></span>
<span class=giallo-l><span style=color:#eceff4>}</span></span></code></pre><h3 id=item-macros-work-anywhere-that-items-are-allowed-c-anywhere><a aria-label="Anchor link for: item-macros-work-anywhere-that-items-are-allowed-c-anywhere" class=zola-anchor href=#item-macros-work-anywhere-that-items-are-allowed-c-anywhere><a href=https://rust-lang.github.io/api-guidelines/macros.html rel=external>Item macros work anywhere that items are allowed (C-ANYWHERE)</a></a></h3><p>ä»¥ä¸‹ã®ã‚ˆã†ã«macroãŒmodule levelã§ã‚‚é–¢æ•°ã®ä¸­ã§ã‚‚æ©Ÿèƒ½ã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=rust><span class=giallo-l><span style=color:#81a1c1>mod</span><span> tests</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#88c0d0;font-weight:700>    test_your_macro_in_a!</span><span style=color:#eceff4>(</span><span>module</span><span style=color:#eceff4>);</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#5e81ac>    #[test]</span></span>
<span class=giallo-l><span style=color:#81a1c1>    fn</span><span style=color:#88c0d0> anywhere</span><span style=color:#eceff4>() {</span></span>
<span class=giallo-l><span style=color:#88c0d0;font-weight:700>        test_your_macro_in_a!</span><span style=color:#eceff4>(</span><span>function</span><span style=color:#eceff4>);</span></span>
<span class=giallo-l><span style=color:#eceff4>    }</span></span>
<span class=giallo-l><span style=color:#eceff4>}</span></span></code></pre><h3 id=item-macros-support-visibility-specifiers-c-macro-vis><a aria-label="Anchor link for: item-macros-support-visibility-specifiers-c-macro-vis" class=zola-anchor href=#item-macros-support-visibility-specifiers-c-macro-vis><a href=https://rust-lang.github.io/api-guidelines/macros.html rel=external>Item macros support visibility specifiers (C-MACRO-VIS)</a></a></h3><p>macroã§visibilityã‚‚æŒ‡å®šã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=rust><span class=giallo-l><span style=color:#88c0d0;font-weight:700>bitflags!</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#81a1c1>    pub struct</span><span style=color:#8fbcbb> PublicFlags</span><span style=color:#81a1c1>:</span><span style=color:#8fbcbb> u8</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#81a1c1>        const</span><span> C</span><span style=color:#81a1c1> =</span><span style=color:#b48ead> 0b0100</span><span style=color:#eceff4>;</span></span>
<span class=giallo-l><span style=color:#81a1c1>        const</span><span> D</span><span style=color:#81a1c1> =</span><span style=color:#b48ead> 0b1000</span><span style=color:#eceff4>;</span></span>
<span class=giallo-l><span style=color:#eceff4>    }</span></span>
<span class=giallo-l><span style=color:#eceff4>}</span></span></code></pre><h3 id=type-fragments-are-flexible-c-macro-ty><a aria-label="Anchor link for: type-fragments-are-flexible-c-macro-ty" class=zola-anchor href=#type-fragments-are-flexible-c-macro-ty><a href=https://rust-lang.github.io/api-guidelines/macros.html rel=external>Type fragments are flexible (C-MACRO-TY)</a></a></h3><p>macroã§<code>$t:ty</code>ã®ã‚ˆã†ãªtype fragmentã‚’åˆ©ç”¨ã™ã‚‹å ´åˆã¯ä»¥ä¸‹ã®å…¥åŠ›ãã‚Œãã‚Œã«å¯¾å¿œã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚<ul><li>Primitives: <code>u8</code>, <code>&str</code><li>Relative paths: <code>m::Data</code><li>Absolute paths: <code>::base::Data</code><li>Upward relative paths: <code>super::Data</code><li>Generics: <code>Vec&lt;String></code></ul><p>boilerplateç”¨ã®helper macroã¨é•ã£ã¦å¤–éƒ¨ã«å…¬é–‹ã™ã‚‹macroã¯è€ƒãˆã‚‹ã“ã¨å¤šãã†ã§é›£æ˜“åº¦é«˜ãã†ã§ã™ã€‚<h2 id=documentation><a aria-label="Anchor link for: documentation" class=zola-anchor href=#documentation><a href=https://rust-lang.github.io/api-guidelines/documentation.html rel=external>Documentation</a></a></h2><p>codeã®ã‚³ãƒ¡ãƒ³ãƒˆ(rustdoc)ã«ã¤ã„ã¦ã€‚<h3 id=crate-level-docs-are-thorough-and-include-examples-c-crate-doc><a aria-label="Anchor link for: crate-level-docs-are-thorough-and-include-examples-c-crate-doc" class=zola-anchor href=#crate-level-docs-are-thorough-and-include-examples-c-crate-doc><a href=https://rust-lang.github.io/api-guidelines/documentation.html rel=external>Crate level docs are thorough and include examples (C-CRATE-DOC)</a></a></h3><p>See <a href=https://github.com/rust-lang/rfcs/pull/1687 rel=external>RFC 1687</a>ã¨æ›¸ã‹ã‚Œã€PRã¸ãƒªãƒ³ã‚¯ã•ã‚Œã¦ã„ã¾ã™ã€‚<br> <a href=https://github.com/rust-lang/api-guidelines/issues/188 rel=external>ãƒªãƒ³ã‚¯ã§ãªãå†…å®¹ã‚’æ›¸ãã¹ãã¨ã„ã†issue</a>ã‚‚ãŸã£ã¦ã„ã‚‹ã‚ˆã†ã§ã—ãŸã€‚<br> PRä½œã‚‰ã‚Œã¦ã„ãŸã®ãŒnushellä½œã‚‰ã‚Œã¦ã„ã‚‹<a href=https://github.com/jntrnr rel=external>JTã•ã‚“</a>ã§ã—ãŸã€‚<br> å†…å®¹ã¨ã—ã¦ã¯<a href=https://github.com/jntrnr/rfcs/blob/front_page_styleguide/text/0000-api-doc-frontpage-styleguide.md rel=external>ã“ã¡ã‚‰</a>ã«ãªã‚‹ã®ã§ã—ã‚‡ã†ã‹ã€‚æœ¬å®¶ã«ã¯ã¾ã mergeã•ã‚Œã¦ã„ãªã„ã‚ˆã†ã§ã—ãŸã€‚<h3 id=all-items-have-a-rustdoc-example-c-example><a aria-label="Anchor link for: all-items-have-a-rustdoc-example-c-example" class=zola-anchor href=#all-items-have-a-rustdoc-example-c-example><a href=https://rust-lang.github.io/api-guidelines/documentation.html#all-items-have-a-rustdoc-example-c-example rel=external>All items have a rustdoc example (C-EXAMPLE)</a></a></h3><p>publicãªmodule, trait struct enum, function, method, macro, type definitionã¯åˆç†çš„ãªç¯„å›²ã§exampleã‚’æŒã¤ã¹ãã€‚<br> åˆç†çš„ã¨ã„ã†ã®ã¯ã€ä»–ã¸ã®linkã§è¶³ã‚Šã‚‹ãªã‚‰ãã†ã—ã¦ã‚‚ã‚ˆã„ã¨ã„ã†æ„å‘³ã€‚<br> ã¾ãŸã€exampleã‚’ç¤ºã™ç†ç”±ã¯ã€ä½¿ã„æ–¹ã‚’ç¤ºã™ã¨ã„ã†ã‚ˆã‚Šã€ãªãœã“ã®å‡¦ç†ã‚’ä½¿ã†ã‹ã‚’ç¤ºã™ã‹ã«ã‚ã‚‹ã¨ã®ã“ã¨ã§ã™ã€‚<h3 id=examples-use-not-try-not-unwrap-c-question-mark><a aria-label="Anchor link for: examples-use-not-try-not-unwrap-c-question-mark" class=zola-anchor href=#examples-use-not-try-not-unwrap-c-question-mark><a href=https://rust-lang.github.io/api-guidelines/documentation.html#examples-use--not-try-not-unwrap-c-question-mark rel=external>Examples use <code>?</code>, not <code>try!</code>, not <code>unwrap</code> (C-QUESTION-MARK)</a></a></h3><p>documentã®exampleã§ã‚ã£ã¦ã‚‚ã€<code>unwrap</code>ã—ãªã„ã§errorã‚’delegateã—ã‚ˆã†ã¨ã„ã†ã“ã¨ã€‚<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=rust><span class=giallo-l><span style=color:#616e88>/// ```rust</span></span>
<span class=giallo-l><span style=color:#616e88>/// # use std::error::Error;</span></span>
<span class=giallo-l><span style=color:#616e88>/// #</span></span>
<span class=giallo-l><span style=color:#616e88>/// # fn main() -> Result&lt;(), Box&lt;dyn Error>> {</span></span>
<span class=giallo-l><span style=color:#616e88>/// your;</span></span>
<span class=giallo-l><span style=color:#616e88>/// example?;</span></span>
<span class=giallo-l><span style=color:#616e88>/// code;</span></span>
<span class=giallo-l><span style=color:#616e88>/// #</span></span>
<span class=giallo-l><span style=color:#616e88>/// #     Ok(())</span></span>
<span class=giallo-l><span style=color:#616e88>/// # }</span></span>
<span class=giallo-l><span style=color:#616e88>/// ```</span></span></code></pre><p>ä¸Šè¨˜ã®ã‚ˆã†ã«ã€<code>#</code>ã‚’æ›¸ãã¨<code>cargo test</code>ã§compileã•ã‚Œã‚‹ãŒã€user-visibleãªç®‡æ‰€ã«ã¯ç¾ã‚Œãªã„ã®ã§ã“ã®æ©Ÿèƒ½ã‚’åˆ©ç”¨ã™ã‚‹ã€‚<h3 id=function-docs-include-error-panic-and-safety-considerations-c-failure><a aria-label="Anchor link for: function-docs-include-error-panic-and-safety-considerations-c-failure" class=zola-anchor href=#function-docs-include-error-panic-and-safety-considerations-c-failure><a href=https://rust-lang.github.io/api-guidelines/documentation.html#function-docs-include-error-panic-and-safety-considerations-c-failure rel=external>Function docs include error, panic, and safety considerations (C-FAILURE)</a></a></h3><p>Errorã‚’è¿”ã™ãªã‚‰ã€<code># Errors</code> sectionã§èª¬æ˜ã‚’åŠ ãˆã‚‹ã€‚panicã™ã‚‹ãªã‚‰ã€<code># Panics</code>ã§ã€‚unsafeã®å ´åˆã¯ã€<code># Safety</code>ã§invariantsã«ã¤ã„ã¦èª¬æ˜ã™ã‚‹ã€‚<h3 id=prose-contains-hyperlinks-to-relevant-things-c-link><a aria-label="Anchor link for: prose-contains-hyperlinks-to-relevant-things-c-link" class=zola-anchor href=#prose-contains-hyperlinks-to-relevant-things-c-link><a href=https://rust-lang.github.io/api-guidelines/documentation.html#prose-contains-hyperlinks-to-relevant-things-c-link rel=external>Prose contains hyperlinks to relevant things (C-LINK)</a></a></h3><p><a href=https://github.com/rust-lang/rfcs/blob/master/text/1574-more-api-documentation-conventions.md rel=external>Link all the things</a>ã¨ã„ã†ã“ã¨ã§ã€ä»–ã®å‹ã¸ã®linkãŒã‹ã‘ã‚‹ã€‚<br> linkã«ã¯ã„ãã¤ã‹æ›¸ãæ–¹ãŒã‚ã‚Šã€<a href=https://rust-lang.github.io/rfcs/1946-intra-rustdoc-links.html rel=external>RFC1946</a>ã«è©³ã—ãã®ã£ã¦ã„ãŸã€‚<h3 id=cargo-toml-includes-all-common-metadata-c-metadata><a aria-label="Anchor link for: cargo-toml-includes-all-common-metadata-c-metadata" class=zola-anchor href=#cargo-toml-includes-all-common-metadata-c-metadata><a href=https://rust-lang.github.io/api-guidelines/documentation.html#cargotoml-includes-all-common-metadata-c-metadata rel=external>Cargo.toml includes all common metadata (C-METADATA)</a></a></h3><p><code>Cargo.toml</code>ã®<code>[package]</code>ã«è¨˜è¼‰ã™ã¹ãfieldã«ã¤ã„ã¦ã€‚licenseã¯æ›¸ã„ã¦ãŠã‹ãªã„ã¨<code>cargo publish</code>ã§ããªã‹ã£ãŸæ°—ãŒã—ã¾ã™ã€‚<h3 id=release-notes-document-all-significant-changes-c-relnotes><a aria-label="Anchor link for: release-notes-document-all-significant-changes-c-relnotes" class=zola-anchor href=#release-notes-document-all-significant-changes-c-relnotes><a href=https://rust-lang.github.io/api-guidelines/documentation.html#release-notes-document-all-significant-changes-c-relnotes rel=external>Release notes document all significant changes (C-RELNOTES)</a></a></h3><p>Release notes = CHANGELOGã¨ã„ã†ç†è§£ã§ã‚ˆã„ã®ã§ã—ã‚‡ã†ã‹ã€‚<br> CHANGELOGã«ã¤ã„ã¦ã¯ã€<a href=https://keepachangelog.com/en/1.0.0/ rel=external>keep a changelog</a>ã®formatã«å¾“ã£ã¦ã„ã¾ã—ãŸã€‚<br> <code>Unreleased</code> sectionã«å¤‰æ›´ç‚¹ã‚’ãŸã‚ã¦è¡Œã£ã¦ã€releaseã®ãŸã³ã«ãã‚Œã‚’release versionã«å¤‰ãˆã‚‹æ–¹å¼ãŒã‚„ã‚Šã‚„ã™ã‹ã£ãŸã§ã™ã€‚<br> Breaking changeã‚‚è¨˜è¼‰ã•ã‚Œã‚‹ã¨ãŠã‚‚ã†ã®ã§ã™ãŒã€ãªã«ãŒç ´å£Šçš„å¤‰æ›´ã‹ãŒ<a href=https://github.com/rust-lang/rfcs/blob/master/text/1105-api-evolution.md rel=external>ãã¡ã‚“ã¨å®šç¾©</a>ã•ã‚Œã¦ã„ã‚‹ã®ã¯Rustã‚‰ã—ã„ã¨æ€ã„ã¾ã—ãŸã€‚<br> ã¾ãŸã€crates.ioã¸ã®publishã•ã‚ŒãŸsourceã«ã¯gitã®tagã‚’ä»˜ä¸ã™ã‚‹ã“ã¨ã‚‚æ›¸ã‹ã‚Œã¦ã„ã¾ã—ãŸã€‚<h2 id=predictability><a aria-label="Anchor link for: predictability" class=zola-anchor href=#predictability><a href=https://rust-lang.github.io/api-guidelines/predictability.html rel=external>Predictability</a></a></h2><p>äºˆæ¸¬å¯èƒ½æ€§ã«ã¤ã„ã¦ã€‚<h3 id=smart-pointers-do-not-add-inherent-methods-c-smart-ptr><a aria-label="Anchor link for: smart-pointers-do-not-add-inherent-methods-c-smart-ptr" class=zola-anchor href=#smart-pointers-do-not-add-inherent-methods-c-smart-ptr><a href=https://rust-lang.github.io/api-guidelines/predictability.html#smart-pointers-do-not-add-inherent-methods-c-smart-ptr rel=external>Smart pointers do not add inherent methods (C-SMART-PTR)</a></a></h3><p><code>Box</code>ã®ã‚ˆã†ãªsmart pointerã®å½¹å‰²ã‚’æœãŸã™å‹ã«<code>fn method(&self)</code>ã®ã‚ˆã†ãªinherent methodsã‚’å®šç¾©ã—ãªã„ã‚ˆã†ã«ã™ã‚‹ã€‚<br> ç†ç”±ã¨ã—ã¦ã¯ã€<code>Box&lt;T></code>ã®å€¤ãŒã‚ã‚‹å ´åˆã«<code>boxed_x.method()</code>ã¨ã„ã†å‘¼ã³å‡ºã—ãŒ<code>Deref</code>ã§<code>T</code>ã®methodãªã®ã‹<code>Box</code>å´ãªã®ã‹ç´›ã‚‰ã‚ã—ã„ã‹ã‚‰ã€‚<h3 id=conversions-live-on-the-most-specific-type-involved-c-conv-specific><a aria-label="Anchor link for: conversions-live-on-the-most-specific-type-involved-c-conv-specific" class=zola-anchor href=#conversions-live-on-the-most-specific-type-involved-c-conv-specific><a href=https://rust-lang.github.io/api-guidelines/predictability.html#conversions-live-on-the-most-specific-type-involved-c-conv-specific rel=external>Conversions live on the most specific type involved (C-CONV-SPECIFIC)</a></a></h3><p>å‹ã®é–“ã§å¤‰æ›ã‚’è¡Œã†éš›ã€ã‚ã‚‹å‹ã®ã»ã†ãŒã‚ˆã‚Šå…·ä½“çš„(provide additional invariant)ãªå ´åˆãŒã‚ã‚‹ã€‚<br> ä¾‹ãˆã°ã€<code>str</code>ã¯<code>&[u8]</code>ã«å¯¾ã—ã¦UTF-8ã¨ã—ã¦æœ‰åŠ¹ãªbyteåˆ—ã§ã‚ã‚‹ã“ã¨ã‚’ä¿è¨¼ã™ã‚‹ã€‚<br> ã“ã®ã‚ˆã†ãªå ´åˆã€å‹å¤‰æ›å‡¦ç†ã¯å…·ä½“å‹ã€ã“ã®ä¾‹ã§ã¯<code>str</code>å´ã«å®šç¾©ã™ã‚‹ã€‚ã“ã®ã»ã†ãŒç›´æ„Ÿçš„ã§ã‚ã‚‹ã“ã¨ã«åŠ ãˆã¦ã€<code>&[u8]</code>ã®å‹å¤‰æ›å‡¦ç†methodãŒå¢—ãˆç¶šã‘ã¦ã„ãã“ã¨ã‚’é˜²æ­¢ã§ãã‚‹ã€‚<h3 id=functions-with-a-clear-receiver-are-methods-c-method><a aria-label="Anchor link for: functions-with-a-clear-receiver-are-methods-c-method" class=zola-anchor href=#functions-with-a-clear-receiver-are-methods-c-method><a href=https://rust-lang.github.io/api-guidelines/predictability.html#functions-with-a-clear-receiver-are-methods-c-method rel=external>Functions with a clear receiver are methods (C-METHOD)</a></a></h3><p>ç‰¹å®šã®å‹ã«é–¢é€£ã—ãŸoperationã¯methodã«ã™ã‚‹ã€‚<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=rust><span class=giallo-l><span style=color:#616e88>// Prefer</span></span>
<span class=giallo-l><span style=color:#81a1c1>impl</span><span style=color:#8fbcbb> Foo</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#81a1c1>    pub fn</span><span style=color:#88c0d0> frob</span><span style=color:#eceff4>(</span><span style=color:#81a1c1>&self</span><span style=color:#eceff4>,</span><span> w</span><span style=color:#81a1c1>:</span><span> widget</span><span style=color:#eceff4>) {</span><span style=color:#616e88> /* ... */</span><span style=color:#eceff4> }</span></span>
<span class=giallo-l><span style=color:#eceff4>}</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#616e88>// Over</span></span>
<span class=giallo-l><span style=color:#81a1c1>pub fn</span><span style=color:#88c0d0> frob</span><span style=color:#eceff4>(</span><span>foo</span><span style=color:#81a1c1>: &</span><span style=color:#8fbcbb>Foo</span><span style=color:#eceff4>,</span><span> w</span><span style=color:#81a1c1>:</span><span> widget</span><span style=color:#eceff4>) {</span><span style=color:#616e88> /* ... */</span><span style=color:#eceff4> }</span></span></code></pre><p>Methodã¯functionã«æ¯”ã¹ã¦ä»¥ä¸‹ã®ãƒ¡ãƒªãƒƒãƒˆãŒã‚ã‚‹ã€‚<ul><li>importã™ã‚‹å¿…è¦ãŒãªãã€å€¤ã ã‘ã§åˆ©ç”¨ã§ãã‚‹ã€‚<li>å‘¼ã³å‡ºã—æ™‚ã«autoborrowingã—ã¦ãã‚Œã‚‹ã€‚<li>å‹<code>T</code>ã§ãªã«ãŒã§ãã‚‹ã‹ãŒã‚ã‹ã‚Šã‚„ã™ã„<li><code>self</code>ã§ã‚ã‚‹ã“ã¨ã§ownershipã®åŒºåˆ¥ãŒã‚ˆã‚Šã‚ã‹ã‚Šã‚„ã™ããªã‚‹ <ul><li>ã“ã“ã®ç†ç”±ã¯ã„ã¾ã„ã¡ã‚ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚</ul></ul><p>å€‹äººçš„ã«methodã«ã™ã‚‹ã‹ã€é–¢æ•°ã«ã™ã‚‹ã‹çµæ§‹æ‚©ã¿ã¾ã™ã€‚<br> å…·ä½“çš„ã«ã¯methodã®ä¸­ã§ã€structã®fieldã®ä¸€éƒ¨ã—ã‹åˆ©ç”¨ã—ãªã„å ´åˆã€åˆ©ç”¨ã™ã‚‹fieldã ã‘ã‚’å¼•æ•°ã«ã¨ã‚‹é–¢æ•°ã‚’å®šç¾©ã—ãŸããªã£ãŸã‚Šã—ã¾ã™ã€‚(structã‚’åˆ†å‰²ã™ã‚‹ã“ã¨ãŒç¤ºå”†ã—ã¦ã„ã‚‹ã®ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒ)<h3 id=functions-do-not-take-out-parameters-c-no-out><a aria-label="Anchor link for: functions-do-not-take-out-parameters-c-no-out" class=zola-anchor href=#functions-do-not-take-out-parameters-c-no-out><a href=https://rust-lang.github.io/api-guidelines/predictability.html#functions-do-not-take-out-parameters-c-no-out rel=external>Functions do not take out-parameters (C-NO-OUT)</a></a></h3><p>ã„ã¾ã„ã¡ã‚ˆãç†è§£ã§ããªã‹ã£ãŸã®ã§ã™ãŒã€æˆ»ã‚Šå€¤ã‚’å…¥åŠ›ã¨ã—ã¦å—ã‘å–ã£ã¦åŠ å·¥ã—ã¦è¿”ã™ã¿ãŸã„ãªfunctionã¯é¿ã‘ã‚ˆã†ã¨ã„ã†ã“ã¨ã§ã—ã‚‡ã†ã‹ã€‚ä¾‹ã«ã‚ã’ã‚‰ã‚Œã¦ã„ã‚‹ã‚³ãƒ¼ãƒ‰ãŒã„ã¾ã„ã¡ä½•ã‚’ä¼ãˆãŸã„ã‹ã‚ã‹ã‚‰ãšã§ã—ãŸã€‚<br> Preferã®<code>foo</code>ã¯ã©ã†ã—ã¦,<code>Bar</code>äºŒã¤è¿”ã—ã¦ã‚‹ã‚“ã§ã—ã‚‡ã†ã‹ã€‚<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=rust><span class=giallo-l><span style=color:#616e88>// Prefer</span></span>
<span class=giallo-l><span style=color:#81a1c1>fn</span><span style=color:#88c0d0> foo</span><span style=color:#eceff4>()</span><span style=color:#81a1c1> -></span><span style=color:#eceff4> (</span><span style=color:#8fbcbb>Bar</span><span style=color:#eceff4>,</span><span style=color:#8fbcbb> Bar</span><span style=color:#eceff4>)</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#616e88>// Over</span></span>
<span class=giallo-l><span style=color:#81a1c1>fn</span><span style=color:#88c0d0> foo</span><span style=color:#eceff4>(</span><span>output</span><span style=color:#81a1c1>: &mut</span><span style=color:#8fbcbb> Bar</span><span style=color:#eceff4>)</span><span style=color:#81a1c1> -></span><span style=color:#8fbcbb> Bar</span></span></code></pre><p>ä¾‹å¤–ã¨ã—ã¦ã¯ã€bufferç­‰ã®callerãŒã‚ã‚‰ã‹ã˜ã‚ç¢ºä¿ã—ã¦ã„ã‚‹dataæ§‹é€ ã«å¯¾ã™ã‚‹å‡¦ç†ã¨ã—ã¦ã€readç³»ã®ä¾‹ãŒã‚ã’ã‚‰ã‚Œã¦ã„ã¾ã—ãŸã€‚<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=rust><span class=giallo-l><span style=color:#81a1c1>fn</span><span style=color:#88c0d0> read</span><span style=color:#eceff4>(</span><span style=color:#81a1c1>&mut self</span><span style=color:#eceff4>,</span><span> buf</span><span style=color:#81a1c1>: &mut</span><span style=color:#eceff4> [</span><span style=color:#8fbcbb>u8</span><span style=color:#eceff4>])</span><span style=color:#81a1c1> -></span><span> io</span><span style=color:#81a1c1>::</span><span style=color:#8fbcbb>Result</span><span style=color:#eceff4>&lt;</span><span style=color:#8fbcbb>usize</span><span style=color:#eceff4>></span></span></code></pre><h3 id=operator-overloads-are-unsurprising-c-overload><a aria-label="Anchor link for: operator-overloads-are-unsurprising-c-overload" class=zola-anchor href=#operator-overloads-are-unsurprising-c-overload><a href=https://rust-lang.github.io/api-guidelines/predictability.html#operator-overloads-are-unsurprising-c-overload rel=external>Operator overloads are unsurprising (C-OVERLOAD)</a></a></h3><p><code>std::ops</code>ã‚’å®Ÿè£…ã™ã‚‹ã¨ã€<code>*</code>ã‚„<code>|</code>ãŒä½¿ãˆã‚‹ã‚ˆã†ã«ãªã‚‹ãŒã€ã“ã®å®Ÿè£…ã¯<code>Mul</code>ã¨ã—ã¦æ©Ÿèƒ½ã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚<h3 id=only-smart-pointers-implement-deref-and-derefmut-c-deref><a aria-label="Anchor link for: only-smart-pointers-implement-deref-and-derefmut-c-deref" class=zola-anchor href=#only-smart-pointers-implement-deref-and-derefmut-c-deref><a href=https://rust-lang.github.io/api-guidelines/predictability.html#only-smart-pointers-implement-deref-and-derefmut-c-deref rel=external>Only smart pointers implement <code>Deref</code> and <code>DerefMut</code> (C-DEREF)</a></a></h3><p><code>Deref</code>ã§å§”è­²ã‚’ã‚„ã‚‹ã‚ˆã†ã«ã—ãŸã“ã¨ã‚ã£ãŸã®ã§ã™ãŒã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ã„ã†ã“ã¨ã§ã‚„ã‚ã¾ã—ãŸã€‚<br> <a href=https://stackoverflow.com/questions/45086595/is-it-considered-a-bad-practice-to-implement-deref-for-newtypes rel=external>Stack overflow</a>ã§ã‚‚ã€<a href=https://crates.io/crates/delegate rel=external>delegate</a>ã‚„<a href=https://crates.io/crates/ambassador rel=external>ambassador</a>ã®åˆ©ç”¨ã‚’æ¨å¥¨ã—ã¦ã„ã‚‹å›ç­”ãŒã‚ã‚Šã¾ã—ãŸã€‚<h3 id=constructors-are-static-inherent-methods-c-ctor><a aria-label="Anchor link for: constructors-are-static-inherent-methods-c-ctor" class=zola-anchor href=#constructors-are-static-inherent-methods-c-ctor><a href=https://rust-lang.github.io/api-guidelines/predictability.html#constructors-are-static-inherent-methods-c-ctor rel=external>Constructors are static, inherent methods (C-CTOR)</a></a></h3><p>å‹ã®constructorã«ã¤ã„ã¦ã€‚<br> åŸºæœ¬ã¯ã€<code>T::new</code>ã‚’å®Ÿè£…ã™ã‚‹ã€‚å¯èƒ½ãªã‚‰<code>Default</code>ã‚‚ã€‚<br> domainã«ã‚ˆã£ã¦ã¯ã€<code>new</code>ä»¥å¤–ã‚‚å¯èƒ½ã€‚ä¾‹ãˆã°ã€<code>File::open</code>ã‚„<code>TcpStream::connect</code>ã€‚<br> constructorãŒè¤‡æ•°ã‚ã‚‹å ´åˆã«ã¯ã€<code>_with_foo</code>ã®ã‚ˆã†ã«ã™ã‚‹ã€‚<br> è¤‡é›‘ãªã‚‰builder patternã‚’æ¤œè¨ã™ã‚‹ã€‚<br> ã‚ã‚‹æ—¢å­˜ã®å‹ã®å€¤ã‹ã‚‰constructã™ã‚‹å ´åˆã¯ã€<code>from_</code>ã‚’æ¤œè¨ã™ã‚‹ã€‚<code>from_</code>ã¨<code>From&lt;T></code>ã®é•ã„ã¯ã€unsafeã«ã§ããŸã‚Šã€è¿½åŠ ã®å¼•æ•°ã‚’å®šç¾©ã§ããŸã‚Šã™ã‚‹ã¨ã“ã‚ã«ã‚ã‚‹ã€‚<h2 id=flexibility><a aria-label="Anchor link for: flexibility" class=zola-anchor href=#flexibility><a href=https://rust-lang.github.io/api-guidelines/flexibility.html rel=external>Flexibility</a></a></h2><h3 id=functions-expose-intermediate-results-to-avoid-duplicate-work-c-intermediate><a aria-label="Anchor link for: functions-expose-intermediate-results-to-avoid-duplicate-work-c-intermediate" class=zola-anchor href=#functions-expose-intermediate-results-to-avoid-duplicate-work-c-intermediate><a href=https://rust-lang.github.io/api-guidelines/flexibility.html#functions-expose-intermediate-results-to-avoid-duplicate-work-c-intermediate rel=external>Functions expose intermediate results to avoid duplicate work (C-INTERMEDIATE)</a></a></h3><p>å‡¦ç†ã®éç¨‹ã§ç”Ÿæˆã•ã‚ŒãŸä¸­é–“ãƒ‡ãƒ¼ã‚¿ãŒå‘¼ã³å‡ºã—å´ã«ã¨ã£ã¦æœ‰ç”¨ã«ãªã‚Šã†ã‚‹å ´åˆãŒã‚ã‚‹ãªã‚‰ãã‚Œã‚’è¿”ã™ã‚ˆã†ãªAPIã«ã™ã‚‹ã€‚<br> ã“ã‚Œã ã‘ã ã¨ã„ã¾ã„ã¡ã‚ã‹ã‚Šã¾ã›ã‚“ãŒã€å…·ä½“ä¾‹ã¨ã—ã¦<ul><li><code>Vec::binary_search</code> <ul><li>è¦‹ã¤ã‹ã‚‰ãªã‹ã£ãŸæ™‚ã¯insertã«é©ã—ãŸindexã‚’è¿”ã—ã¦ãã‚Œã‚‹</ul><li><code>String::from_utf8</code> <ul><li>æœ‰åŠ¹ãªUTF-8ã§ãªã‹ã£ãŸå ´åˆã€ãã®offsetã¨inputã®ownershipã‚’æˆ»ã—ã¦ãã‚Œã‚‹</ul><li><code>HashMap::insert</code> <ul><li>keyã«å¯¾ã—ã¦æ—¢å­˜ã®å€¤ãŒã‚ã‚Œã°æˆ»ã—ã¦ãã‚Œã‚‹ã€‚recoverã—ã‚ˆã†ã¨ã—ãŸéš›ã«tableã®lookupã‚’äºˆã‚è¡Œã†å¿…è¦ãŒãªã„ã€‚</ul></ul><p>ownershipã¨ã‚‹ã‚ˆã†ãªé–¢æ•°ã®å ´åˆã€ã‚¨ãƒ©ãƒ¼æ™‚ã«å€¤ã‚’è¿”ã™ã‚ˆã†ãªAPIã¯å‚è€ƒã«ãªã‚‹ãªã¨æ€ã„ã¾ã—ãŸã€‚<h3 id=caller-decides-where-to-copy-and-place-data-c-caller-control><a aria-label="Anchor link for: caller-decides-where-to-copy-and-place-data-c-caller-control" class=zola-anchor href=#caller-decides-where-to-copy-and-place-data-c-caller-control><a href=https://rust-lang.github.io/api-guidelines/flexibility.html#caller-decides-where-to-copy-and-place-data-c-caller-control rel=external>Caller decides where to copy and place data (C-CALLER_CONTROL)</a></a></h3><pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=rust><span class=giallo-l><span style=color:#81a1c1>fn</span><span style=color:#88c0d0> foo</span><span style=color:#eceff4>(</span><span>b</span><span style=color:#81a1c1>: &</span><span style=color:#8fbcbb>Bar</span><span style=color:#eceff4>) {</span></span>
<span class=giallo-l><span style=color:#81a1c1>   let</span><span> b</span><span style=color:#81a1c1> =</span><span> b</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>clone</span><span style=color:#eceff4>();</span><span> </span></span>
<span class=giallo-l><span style=color:#eceff4>}</span></span></code></pre><p>ã®ã‚ˆã†ã«ã™ã‚‹ãªã‚‰æœ€åˆã‹ã‚‰<code>foo(b: Bar)</code>ã§ownershipã‚’ã¨ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ã“ã†ã™ã‚Œã°å‘¼ã³å‡ºã—å´ã§cloneã™ã‚‹ã‹moveã™ã‚‹ã‹ã‚’é¸æŠã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚<h3 id=functions-minimize-assumptions-about-parameters-by-using-generics-c-generic><a aria-label="Anchor link for: functions-minimize-assumptions-about-parameters-by-using-generics-c-generic" class=zola-anchor href=#functions-minimize-assumptions-about-parameters-by-using-generics-c-generic><a href=https://rust-lang.github.io/api-guidelines/flexibility.html#functions-minimize-assumptions-about-parameters-by-using-generics-c-generic rel=external>Functions minimize assumptions about parameters by using generics (C-GENERIC)</a></a></h3><p>å¼•æ•°ã«å¯¾ã™ã‚‹å‰æ(assumption)ãŒå°‘ãªã„ã»ã©ã€é–¢æ•°ã®å†åˆ©ç”¨æ€§ãŒã‚ãŒã‚‹ã€‚<br> ã®ã§ã€<code>fn foo(&[i64])</code>ã®ã‚ˆã†ã«ã†ã‘ãªã„ã§<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=rust><span class=giallo-l><span style=color:#81a1c1>fn</span><span style=color:#88c0d0> foo</span><span style=color:#eceff4>&lt;</span><span style=color:#8fbcbb>I</span><span style=color:#81a1c1>:</span><span style=color:#8fbcbb> IntoIterator</span><span style=color:#eceff4>&lt;</span><span style=color:#8fbcbb>Item</span><span style=color:#81a1c1>=</span><span style=color:#8fbcbb> i64</span><span style=color:#eceff4>>>(</span><span>iter</span><span style=color:#81a1c1>:</span><span style=color:#8fbcbb> I</span><span style=color:#eceff4>)</span></span></code></pre><p>ã®ã‚ˆã†ã«ã†ã‘ã¦ã€å€¤ã®iterateã«ã®ã¿ä¾å­˜ã—ã¦ã„ã‚‹ã“ã¨ã‚’è¡¨ç¾ã™ã‚‹ã€‚ ãŸã ã—ã€genericsã«ã‚‚disadvantageãŒã‚ã‚‹ã®ã§ãã‚Œã¯è€ƒæ…®ã™ã‚‹ã€‚(code sizeç­‰)<h3 id=traits-are-object-safe-if-they-may-be-useful-as-a-trait-object-c-object><a aria-label="Anchor link for: traits-are-object-safe-if-they-may-be-useful-as-a-trait-object-c-object" class=zola-anchor href=#traits-are-object-safe-if-they-may-be-useful-as-a-trait-object-c-object><a href=https://rust-lang.github.io/api-guidelines/flexibility.html#traits-are-object-safe-if-they-may-be-useful-as-a-trait-object-c-object rel=external>Traits are object-safe if they may be useful as a trait object (C-OBJECT)</a></a></h3><p>traitã‚’è¨­è¨ˆã™ã‚‹éš›ã¯ã€genericsã®boundã¨ã—ã¦ã‹trait objectã¨ã—ã¦åˆ©ç”¨ã™ã‚‹ã®ã‹ã‚’æ±ºã‚ã¦ãŠãã€‚<br> object safeãªtraitã«object safeã§ãªã„methodã‚’è¿½åŠ ã—ã¦ã€object safeã‚’æº€ãŸã•ãªããªã‚‰ãªã„ã‚ˆã†ã«æ³¨æ„ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã¨ã„ã†ã“ã¨ã§ã—ã‚‡ã†ã‹ã€‚<br> trait safeã§ãªã„methodã‚’è¿½åŠ ã™ã‚‹éš›ã¯ã€<code>where</code>ã«<code>Self: Sized</code>ã‚’ä»˜ä¸ã—ã¦trait objectã‹ã‚‰ã¯ã‚ˆã¹ãªãã™ã‚‹é¸æŠè‚¢ã‚‚ã‚ã‚‹ãã†ã§ã€<code>Iterator</code>ã§ã¯ãã†ã—ã¦ã„ã‚‹ã¨ã„ã†ä¾‹ã‚‚ã®ã£ã¦ã„ã¾ã—ãŸã€‚<br> <code>Send</code>ã‚„<code>Sync</code>ã¨åŒæ§˜ã«test caseã§object safeã®assertã‚‚æ›¸ã„ã¦ãŠã„ãŸæ–¹ãŒã‚ˆã•ãã†ã ãªã¨æ€ã„ã¾ã—ãŸã€‚<h2 id=type-safety><a aria-label="Anchor link for: type-safety" class=zola-anchor href=#type-safety><a href=https://rust-lang.github.io/api-guidelines/type-safety.html rel=external>Type safety</a></a></h2><h3 id=newtypes-provide-static-distinctions-c-newtype><a aria-label="Anchor link for: newtypes-provide-static-distinctions-c-newtype" class=zola-anchor href=#newtypes-provide-static-distinctions-c-newtype><a href=https://rust-lang.github.io/api-guidelines/type-safety.html#newtypes-provide-static-distinctions-c-newtype rel=external>Newtypes provide static distinctions (C-NEWTYPE)</a></a></h3><p>å˜ä½ã‚„Id(UserId,ItemId,...)ç­‰ã‚’<code>i64</code>ã‚„<code>String</code>ã§ã¯ãªãå°‚ç”¨ã®å‹ã‚’ãã£ã¦é™çš„ã«åŒºåˆ¥ã™ã‚‹ã€‚<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=rust><span class=giallo-l><span style=color:#81a1c1>struct</span><span style=color:#8fbcbb> Miles</span><span style=color:#eceff4>(</span><span style=color:#81a1c1>pub</span><span style=color:#8fbcbb> f64</span><span style=color:#eceff4>);</span></span>
<span class=giallo-l><span style=color:#81a1c1>struct</span><span style=color:#8fbcbb> Kilometers</span><span style=color:#eceff4>(</span><span style=color:#81a1c1>pub</span><span style=color:#8fbcbb> f64</span><span style=color:#eceff4>);</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#81a1c1>impl</span><span style=color:#8fbcbb> Miles</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#81a1c1>    fn</span><span style=color:#88c0d0> to_kilometers</span><span style=color:#eceff4>(</span><span style=color:#81a1c1>self</span><span style=color:#eceff4>)</span><span style=color:#81a1c1> -></span><span style=color:#8fbcbb> Kilometers</span><span style=color:#eceff4> {</span><span style=color:#616e88> /* ... */</span><span style=color:#eceff4> }</span></span>
<span class=giallo-l><span style=color:#eceff4>}</span></span>
<span class=giallo-l><span style=color:#81a1c1>impl</span><span style=color:#8fbcbb> Kilometers</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#81a1c1>    fn</span><span style=color:#88c0d0> to_miles</span><span style=color:#eceff4>(</span><span style=color:#81a1c1>self</span><span style=color:#eceff4>)</span><span style=color:#81a1c1> -></span><span style=color:#8fbcbb> Miles</span><span style=color:#eceff4> {</span><span style=color:#616e88> /* ... */</span><span style=color:#eceff4> }</span></span>
<span class=giallo-l><span style=color:#eceff4>}</span></span></code></pre><h3 id=arguments-convery-meaning-through-types-not-bool-or-option-c-custom-type><a aria-label="Anchor link for: arguments-convery-meaning-through-types-not-bool-or-option-c-custom-type" class=zola-anchor href=#arguments-convery-meaning-through-types-not-bool-or-option-c-custom-type><a href=https://rust-lang.github.io/api-guidelines/type-safety.html#arguments-convey-meaning-through-types-not-bool-or-option-c-custom-type rel=external>Arguments convery meaning through types, not <code>bool</code> or <code>Option</code> (C-CUSTOM-TYPE)</a></a></h3><p>boolã˜ã‚ƒãªãã¦å°‚ç”¨ã®å‹ã‚’ãã‚ã†ã€‚boolã«å¯¾ã—ã¦enumã«ã™ã‚‹ã®ãŒã‚ã‹ã‚Šã‚„ã™ã„ã®ã¯ç†è§£ã§ãã‚‹ã®ã§ã™ãŒã€Optionã‚‚ä½¿ã‚ãªã„æ–¹ãŒã‚ˆã„ã‚‚ã®ãªã®ã‹ãªã¨æ€ã„ã¾ã—ãŸã€‚<br> Optionã¯ecosystemã¨è¦ªå’Œæ€§ã‚ã‚‹ã‹ã‚‰å¤‰ã«wrapã™ã‚‹ã¨ä½¿ã„ã¥ã‚‰ããªã‚‹ã®ã§ã¯ã€‚<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=rust><span class=giallo-l><span style=color:#616e88>// Prefer</span></span>
<span class=giallo-l><span style=color:#81a1c1>let</span><span> w</span><span style=color:#81a1c1> =</span><span style=color:#8fbcbb> Widget</span><span style=color:#81a1c1>::</span><span style=color:#88c0d0>new</span><span style=color:#eceff4>(</span><span style=color:#8fbcbb>Small</span><span style=color:#eceff4>,</span><span style=color:#8fbcbb> Round</span><span style=color:#eceff4>)</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#616e88>// Over</span></span>
<span class=giallo-l><span style=color:#81a1c1>let</span><span> w</span><span style=color:#81a1c1> =</span><span style=color:#8fbcbb> Widget</span><span style=color:#81a1c1>::</span><span style=color:#88c0d0>new</span><span style=color:#eceff4>(</span><span style=color:#81a1c1>true</span><span style=color:#eceff4>,</span><span style=color:#81a1c1> false</span><span style=color:#eceff4>)</span></span></code></pre><h3 id=types-for-a-set-of-flags-are-bitflags-not-enums-c-bitflag><a aria-label="Anchor link for: types-for-a-set-of-flags-are-bitflags-not-enums-c-bitflag" class=zola-anchor href=#types-for-a-set-of-flags-are-bitflags-not-enums-c-bitflag><a href=https://rust-lang.github.io/api-guidelines/type-safety.html#types-for-a-set-of-flags-are-bitflags-not-enums-c-bitflag rel=external>Types for a set of flags are <code>bitflags</code>, not enums (C-BITFLAG)</a></a></h3><p>ä»–è¨€èªã‚„ã‚·ã‚¹ãƒ†ãƒ ã¨ã®äº’æ›æ€§ã®è¦³ç‚¹ã‚„æ•´æ•°å€¤ã§ãƒ•ãƒ©ã‚°ã®setã‚’ç®¡ç†ã—ãŸã„å ´åˆã¯<code>bitflags</code>ã‚’ä½¿ãŠã†ã€‚<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=rust><span class=giallo-l><span style=color:#81a1c1>use</span><span> bitflags</span><span style=color:#81a1c1>::</span><span>bitflags</span><span style=color:#eceff4>;</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#88c0d0;font-weight:700>bitflags!</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#81a1c1>    struct</span><span style=color:#8fbcbb> Flags</span><span style=color:#81a1c1>:</span><span style=color:#8fbcbb> u32</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#81a1c1>        const</span><span> FLAG_A</span><span style=color:#81a1c1> =</span><span style=color:#b48ead> 0b00000001</span><span style=color:#eceff4>;</span></span>
<span class=giallo-l><span style=color:#81a1c1>        const</span><span> FLAG_B</span><span style=color:#81a1c1> =</span><span style=color:#b48ead> 0b00000010</span><span style=color:#eceff4>;</span></span>
<span class=giallo-l><span style=color:#81a1c1>        const</span><span> FLAG_C</span><span style=color:#81a1c1> =</span><span style=color:#b48ead> 0b00000100</span><span style=color:#eceff4>;</span></span>
<span class=giallo-l><span style=color:#eceff4>    }</span></span>
<span class=giallo-l><span style=color:#eceff4>}</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#81a1c1>fn</span><span style=color:#88c0d0> f</span><span style=color:#eceff4>(</span><span>settings</span><span style=color:#81a1c1>:</span><span style=color:#8fbcbb> Flags</span><span style=color:#eceff4>) {</span></span>
<span class=giallo-l><span style=color:#81a1c1>    if</span><span> settings</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>contains</span><span style=color:#eceff4>(</span><span>Flags</span><span style=color:#81a1c1>::</span><span>FLAG_A</span><span style=color:#eceff4>) {</span></span>
<span class=giallo-l><span style=color:#88c0d0;font-weight:700>        println!</span><span style=color:#eceff4>("</span><span style=color:#a3be8c>doing thing A</span><span style=color:#eceff4>");</span></span>
<span class=giallo-l><span style=color:#eceff4>    }</span></span>
<span class=giallo-l><span style=color:#81a1c1>    if</span><span> settings</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>contains</span><span style=color:#eceff4>(</span><span>Flags</span><span style=color:#81a1c1>::</span><span>FLAG_B</span><span style=color:#eceff4>) {</span></span>
<span class=giallo-l><span style=color:#88c0d0;font-weight:700>        println!</span><span style=color:#eceff4>("</span><span style=color:#a3be8c>doing thing B</span><span style=color:#eceff4>");</span></span>
<span class=giallo-l><span style=color:#eceff4>    }</span></span>
<span class=giallo-l><span style=color:#81a1c1>    if</span><span> settings</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>contains</span><span style=color:#eceff4>(</span><span>Flags</span><span style=color:#81a1c1>::</span><span>FLAG_C</span><span style=color:#eceff4>) {</span></span>
<span class=giallo-l><span style=color:#88c0d0;font-weight:700>        println!</span><span style=color:#eceff4>("</span><span style=color:#a3be8c>doing thing C</span><span style=color:#eceff4>");</span></span>
<span class=giallo-l><span style=color:#eceff4>    }</span></span>
<span class=giallo-l><span style=color:#eceff4>}</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#81a1c1>fn</span><span style=color:#88c0d0> main</span><span style=color:#eceff4>() {</span></span>
<span class=giallo-l><span style=color:#88c0d0>    f</span><span style=color:#eceff4>(</span><span>Flags</span><span style=color:#81a1c1>::</span><span>FLAG_A</span><span style=color:#81a1c1> |</span><span> Flags</span><span style=color:#81a1c1>::</span><span>FLAG_C</span><span style=color:#eceff4>);</span></span>
<span class=giallo-l><span style=color:#eceff4>}</span></span></code></pre><h3 id=builders-enable-construction-of-complex-values-c-builder><a aria-label="Anchor link for: builders-enable-construction-of-complex-values-c-builder" class=zola-anchor href=#builders-enable-construction-of-complex-values-c-builder><a href=https://rust-lang.github.io/api-guidelines/type-safety.html#builders-enable-construction-of-complex-values-c-builder rel=external>Builders enable construction of complex values (C-BUILDER)</a></a></h3><p>å‹<code>T</code>ã®constructãŒè¤‡é›‘ã«ãªã£ã¦ããŸã¨ãã«ã¯ã€<code>TBuilder</code>ã‚’ä½œã‚‹ã“ã¨ã‚’æ¤œè¨ã™ã‚‹ã€‚å¿…ãšã—ã‚‚Builderã¨ã™ã‚‹å¿…è¦ã¯ãªãã€stdã®child processã«å¯¾ã™ã‚‹<code>Command</code>ã‚„<code>Url</code>ã®<code>ParseOptions</code>ã®ã‚ˆã†ã«domainã«é©ã—ãŸåå‰ãŒã‚ã‚‹ãªã‚‰ãã‚Œã‚’åˆ©ç”¨ã™ã‚‹ã€‚<br> <code>Builder</code>ã®methodã®receiverã«<code>&mut self</code>ã‚’ã¨ã‚‹ã‹ã€<code>self</code>ã‚’ã¨ã‚‹ã‹ã§ãã‚Œãã‚Œãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•ãŒã‚ã‚‹ã€‚<br> ã©ã¡ã‚‰ã‚’æ¡ç”¨ã—ã¦ã‚‚one lineã¯å•é¡Œãªãã‹ã‘ã‚‹ãŒã€ifã‚’æ›¸ã“ã†ã¨ã™ã‚‹ã¨<code>self</code>ã‚’ã¨ã‚‹ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã¯å†ä»£å…¥ã•ã›ã‚‹å½¢ã«ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=rust><span class=giallo-l><span style=color:#616e88>// Complex configuration</span></span>
<span class=giallo-l><span style=color:#81a1c1>let mut</span><span> task</span><span style=color:#81a1c1> =</span><span style=color:#8fbcbb> TaskBuilder</span><span style=color:#81a1c1>::</span><span style=color:#88c0d0>new</span><span style=color:#eceff4>();</span></span>
<span class=giallo-l><span>task</span><span style=color:#81a1c1> =</span><span> task</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>named</span><span style=color:#eceff4>("</span><span style=color:#a3be8c>my_task_2</span><span style=color:#eceff4>");</span><span style=color:#616e88> // must re-assign to retain ownership</span></span>
<span class=giallo-l><span style=color:#81a1c1>if</span><span> reroute</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span>    task</span><span style=color:#81a1c1> =</span><span> task</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>stdout</span><span style=color:#eceff4>(</span><span>mywriter</span><span style=color:#eceff4>);</span></span>
<span class=giallo-l><span style=color:#eceff4>}</span></span></code></pre><h2 id=dependability><a aria-label="Anchor link for: dependability" class=zola-anchor href=#dependability><a href=https://rust-lang.github.io/api-guidelines/dependability.html rel=external>Dependability</a></a></h2><h3 id=functions-validate-their-arguments-c-validate><a aria-label="Anchor link for: functions-validate-their-arguments-c-validate" class=zola-anchor href=#functions-validate-their-arguments-c-validate><a href=https://rust-lang.github.io/api-guidelines/dependability.html#functions-validate-their-arguments-c-validate rel=external>Functions validate their arguments (C-VALIDATE)</a></a></h3><p>Rustã®Apiã¯ä¸€èˆ¬çš„ã«ã¯<a href=http://en.wikipedia.org/wiki/Robustness_principle rel=external>robustness principle</a>ã«å¾“ã£ã¦ã„ãªã„ã€‚<br> ã¤ã¾ã‚Šã€ã‚¤ãƒ³ãƒ—ãƒƒãƒˆã«å¯¾ã—ã¦liberalãªæ…‹åº¦ã‚’å–ã‚‰ãªã„ã€‚ä»£ã‚ã‚Šã«Rustã§ã¯å®Ÿç”¨çš„ãªç¯„å›²ã§ã‚¤ãƒ³ãƒ—ãƒƒãƒˆã‚’validateã™ã‚‹ã€‚<br> validationã¯ä»¥ä¸‹ã®æ–¹æ³•ã§ãªã•ã‚Œã‚‹ã€‚(å„ªå…ˆåº¦ã®é«˜ã„é †)<h4 id=static-enforcement><a aria-label="Anchor link for: static-enforcement" class=zola-anchor href=#static-enforcement>Static enforcement</a></h4><pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=rust><span class=giallo-l><span style=color:#616e88>// Prefer</span></span>
<span class=giallo-l><span style=color:#81a1c1>fn</span><span style=color:#88c0d0> foo</span><span style=color:#eceff4>(</span><span>a</span><span style=color:#81a1c1>:</span><span style=color:#8fbcbb> Ascii</span><span style=color:#eceff4>) { }</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#616e88>// Over</span></span>
<span class=giallo-l><span style=color:#81a1c1>fn</span><span style=color:#88c0d0> foo</span><span style=color:#eceff4>(</span><span>a</span><span style=color:#81a1c1>:</span><span style=color:#8fbcbb> u8</span><span style=color:#eceff4>) { }</span></span></code></pre><p>ã“ã“ã§ã¯<code>Ascii</code>ã¯<code>u8</code>ã®wrapperã§asciiã¨ã—ã¦æœ‰åŠ¹ãªbyteã§ã‚ã‚‹ã“ã¨ã‚’ä¿è¨¼ã—ã¦ã„ã‚‹ã€‚<br> ã“ã†ã—ãŸstatic enforcementã¯costã‚’boundaries(<code>u8</code>ãŒæœ€åˆã«<code>Ascii</code>ã«å¤‰æ›ã•ã‚Œã‚‹æ™‚)ã«ã‚ˆã›ã€runtimeæ™‚ã®costã‚’æŠ‘ãˆã¦ãã‚Œã‚‹ã€‚<h4 id=dynamic-enforcement><a aria-label="Anchor link for: dynamic-enforcement" class=zola-anchor href=#dynamic-enforcement>Dynamic enforcement</a></h4><p>å®Ÿè¡Œæ™‚ã®validationã®æ¬ ç‚¹ã¨ã—ã¦ã¯<ul><li>Runtime overhead<li>bugã®ç™ºè¦‹ãŒé€ã‚Œã‚‹ã“ã¨<li><code>Result/Option</code>ãŒå°å…¥ã•ã‚Œã‚‹ã“ã¨(clientãŒãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã™ã‚‹å¿…è¦ãŒã‚ã‚‹)</ul><p>ã¾ãŸã€production buildã§ã®runtime costã‚’ã•ã‘ã‚‹æ‰‹æ®µã¨ã—ã¦<code>debug_assert!</code>ãŒã‚ã‚‹ã€‚<br> ã•ã‚‰ã«ã€<code>_unchecked</code>ç‰ˆã®å‡¦ç†ã‚’æä¾›ã—ã€runtime costã‚’opt outã™ã‚‹é¸æŠè‚¢ã‚’æä¾›ã—ã¦ã„ã‚‹å ´åˆã‚‚ã‚ã‚‹ã€‚<h3 id=destructors-never-fail-c-dtor-fail><a aria-label="Anchor link for: destructors-never-fail-c-dtor-fail" class=zola-anchor href=#destructors-never-fail-c-dtor-fail><a href=https://rust-lang.github.io/api-guidelines/dependability.html#destructors-never-fail-c-dtor-fail rel=external>Destructors never fail (C-DTOR-FAIL)</a></a></h3><p>Destructorã¯panicæ™‚ã‚‚å®Ÿè¡Œã•ã‚Œã‚‹ã€‚panicæ™‚ã®destructorã®å¤±æ•—ã¯programã®abortã«ã¤ãªãŒã‚‹ã€‚<br> destructorã‚’å¤±æ•—ã•ã›ã‚‹ã®ã§ã¯ãªãã€clean teardownã‚’checkã§ãã‚‹åˆ¥ã®methodã‚’æä¾›ã™ã‚‹ã€‚(<code>close</code>ãªã©)<br> ã‚‚ã—ã€ã“ã†ã—ãŸ<code>close</code>ãŒå‘¼ã°ã‚Œãªã‹ã£ãŸå ´åˆã¯ã€<code>Drop</code>ã®å®Ÿè£…ã¯ã‚¨ãƒ©ãƒ¼ã‚’ç„¡è¦–ã™ã‚‹ã‹loggingã™ã‚‹ã€‚<h3 id=destructors-that-may-block-have-alternatives-c-dtor-block><a aria-label="Anchor link for: destructors-that-may-block-have-alternatives-c-dtor-block" class=zola-anchor href=#destructors-that-may-block-have-alternatives-c-dtor-block><a href=https://rust-lang.github.io/api-guidelines/dependability.html#destructors-that-may-block-have-alternatives-c-dtor-block rel=external>Destructors that may block have alternatives (C-DTOR-BLOCK)</a></a></h3><p>åŒæ§˜ã«destructorã¯blockingã™ã‚‹å‡¦ç†ã‚‚å®Ÿè¡Œã—ã¦ã¯ãªã‚‰ãªã„ã€‚<br> ã“ã“ã§ã‚‚ã€infallibleã§nonblockingã§ãã‚‹ã‚ˆã†ã«åˆ¥ã®methodã‚’æä¾›ã™ã‚‹ã€‚<h2 id=debuggability><a aria-label="Anchor link for: debuggability" class=zola-anchor href=#debuggability><a href=https://rust-lang.github.io/api-guidelines/debuggability.html rel=external>Debuggability</a></a></h2><h3 id=all-public-types-implement-debug-c-debug><a aria-label="Anchor link for: all-public-types-implement-debug-c-debug" class=zola-anchor href=#all-public-types-implement-debug-c-debug><a href=https://rust-lang.github.io/api-guidelines/debuggability.html#all-public-types-implement-debug-c-debug rel=external>All public types implement <code>Debug</code> (C-DEBUG)</a></a></h3><p>publicãªå‹ã«ã¯<code>Debug</code>ã‚’å®Ÿè£…ã™ã‚‹ã€‚ä¾‹å¤–ã¯ç¨€ã€‚<h3 id=debug-representation-is-never-empty-c-debug-nonempty><a aria-label="Anchor link for: debug-representation-is-never-empty-c-debug-nonempty" class=zola-anchor href=#debug-representation-is-never-empty-c-debug-nonempty><a href=https://rust-lang.github.io/api-guidelines/debuggability.html#debug-representation-is-never-empty-c-debug-nonempty rel=external><code>Debug</code> representation is never empty (C-DEBUG-NONEMPTY)</a></a></h3><p>ç©ºã®å€¤ã‚’è¡¨ç¾ã—ã¦ã„ã¦ã‚‚ã€<code>[]</code>ãªã‚Š<code>""</code>ã®ãªã‚“ã‚‰ã‹ã®è¡¨ç¤ºã‚’ãŠã“ãªã†ã¹ãã§ã€ç©ºã®å‡ºåŠ›ã‚’ã™ã‚‹ã¹ãã§ãªã„ã€‚<h2 id=future-proofing><a aria-label="Anchor link for: future-proofing" class=zola-anchor href=#future-proofing><a href=https://rust-lang.github.io/api-guidelines/future-proofing.html rel=external>Future proofing</a></a></h2><h3 id=sealed-traits-protect-against-downstream-implementations-c-sealed><a aria-label="Anchor link for: sealed-traits-protect-against-downstream-implementations-c-sealed" class=zola-anchor href=#sealed-traits-protect-against-downstream-implementations-c-sealed><a href=https://rust-lang.github.io/api-guidelines/future-proofing.html#sealed-traits-protect-against-downstream-implementations-c-sealed rel=external>Sealed traits protect against downstream implementations (C-SEALED)</a></a></h3><p>crateå†…ã§ã®ã¿å®Ÿè£…ã‚’æä¾›ã—ãŸã„traitã«ã¤ã„ã¦ã¯ã€ãƒ¦ãƒ¼ã‚¶å´ã§<code>impl</code>ã§ããªã„ã‚ˆã†ã«ã—ã¦ãŠãã“ã¨ã§ã€ç ´å£Šçš„å¤‰æ›´ã‚’é¿ã‘ã¤ã¤traitã‚’å¤‰æ›´ã§ãã‚‹ã‚ˆã†ã«ä¿ã¦ã‚‹ã€‚<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=rust><span class=giallo-l></span>
<span class=giallo-l><span style=color:#616e88>/// This trait is sealed and cannot be implemented for types outside this crate.</span></span>
<span class=giallo-l><span style=color:#81a1c1>pub trait</span><span style=color:#8fbcbb;font-weight:700> TheTrait</span><span style=color:#81a1c1>:</span><span> private</span><span style=color:#81a1c1>::</span><span style=color:#8fbcbb>Sealed</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#616e88>    // Zero or more methods that the user is allowed to call.</span></span>
<span class=giallo-l><span style=color:#81a1c1>    fn ...</span><span style=color:#eceff4>();</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#616e88>    // Zero or more private methods, not allowed for user to call.</span></span>
<span class=giallo-l><span style=color:#5e81ac>    #[doc(hidden)]</span></span>
<span class=giallo-l><span style=color:#81a1c1>    fn ...</span><span style=color:#eceff4>();</span></span>
<span class=giallo-l><span style=color:#eceff4>}</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#616e88>// Implement for some types.</span></span>
<span class=giallo-l><span style=color:#81a1c1>impl</span><span style=color:#8fbcbb> TheTrait</span><span style=color:#81a1c1> for</span><span style=color:#8fbcbb> usize</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#616e88>    /* ... */</span></span>
<span class=giallo-l><span style=color:#eceff4>}</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#81a1c1>mod</span><span> private</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#81a1c1>    pub trait</span><span style=color:#8fbcbb;font-weight:700> Sealed</span><span style=color:#eceff4> {}</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#616e88>    // Implement for those same types, but no others.</span></span>
<span class=giallo-l><span style=color:#81a1c1>    impl</span><span style=color:#8fbcbb> Sealed</span><span style=color:#81a1c1> for</span><span style=color:#8fbcbb> usize</span><span style=color:#eceff4> {}</span></span>
<span class=giallo-l><span style=color:#eceff4>}</span></span></code></pre><p>ãƒ¦ãƒ¼ã‚¶ã¯<code>private::Sealed</code>ã‚’å®Ÿè£…ã§ããªã„ã®ã§ã€çµæœçš„ã«<code>TheTrait</code>ã‚’å®Ÿè£…ã§ããšboundariesã®ã¿ã§åˆ©ç”¨ã§ãã‚‹ã€‚<br> libã§æ™‚ã€…ã¿ã‹ã‘ã¦ã€æœ€åˆã¯æ„å›³ãŒã‚ã‹ã£ã¦ã„ãªã‹ã£ãŸã®ã§ã™ãŒã€ãƒ¦ãƒ¼ã‚¶ã«traitã‚’å®Ÿè£…ã•ã‚Œã‚‹ã¨ã€traitã®signatureã®å¤‰æ›´ãŒç ´å£Šçš„å¤‰æ›´ã«ãªã‚‹ã“ã¨ã‚’ãã‚‰ã£ã¦ã®ã“ã¨ã ã¨ã‚ã‹ã‚Šã¾ã—ãŸã€‚ã‚‚ã£ã¨ã¯ã‚„ãã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã‚’èª­ã‚“ã§ãŠã‘ã°ã‚ˆã‹ã£ãŸã§ã™ã€‚<h3 id=structs-have-private-fields-c-struct-private><a aria-label="Anchor link for: structs-have-private-fields-c-struct-private" class=zola-anchor href=#structs-have-private-fields-c-struct-private><a href=https://rust-lang.github.io/api-guidelines/future-proofing.html#structs-have-private-fields-c-struct-private rel=external>Structs have private fields (C-STRUCT-PRIVATE)</a></a></h3><p>publicãªfieldã‚’ã‚‚ã¤ã“ã¨ã¯å¼·ã„commitmentã«ãªã‚‹ã€‚ãƒ¦ãƒ¼ã‚¶ã¯è‡ªç”±ã«ãã®fieldã‚’æ“ä½œã§ãã‚‹ã®ã§validationã‚„invariantã‚’ç¶­æŒã™ã‚‹ã“ã¨ãŒã§ããªããªã‚‹ã€‚<br> publicãªfieldã¯compoundã§passiveãªãƒ‡ãƒ¼ã‚¿æ§‹é€ ã«é©ã—ã¦ã„ã‚‹ã€‚(C spirit)<h3 id=newtypes-encapsulate-implementation-details-c-newtype-hide><a aria-label="Anchor link for: newtypes-encapsulate-implementation-details-c-newtype-hide" class=zola-anchor href=#newtypes-encapsulate-implementation-details-c-newtype-hide><a href=https://rust-lang.github.io/api-guidelines/future-proofing.html#newtypes-encapsulate-implementation-details-c-newtype-hide rel=external>Newtypes encapsulate implementation details (C-NEWTYPE-HIDE)</a></a></h3><p>ä»¥ä¸‹ã®ã‚ˆã†ãªiterationã«é–¢ã™ã‚‹ãƒ­ã‚¸ãƒƒã‚¯ã‚’æä¾›ã™ã‚‹<code>my_transform</code>ã‚’è€ƒãˆã‚‹<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=rust><span class=giallo-l><span style=color:#81a1c1>use</span><span> std</span><span style=color:#81a1c1>::</span><span>iter</span><span style=color:#81a1c1>::</span><span style=color:#eceff4>{</span><span style=color:#8fbcbb>Enumerate</span><span style=color:#eceff4>,</span><span style=color:#8fbcbb> Skip</span><span style=color:#eceff4>};</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#81a1c1>pub fn</span><span style=color:#88c0d0> my_transform</span><span style=color:#eceff4>&lt;</span><span style=color:#8fbcbb>I</span><span style=color:#81a1c1>:</span><span style=color:#8fbcbb> Iterator</span><span style=color:#eceff4>>(</span><span>input</span><span style=color:#81a1c1>:</span><span style=color:#8fbcbb> I</span><span style=color:#eceff4>)</span><span style=color:#81a1c1> -></span><span style=color:#8fbcbb> Enumerate</span><span style=color:#eceff4>&lt;</span><span style=color:#8fbcbb>Skip</span><span style=color:#eceff4>&lt;</span><span style=color:#8fbcbb>I</span><span style=color:#eceff4>>> {</span></span>
<span class=giallo-l><span>    input</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>skip</span><span style=color:#eceff4>(</span><span style=color:#b48ead>3</span><span style=color:#eceff4>)</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>enumerate</span><span style=color:#eceff4>()</span></span>
<span class=giallo-l><span style=color:#eceff4>}</span></span></code></pre><p><code>Enumerate&lt;Skip&lt;I>></code>ã‚’ãƒ¦ãƒ¼ã‚¶ã«ã¿ã›ãŸããªã„ã®ã§ã€Newtypeã§wrapã™ã‚‹ã¨<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=rust><span class=giallo-l><span style=color:#81a1c1>use</span><span> std</span><span style=color:#81a1c1>::</span><span>iter</span><span style=color:#81a1c1>::</span><span style=color:#eceff4>{</span><span style=color:#8fbcbb>Enumerate</span><span style=color:#eceff4>,</span><span style=color:#8fbcbb> Skip</span><span style=color:#eceff4>};</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#81a1c1>pub struct</span><span style=color:#8fbcbb> MyTransformResult</span><span style=color:#eceff4>&lt;</span><span style=color:#8fbcbb>I</span><span style=color:#eceff4>>(</span><span style=color:#8fbcbb>Enumerate</span><span style=color:#eceff4>&lt;</span><span style=color:#8fbcbb>Skip</span><span style=color:#eceff4>&lt;</span><span style=color:#8fbcbb>I</span><span style=color:#eceff4>>>);</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#81a1c1>impl</span><span style=color:#eceff4>&lt;</span><span style=color:#8fbcbb>I</span><span style=color:#81a1c1>:</span><span style=color:#8fbcbb> Iterator</span><span style=color:#eceff4>></span><span style=color:#8fbcbb> Iterator</span><span style=color:#81a1c1> for</span><span style=color:#8fbcbb> MyTransformResult</span><span style=color:#eceff4>&lt;</span><span style=color:#8fbcbb>I</span><span style=color:#eceff4>> {</span></span>
<span class=giallo-l><span style=color:#81a1c1>    type</span><span style=color:#8fbcbb> Item</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> (</span><span style=color:#8fbcbb>usize</span><span style=color:#eceff4>,</span><span style=color:#8fbcbb> I</span><span style=color:#81a1c1>::</span><span style=color:#8fbcbb>Item</span><span style=color:#eceff4>);</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#81a1c1>    fn</span><span style=color:#88c0d0> next</span><span style=color:#eceff4>(</span><span style=color:#81a1c1>&mut self</span><span style=color:#eceff4>)</span><span style=color:#81a1c1> -></span><span style=color:#8fbcbb> Option</span><span style=color:#eceff4>&lt;</span><span style=color:#81a1c1>Self::</span><span style=color:#8fbcbb>Item</span><span style=color:#eceff4>> {</span></span>
<span class=giallo-l><span style=color:#81a1c1>        self.</span><span style=color:#b48ead>0</span><span style=color:#eceff4>.</span><span style=color:#88c0d0>next</span><span style=color:#eceff4>()</span></span>
<span class=giallo-l><span style=color:#eceff4>    }</span></span>
<span class=giallo-l><span style=color:#eceff4>}</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#81a1c1>pub fn</span><span style=color:#88c0d0> my_transform</span><span style=color:#eceff4>&lt;</span><span style=color:#8fbcbb>I</span><span style=color:#81a1c1>:</span><span style=color:#8fbcbb> Iterator</span><span style=color:#eceff4>>(</span><span>input</span><span style=color:#81a1c1>:</span><span style=color:#8fbcbb> I</span><span style=color:#eceff4>)</span><span style=color:#81a1c1> -></span><span style=color:#8fbcbb> MyTransformResult</span><span style=color:#eceff4>&lt;</span><span style=color:#8fbcbb>I</span><span style=color:#eceff4>> {</span></span>
<span class=giallo-l><span style=color:#88c0d0>    MyTransformResult</span><span style=color:#eceff4>(</span><span>input</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>skip</span><span style=color:#eceff4>(</span><span style=color:#b48ead>3</span><span style=color:#eceff4>)</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>enumerate</span><span style=color:#eceff4>())</span></span>
<span class=giallo-l><span style=color:#eceff4>}</span></span></code></pre><p>ã“ã†ã™ã‚‹ã“ã¨ã§ã€ãƒ¦ãƒ¼ã‚¶å´ã®codeã‚’å£Šã™ã“ã¨ãªãå®Ÿè£…ã‚’å¤‰æ›´ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚<br> <code>my_transform&lt;I: Iterator>(input: I) -> impl Iterator&lt;Item =(usize, I::Item)></code>ã®ã‚ˆã†ãªsignatureã‚‚å¯èƒ½ã ãŒã€<code>impl Trait</code>ã«ã¯ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•ãŒã‚ã‚‹ã€‚<br> ä¾‹ãˆã°ã€<code>Debug</code>ã‚„<code>Clone</code>ã‚’æ›¸ã‘ãªã‹ã£ãŸã‚Šã™ã‚‹ã€‚<h3 id=data-structures-do-not-duplicate-derived-trait-bound-c-struct-bounds><a aria-label="Anchor link for: data-structures-do-not-duplicate-derived-trait-bound-c-struct-bounds" class=zola-anchor href=#data-structures-do-not-duplicate-derived-trait-bound-c-struct-bounds><a href=https://rust-lang.github.io/api-guidelines/future-proofing.html#data-structures-do-not-duplicate-derived-trait-bounds-c-struct-bounds rel=external>Data structures do not duplicate derived trait bound (C-STRUCT-BOUNDS)</a></a></h3><p>ã¡ã‚‡ã£ã¨ç†è§£ãŒã‚ã‚„ã—ã„ã§ã™ãŒã€trait boundã®è¨­ã‘ãŸstructå®šç¾©ã«<code>derive</code>ã‚’æ›¸ã‹ãªã„ã¨ã„ã†ã“ã¨ã§ã—ã‚‡ã†ã‹ã€‚<br> trait boundã‚’æ›¸ã‹ãªãã¦ã‚‚<code>derive</code>ã¯genericsãŒtraitã‚’å®Ÿè£…ã—ã¦ã„ã‚‹ã‹ã§åˆ¶å¾¡ã•ã‚Œã‚‹ã—ã€deriveã‚’è¿½åŠ ã™ã‚‹éš›ã«trait boundã‚’è¿½åŠ ã™ã‚‹ã¨ãã‚Œã¯breaking changeã«ãªã‚‹ã‹ã‚‰ã¨ã„ã†ç†è§£ã§ã™ã€‚<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=rust><span class=giallo-l><span style=color:#616e88>// Prefer this:</span></span>
<span class=giallo-l><span style=color:#5e81ac>#[derive(</span><span style=color:#8fbcbb>Clone</span><span style=color:#5e81ac>,</span><span style=color:#8fbcbb> Debug</span><span style=color:#5e81ac>,</span><span style=color:#8fbcbb> PartialEq</span><span style=color:#5e81ac>)]</span></span>
<span class=giallo-l><span style=color:#81a1c1>struct</span><span style=color:#8fbcbb> Good</span><span style=color:#eceff4>&lt;</span><span style=color:#8fbcbb>T</span><span style=color:#eceff4>> {</span><span style=color:#616e88> /* ... */</span><span style=color:#eceff4> }</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#616e88>// Over this:</span></span>
<span class=giallo-l><span style=color:#5e81ac>#[derive(</span><span style=color:#8fbcbb>Clone</span><span style=color:#5e81ac>,</span><span style=color:#8fbcbb> Debug</span><span style=color:#5e81ac>,</span><span style=color:#8fbcbb> PartialEq</span><span style=color:#5e81ac>)]</span></span>
<span class=giallo-l><span style=color:#81a1c1>struct</span><span style=color:#8fbcbb> Bad</span><span style=color:#eceff4>&lt;</span><span style=color:#8fbcbb>T</span><span style=color:#81a1c1>:</span><span style=color:#8fbcbb> Clone</span><span style=color:#81a1c1> +</span><span style=color:#8fbcbb> Debug</span><span style=color:#81a1c1> +</span><span style=color:#8fbcbb> PartialEq</span><span style=color:#eceff4>> {</span><span style=color:#616e88> /* ... */</span><span style=color:#eceff4> }</span></span></code></pre><h2 id=necessities><a aria-label="Anchor link for: necessities" class=zola-anchor href=#necessities><a href=https://rust-lang.github.io/api-guidelines/necessities.html#necessities rel=external>Necessities</a></a></h2><h3 id=public-dependencies-of-a-stable-crate-are-stable-c-stable><a aria-label="Anchor link for: public-dependencies-of-a-stable-crate-are-stable-c-stable" class=zola-anchor href=#public-dependencies-of-a-stable-crate-are-stable-c-stable><a href=https://rust-lang.github.io/api-guidelines/necessities.html#public-dependencies-of-a-stable-crate-are-stable-c-stable rel=external>Public dependencies of a stable crate are stable (C-STABLE)</a></a></h3><p>public dependenciesã®crateãŒstable(<code>>=1.0.0</code>)ã§ãªã‘ã‚Œã°ãã®crateã¯stableã«ã§ããªã„ã€‚<br> <code>From</code>ã®å®Ÿè£…ç­‰ã€public dependenciesã¯ä»¥å¤–ãªã¨ã“ã‚ã«ç¾ã‚Œã‚‹ã€‚<h3 id=crate-and-its-dependencies-have-a-permissive-licence-c-permissive><a aria-label="Anchor link for: crate-and-its-dependencies-have-a-permissive-licence-c-permissive" class=zola-anchor href=#crate-and-its-dependencies-have-a-permissive-licence-c-permissive><a href=https://rust-lang.github.io/api-guidelines/necessities.html#crate-and-its-dependencies-have-a-permissive-license-c-permissive rel=external>Crate and its dependencies have a permissive licence (C-PERMISSIVE)</a></a></h3><p>Rust projectã§ä½œã‚‰ã‚Œã¦ã„ã‚‹softwareã¯<a href=https://github.com/rust-lang/rust/blob/master/LICENSE-MIT rel=external>MIT</a>ã‹<a href=https://github.com/rust-lang/rust/blob/master/LICENSE-APACHE rel=external>Apache 2.0</a>ã®dual licenseã«ãªã£ã¦ã„ã‚‹ã€‚<br> Rustã®ecosystemã¨ã®è¦ªå’Œæ€§ã‚’é‡è¦–ã™ã‚‹ãªã‚‰åŒã˜ã‚ˆã†ã«ã—ã¦ãŠãã€‚<br> crateã®dependenciesã®licenseã¯crateè‡ªèº«ã«å½±éŸ¿ã™ã‚‹ã®ã§ã€permissively-licensed crateã¯ä¸€èˆ¬çš„ã«permissively-licensed crateã®ã¿ã‚’åˆ©ç”¨ã™ã‚‹ã€‚<h2 id=matome><a aria-label="Anchor link for: matome" class=zola-anchor href=#matome>ã¾ã¨ã‚</a></h2><p>Rustã®api guidelineã‚’ã–ã£ã¨çœºã‚ã¦ã¿ã¾ã—ãŸã€‚<br> ã„ã‚ã„ã‚ãªcrateã§å…±é€šã—ã¦ã„ã‚‹ã“ã¨ãŒæ›¸ã‹ã‚Œã¦ã„ãŸå°è±¡ã§ã™ã€‚<br> è‡ªåˆ†ã§æ›¸ã„ãŸã‚Šã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ã—ãŸã‚Šã™ã‚‹éš›ã«å‚ç…§ã—ã¦ã„ããŸã„ã§ã™ã€‚</div></article></main><footer class=blog-footer><p>Â© 2026 <a href=https://blog.ymgyt.io> ymgyt </a> | Made with <a href=https://www.getzola.org rel=noopener target=_blank>Zola</a> | <a href=https://github.com/ymgyt/blog>Repository</a> | <a href=https://blog.ymgyt.io/atom.xml target=_blank title=rss> <svg viewbox="0 0 24 24" class=icon fill=none height=24 stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 width=24 xmlns=http://www.w3.org/2000/svg><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx=5 cy=19 r=1></circle></svg> </a></footer></div></div>