<!doctype html><html lang=ja><head><meta charset=UTF-8><meta content="width=device-width,initial-scale=1" name=viewport><link href=https://blog.ymgyt.io/favicon.ico rel=icon sizes=any><link href=https://blog.ymgyt.io/icon.svg rel=icon type=image/svg+xml><link href=https://blog.ymgyt.io/apple-touch-icon.png rel=apple-touch-icon><link href=https://blog.ymgyt.io/manifest.webmanifest rel=manifest><link href=https://blog.ymgyt.io/style.css rel=stylesheet><link href=https://blog.ymgyt.io/atom.xml rel=alternate title=Atom type=application/atom+xml><script src="https://www.googletagmanager.com/gtag/js?id=G-GTB0KMLN90" async></script><script>window.dataLayer = window.dataLayer || [];
	function gtag() {dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-GTB0KMLN90');</script><title>ğŸ“¦ Nixã§linuxã¨macã®ç’°å¢ƒã‚’ç®¡ç†ã—ã¦ã¿ã‚‹ | Happy developing</title><meta content=Nixã‚’åˆ©ç”¨ã—ã¦linuxã¨macã®é–‹ç™ºç’°å¢ƒã‚’å®£è¨€çš„ã«ç®¡ç†ã™ã‚‹ã€‚ name=description><meta content=summary name=twitter:card><meta content="@YAmaguchixt " name=twitter:site><meta content="ğŸ“¦ Nixã§linuxã¨macã®ç’°å¢ƒã‚’ç®¡ç†ã—ã¦ã¿ã‚‹" name=twitter:title><meta content=Nixã‚’åˆ©ç”¨ã—ã¦linuxã¨macã®é–‹ç™ºç’°å¢ƒã‚’å®£è¨€çš„ã«ç®¡ç†ã™ã‚‹ã€‚ name=twitter:description><meta content=https://blog.ymgyt.io/images/emoji/package.png name=twitter:image><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><body><div class=world><div class=content-container><header class=blog-header-container><div class=blog-logo><a href=https://blog.ymgyt.io>Happy developing</a></div><div class=blog-nav><nav><ul><li><a href=https://blog.ymgyt.io/entry/>Entries</a><li><a href=https://blog.ymgyt.io/tags/>Tags</a><li><a href=https://blog.ymgyt.io/about/>About</a><li><a href=https://github.com/ymgyt> <img alt=Github class=icon src=https://blog.ymgyt.io/images/icon/github.svg> </a><li><a href="https://twitter.com/YAmaguchixt "> <img alt=Twitter class=icon src=https://blog.ymgyt.io/images/icon/twitter.svg> </a></ul></nav></div></header><main class=blog-main><article><header class=entry-header><h1 class=entry-title>ğŸ“¦ Nixã§linuxã¨macã®ç’°å¢ƒã‚’ç®¡ç†ã—ã¦ã¿ã‚‹</h1><div class=entry-meta><p class=entry-meta-item>ğŸ—“ 2023-06-13<p class=entry-meta-item>ğŸ· <span class=tag><a href=https://blog.ymgyt.io/tags/nix/>nix</a></span></div></header><aside class=entry-toc><nav><ul class=entry-toc-toplevel-list><li><a href=https://blog.ymgyt.io/entry/declarative-environment-management-with-nix/#somosomonixtoha>ãã‚‚ãã‚‚Nixã¨ã¯</a> <ul><li><a href=https://blog.ymgyt.io/entry/declarative-environment-management-with-nix/#nixnoxian-zhuang-toflake>Nixã®ç¾çŠ¶ã¨flake</a></ul><li><a href=https://blog.ymgyt.io/entry/declarative-environment-management-with-nix/#flaketoha>Flakeã¨ã¯</a> <ul><li><a href=https://blog.ymgyt.io/entry/declarative-environment-management-with-nix/#nix-xxxtonix-xxx>nix xxxã¨nix-xxx</a></ul><li><a href=https://blog.ymgyt.io/entry/declarative-environment-management-with-nix/#nixnoinstall>Nixã®install</a><li><a href=https://blog.ymgyt.io/entry/declarative-environment-management-with-nix/#flake-nix>flake.nix</a> <ul><li><a href=https://blog.ymgyt.io/entry/declarative-environment-management-with-nix/#nix-language>Nix Language</a><li><a href=https://blog.ymgyt.io/entry/declarative-environment-management-with-nix/#inputstooutputs>inputsã¨outputs</a></ul><li><a href=https://blog.ymgyt.io/entry/declarative-environment-management-with-nix/#nixosconfiguration>nixosConfiguration</a> <ul><li><a href=https://blog.ymgyt.io/entry/declarative-environment-management-with-nix/#input-method>Input method</a><li><a href=https://blog.ymgyt.io/entry/declarative-environment-management-with-nix/#font>Font</a><li><a href=https://blog.ymgyt.io/entry/declarative-environment-management-with-nix/#home-manager>home-manager</a></ul><li><a href=https://blog.ymgyt.io/entry/declarative-environment-management-with-nix/#shi-yong>é©ç”¨</a><li><a href=https://blog.ymgyt.io/entry/declarative-environment-management-with-nix/#mac-darwin>Mac(darwin)</a><li><a href=https://blog.ymgyt.io/entry/declarative-environment-management-with-nix/#ke-ti>èª²é¡Œ</a><li><a href=https://blog.ymgyt.io/entry/declarative-environment-management-with-nix/#can-kao>å‚è€ƒ</a><li><a href=https://blog.ymgyt.io/entry/declarative-environment-management-with-nix/#matome>ã¾ã¨ã‚</a></ul></nav></aside><div class=entry-content><p>æœ¬è¨˜äº‹ã§ã¯<a href=https://nixos.org/ rel=external>Nix</a>ã‚’åˆ©ç”¨ã—ã¦ã€linux(nixos)ã¨macã®é–‹ç™ºç’°å¢ƒã‚’å®£è¨€çš„ã«ç®¡ç†ã—ã¦ã„ãæ–¹æ³•ã«ã¤ã„ã¦æ›¸ãã¾ã™ã€‚<br> è¨­å®šã¯ä¸€ã¤ã®repositoryã§ç®¡ç†ã—ã€git cloneã—ã¦ã€<code>makers apply</code>ã‚’å®Ÿè¡Œã™ã‚‹ã ã‘ã¨ã„ã†çŠ¶æ…‹ã‚’ç›®æŒ‡ã—ã¾ã™ã€‚<br> ä¾å­˜ã—ã¦ã„ã„ã®ã¯<code>nix</code>ã®ã¿ã¨ã—ã¾ã™ã€‚<br> ç¾çŠ¶è¨­å®šã§ãã¦ã„ã‚‹å†…å®¹ã¯ä»¥ä¸‹ã§ã™ã€‚<ul><li>SSH(daemonã®èµ·å‹•, authenticationæ–¹æ³•, userã®authorized keyã®è¨­ç½®)<li>Font<li>Timezone<li>Input method<li>Desktop environment<li>User<li>Package(å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰+è¨­å®šfile)</ul><p>ä½œæˆã—ãŸ<a href=https://github.com/ymgyt/mynix/tree/main rel=external>repository</a><br> Nixã«ã¤ã„ã¦ã¾ã ã¾ã ã‚ã‹ã£ã¦ã„ãªã„ã“ã¨ãŒå¤šã„ã®ã§ã™ãŒã€ã²ã¨ã¾ãšä½¿ã„å§‹ã‚ã‚‰ã‚ŒãŸæ„Ÿã˜ã§ã™ã€‚<h2 id=somosomonixtoha><a aria-label="Anchor link for: somosomonixtoha" class=zola-anchor href=#somosomonixtoha>ãã‚‚ãã‚‚Nixã¨ã¯</a></h2><p>ç¾çŠ¶ã®è‡ªåˆ†ã®ç†è§£ã§ã¯Nixã¨ã¯package manager + build systemã¨ã„ã†èªè­˜ã§ã™ã€‚ æ–‡è„ˆã«ã‚ˆã£ã¦ã¯projectã‚„ecosystemå…¨ä½“ã‚’æŒ‡ã™å ´åˆã‚‚ã‚ã‚Šã¾ã™ã€‚<br> Installã™ã‚‹ã¨<code>nix</code> commandãŒä½¿ãˆã‚‹ã‚ˆã†ã«ãªã‚Šã“ã‚Œè‡ªä½“ã¯package managerçš„ãªå½¹å‰²ã‚‚æ‹…ã„ã¾ã™ã€‚<br> ã¾ãŸã€mac, linuxå…±é€šã§åˆ©ç”¨ã§ãã¾ã™ã€‚<br> Macã§ã„ã†ã¨<code>brew</code>ã®æ›¿ã‚ã‚Šã«ä½¿ã†ã‚¤ãƒ¡ãƒ¼ã‚¸ã§ã™ã€‚å¿…è¦ã«å¿œã˜ã¦install commandã‚’å®Ÿè¡Œã™ã‚‹ã‚ˆã†ãªä½¿ã„æ–¹ã§ã¯<code>brew</code>ã§ã„ã„ã˜ã‚ƒã‚“ã¨ãªã‚‹ã®ã§ã€installã•ã‚Œã¦ã„ã‚‹ã¹ãcommandä¸€è¦§ã‚’å®šç¾©ã—ã¦ãŠãã¨ã„ã†é‹ç”¨ã«ãªã‚Šã¾ã™ã€‚<br> NixOSã¯nixã‚’å‰æã¨ã—ãŸlinux distributionã§ã™ã€‚<h3 id=nixnoxian-zhuang-toflake><a aria-label="Anchor link for: nixnoxian-zhuang-toflake" class=zola-anchor href=#nixnoxian-zhuang-toflake>Nixã®ç¾çŠ¶ã¨flake</a></h3><p>2023/06/12ç¾åœ¨ã®nixã«ã¯flakeã¨ã„ã†experimentalãªæ©Ÿèƒ½ãŒè¿½åŠ ã•ã‚Œã¦ã„ã¾ã™ã€‚<br> ã“ã®experimentalã¨ã„ã†ã®ãŒãªã‚“ã¨ã‚‚æ‚©ã¾ã—ãã€æ—¢å­˜ã®nixã®å•é¡Œç‚¹ã‚’è§£æ¶ˆã™ã‚‹ãŸã‚ã«è¿½åŠ ã•ã‚ŒãŸã‚‚ã®ã§ã€documentã«ã‚ˆã£ã¦ã¯ä»Šã‹ã‚‰nixã‚’å§‹ã‚ã‚‹ãªã‚‰flakeã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã‚’è–¦ã‚ã‚‰ã‚Œã¦ã„ãŸã‚Šã—ã¾ã™ã€‚<blockquote><p>Although they are still experimental features as of 2023-05-05, they have been widely used by the Nix community and are strongly recommended.</blockquote><p>https://thiscute.world/en/posts/nixos-and-flake-basics<blockquote><p>We strongly recommend, however, that you learn to use flakes if you're already a Nix user or to begin your Nix journey with flakes rather than channels if you're just getting started with Nix.</blockquote><p>https://zero-to-nix.com/concepts/flakes<p>ã¨ã„ã†ã“ã¨ã§ä»¥ä¸‹ã§ã¯flakeã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã‚’å‰æã¨ã—ã¦ã„ã¾ã™ã€‚<h2 id=flaketoha><a aria-label="Anchor link for: flaketoha" class=zola-anchor href=#flaketoha>Flakeã¨ã¯</a></h2><p>ãã‚Œã§ã¯ã€ãã®flakeã¨ã¯ä½•ãªã®ã‹ã¨ã„ã†è©±ã§ã™ãŒã€è‡ªåˆ†ã¯nixã«ãŠã‘ã‚‹rustã®package(crateã§ã¯ãªãã¦)ã¨ç†è§£ã—ã¦ã„ã¾ã™ã€‚è¦ã¯æˆæœç‰©ã‚„ãã®ä¾å­˜ã®å˜ä½ã§ã™ã€‚<br> å½¢å¼çš„ã«ã¯<code>.git</code>ãŒã‚ã‚‹ã¨ãã®directory treeãŒgit repositoryã«ãªã‚‹ã®ã¨åŒã˜ã§<code>flake.nix</code>ãŒã‚ã‚‹ã¨ãã®directory treeãŒflakeã«ãªã‚Šã¾ã™ã€‚<br> ã‚‚ã—gitã®repositoryã§<code>flake.nix</code> fileãŒç½®ã„ã¦ã‚ã‚Œã°ãã®repositoryã¯flakeã§ã™ã€‚<a href=https://github.com/helix-editor/helix/blob/master/flake.nix rel=external>Helixã«ã‚‚ç½®ã„ã¦ã‚ã‚Šã¾ã—ãŸ</a><h3 id=nix-xxxtonix-xxx><a aria-label="Anchor link for: nix-xxxtonix-xxx" class=zola-anchor href=#nix-xxxtonix-xxx><code>nix xxx</code>ã¨<code>nix-xxx</code></a></h3><p>Nixã®documentã‚„blogã‚’ã¿ã‚‹ã¨<code>nix-env</code>ã‚„<code>nix-shell</code>ã¨ã„ã£ãŸ<code>nix-xxx</code>ç³»ã®commandã¨<code>nix shell</code>, <code>nix run</code>ã¨ã„ã£ãŸã€subcommand likeãª<code>nix xxx</code>ã®æƒ…å ±ãŒæ··åœ¨ã—ã¦ã„ã‚‹ã‹ã¨æ€ã„ã¾ã™ã€‚<br> åŸºæœ¬çš„ã«<code>nix xxx</code>ã®ã»ã†ãŒflakeã‚’å‰æã¨ã—ã¦experimentalãªæ©Ÿèƒ½ã¨ã„ã†ã“ã¨ã¿ãŸã„ã§ã™ã€‚å¾“ã£ã¦å…¬å¼ã®docã¯ã¾ã <code>nix-xxx</code>ç³»ã«ã¤ã„ã¦æ›¸ã‹ã‚Œã¦ã„ã¾ã™ã€‚<br> ä»ŠãŒã¡ã‚‡ã†ã©nixã®ecosystemã®éæ¸¡æœŸã«ã‚ã‚‹ã¨æ€ã‚ã‚Œã€å…¬å¼ã®documentã¯experimentalãªæ©Ÿèƒ½ãŒstableã«ãªã£ã¦ã‹ã‚‰æ•´å‚™ã•ã‚Œã¦ã„ãã®ã§ã¯ã¨æ€ã£ã¦ãŠã‚Šã¾ã™ã€‚<br> ã¨ã„ã†ã‚ˆã†ãªè©±ãŒæœ€åˆã¯ã‚ã‹ã‚‰ãšã«ã¨ã¦ã‚‚æ··ä¹±ã—ã¾ã—ãŸã€‚<br> ã“ã¡ã‚‰ã®<a href=https://qiita.com/Sumi-Sumi/items/6de9ee7aab10bc0dbead rel=external>nixã®ã‚³ãƒãƒ³ãƒ‰ã‚’è§£èª¬ã—ã¦ã¿ã‚‹</a>ã®ã¾ã¨ã‚ã¯ã¨ã¦ã‚‚å‚è€ƒã«ãªã‚Šã¾ã—ãŸã€‚<h2 id=nixnoinstall><a aria-label="Anchor link for: nixnoinstall" class=zola-anchor href=#nixnoinstall>Nixã®install</a></h2><p>Nixã®installãªã®ã§ã™ãŒã€ç¾çŠ¶é¸æŠè‚¢ãŒ2ã¤ã‚ã‚‹ã¨æ€ã£ã¦ã„ã¾ã™ã€‚<br> 1ã¤ãŒ<a href=https://nixos.org/download.html rel=external>å…¬å¼</a>ã§ã€ã‚‚ã†1ã¤ãŒDeterminatesSystemsãŒæä¾›ã—ã¦ã„ã‚‹<a href=https://github.com/DeterminateSystems/nix-installer rel=external>nix-installer</a>ã§ã™ã€‚<br> å…¬å¼ã‚’é¸ã°ãªã„ç†ç”±ãŒã‚ã‚‹ã®ã‹ã¨æ€ã„ã¾ã™ãŒã€DeterminateSystemsã®nix-installerã‚’é¸ã³ãŸããªã‚‹ç†ç”±ã¯<ul><li>Uninstallæ©Ÿèƒ½ã‚’æä¾›ã—ã¦ã„ã‚‹<li>Defaultã§flakeãŒæœ‰åŠ¹<li>Rustè£½</ul><p>è£ã‚’è¿”ã™ã¨å…¬å¼ã«ã¯uninstallæ©Ÿèƒ½ãŒã‚ã‚Šã¾ã›ã‚“ã€‚ãŸã ã—<a href=https://github.com/NixOS/nix/blob/master/doc/manual/src/installation/uninstall.md#macos rel=external>doc</a>ã«ã¯æ‰‹é †ã®èª¬æ˜ãŒã‚ã‚Šã¾ã™ã€‚<br> ã¾ãŸflakeã¯experimentalãªã®ã§ãªã‚“ã‚‰ã‹ã®æ–¹æ³•ã§æœ‰åŠ¹ã«ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚(<code>~/.config/nix/nix.conf</code>ã‚’ä½œæˆã™ã‚‹)<br> è‡ªåˆ†ã¯ä¸¡æ–¹è©¦ã—ã¦ã©ã¡ã‚‰ã®æ–¹æ³•ã§ã‚‚å•é¡Œãªãä½¿ãˆã¦ã„ã¾ã™ã€‚<br> Uninstallæ©Ÿèƒ½ã¾ã§ã¤ã„ã¦ã„ã‚‹ã»ã†ãŒä»–äººã‚„ãƒãƒ¼ãƒ ã«è–¦ã‚ã‚„ã™ã„ã¨æ€ã„ã¾ã™ã€‚<h2 id=flake-nix><a aria-label="Anchor link for: flake-nix" class=zola-anchor href=#flake-nix><code>flake.nix</code></a></h2><p>ã“ã“ã¾ã§æŠ½è±¡çš„ãªè©±ã ã£ãŸã®ã§ã€ã„ã‚ˆã„ã‚ˆå…·ä½“çš„ã«è¨­å®šã‚’è¦‹ã¦ã„ãã¾ã™ã€‚<br> ã¾ãšprojectã®rootã«ç½®ã<code>flake.nix</code> fileã§ã™ã€‚<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=nix><span class=giallo-l><span style=color:#eceff4>{</span></span>
<span class=giallo-l><span style=color:#8fbcbb>  description</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> "</span><span style=color:#a3be8c>Nix configuration of ymgyt</span><span style=color:#eceff4>"</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#8fbcbb>  inputs</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#8fbcbb>    nixpkgs</span><span>.</span><span style=color:#8fbcbb>url</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> "</span><span style=color:#a3be8c>github:NixOS/nixpkgs/nixos-unstable</span><span style=color:#eceff4>"</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#8fbcbb>    home-manager</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#8fbcbb>      url</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> "</span><span style=color:#a3be8c>github:nix-community/home-manager/release-23.05</span><span style=color:#eceff4>"</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#8fbcbb>      inputs</span><span>.</span><span style=color:#8fbcbb>nixpkgs</span><span>.</span><span style=color:#8fbcbb>follows</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> "</span><span style=color:#a3be8c>nixpkgs</span><span style=color:#eceff4>"</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#eceff4>    }</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#eceff4>  }</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#8fbcbb>  outputs</span><span style=color:#81a1c1> =</span></span>
<span class=giallo-l><span style=color:#eceff4>    {</span><span> nixpkgs</span></span>
<span class=giallo-l><span style=color:#81a1c1>    ,</span><span> home-manager</span></span>
<span class=giallo-l><span style=color:#81a1c1>    , ...</span></span>
<span class=giallo-l><span style=color:#eceff4>    }: {</span></span>
<span class=giallo-l><span style=color:#8fbcbb>      nixosConfigurations</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#8fbcbb>        xps15</span><span style=color:#81a1c1> =</span><span> nixpkgs</span><span style=color:#81a1c1>.</span><span>lib</span><span style=color:#81a1c1>.</span><span>nixosSystem</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#8fbcbb>          system</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> "</span><span style=color:#a3be8c>x86_64-linux</span><span style=color:#eceff4>"</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#8fbcbb>          modules</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> [</span></span>
<span class=giallo-l><span style=color:#a3be8c>            ./hosts/xps15</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span>            home-manager</span><span style=color:#81a1c1>.</span><span>nixosModules</span><span style=color:#81a1c1>.</span><span>home-manager</span></span>
<span class=giallo-l><span style=color:#eceff4>            {</span></span>
<span class=giallo-l><span style=color:#8fbcbb>              home-manager</span><span>.</span><span style=color:#8fbcbb>useGlobalPkgs</span><span style=color:#81a1c1> = true;</span></span>
<span class=giallo-l><span style=color:#8fbcbb>              home-manager</span><span>.</span><span style=color:#8fbcbb>useUserPackages</span><span style=color:#81a1c1> = true;</span></span>
<span class=giallo-l><span style=color:#8fbcbb>              home-manager</span><span>.</span><span style=color:#8fbcbb>users</span><span>.</span><span style=color:#8fbcbb>ymgyt</span><span style=color:#81a1c1> =</span><span style=color:#88c0d0> import</span><span style=color:#a3be8c> ./home/linux</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#eceff4>            }</span></span>
<span class=giallo-l><span style=color:#eceff4>          ]</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#eceff4>        }</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#eceff4>      }</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#eceff4>    }</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#eceff4>}</span></span></code></pre><p>ä¸Šè¨˜ãŒnixosã®è¨­å®šã‚’ç®¡ç†ã™ã‚‹flakeã§ã™ã€‚<br> ã¾ãšflakeå«ã‚ã€nixã®è¨­å®šã¯<a href=https://nixos.org/manual/nix/stable/language/index.html rel=external>nix language</a>ã§æ›¸ãã¾ã™ã€‚<h3 id=nix-language><a aria-label="Anchor link for: nix-language" class=zola-anchor href=#nix-language>Nix Language</a></h3><p>Nix languageã¯<blockquote><p>domain-specific It only exists for the Nix package manager: to describe packages and configurations as well as their variants and compositions. It is not intended for general purpose use.</blockquote><p>https://nixos.org/manual/nix/stable/language/index.html<p>ã¨ã‚ã‚‹ã‚ˆã†ã«ã€nixã®è¨­å®šã‚’ç®¡ç†ã™ã‚‹ãŸã‚ã®DSLã§ã™ã€‚ä»¥ä¸‹ã§ã¯æœ¬è¨˜äº‹ã‚’èª­ã‚€ã®ã«å¿…è¦ãªé™ã‚Šã§nix languageã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚<p>ã¾ãšã€<code>{ ... }</code>ã¯attribute setã§ã€jsonã®objectã®ã‚ˆã†ãªã‚‚ã®ã§ã™ã€‚nixã¯fileã‚’è©•ä¾¡ã™ã‚‹ã¨ä¸€ã¤ã®å€¤ã‚’è¿”ã™å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚<code>flake.nix</code>ã¯<code>{ ... }</code>ã§å›²ã¾ã‚Œã¦ã„ã‚‹ã®ã§attribute setã‚’è¿”ã—ã¦ã„ã¾ã™ã€‚<br> æ¬¡ã«<code>:</code>ãŒã§ã¦ããŸã‚‰ãã‚Œã¯é–¢æ•°ã§å·¦å´ãŒå¼•æ•°ã€å³å´ãŒé–¢æ•°ã®bodyã§ã™ã€‚<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=nix><span class=giallo-l><span style=color:#eceff4>{</span></span>
<span class=giallo-l><span style=color:#8fbcbb>  outputs</span><span style=color:#81a1c1> =</span></span>
<span class=giallo-l><span style=color:#eceff4>    {</span><span> nixpkgs</span></span>
<span class=giallo-l><span style=color:#81a1c1>    ,</span><span> home-manager</span></span>
<span class=giallo-l><span style=color:#81a1c1>    , ...</span></span>
<span class=giallo-l><span style=color:#eceff4>    }: {</span></span>
<span class=giallo-l><span style=color:#8fbcbb>      nixosConfigurations</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> {</span><span style=color:#616e88> /* ... */</span><span style=color:#eceff4> }</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#eceff4>  }</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#eceff4>}</span></span></code></pre><p>ã“ã®éƒ¨åˆ†ã¯outputsã¨ã„ã†keyã«nixpkgs,ã¨home-managerã‚’å¼•æ•°ã¨ã—ã¦ã€nixosConfigurationsã‚’keyã«ã—ãŸattribute setã‚’è¿”ã™é–¢æ•°ã‚’setã—ã¦ã„ã‚‹ã¨èª­ã‚ã¾ã™ã€‚<p>ã¾ãŸ<blockquote><p>lazy Expressions are only evaluated when their value is needed.</blockquote><p>https://nixos.org/manual/nix/stable/language/index.html<p>ã¨ã‚ã‚‹ã‚ˆã†ã«ã€å€¤ãŒå‚ç…§ã•ã‚ŒãŸã¨ãã«åˆã‚ã¦è©•ä¾¡ãŒèµ°ã‚‹ã‚ˆã†ã§ã™ã€ã“ã®ç‚¹ã¯å¾Œã§é‡ãã†ãªå‡¦ç†ã„ã‚ã„ã‚è¿½åŠ ã—ã¦ã‚‚å®Ÿéš›ã«å®Ÿè¡Œã™ã‚‹å‡¦ç†ã ã‘ã—ã‹èµ°ã‚‰ãªã„ã“ã¨ã«å½±éŸ¿ã—ã¾ã™ã€‚<br> <del>ã‚ã¨ã¯é–¢æ•°å‹ãªã®ã§for loopãŒã§ã¦ãã¾ã›ã‚“</del><h3 id=inputstooutputs><a aria-label="Anchor link for: inputstooutputs" class=zola-anchor href=#inputstooutputs>inputsã¨outputs</a></h3><pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=nix><span class=giallo-l><span style=color:#eceff4>{</span></span>
<span class=giallo-l><span style=color:#8fbcbb>  inputs</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#8fbcbb>    nixpkgs</span><span>.</span><span style=color:#8fbcbb>url</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> "</span><span style=color:#a3be8c>github:NixOS/nixpkgs/nixos-unstable</span><span style=color:#eceff4>"</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#8fbcbb>    home-manager</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#8fbcbb>      url</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> "</span><span style=color:#a3be8c>github:nix-community/home-manager/release-23.05</span><span style=color:#eceff4>"</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#8fbcbb>      inputs</span><span>.</span><span style=color:#8fbcbb>nixpkgs</span><span>.</span><span style=color:#8fbcbb>follows</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> "</span><span style=color:#a3be8c>nixpkgs</span><span style=color:#eceff4>"</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#eceff4>    }</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#eceff4>  }</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#8fbcbb>  outputs</span><span style=color:#81a1c1> =</span></span>
<span class=giallo-l><span style=color:#eceff4>    {</span><span> nixpkgs</span></span>
<span class=giallo-l><span style=color:#81a1c1>    ,</span><span> home-manager</span></span>
<span class=giallo-l><span style=color:#81a1c1>    , ...</span></span>
<span class=giallo-l><span style=color:#eceff4>    }: {</span></span>
<span class=giallo-l><span style=color:#8fbcbb>      nixosConfigurations</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> {</span><span style=color:#616e88> /* ... */</span><span style=color:#eceff4> }</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#eceff4>}</span></span></code></pre><p>ã‚ã‚‰ãŸã‚ã¦<code>flake.nix</code>ã‚’ã¿ã¦ã¿ã¾ã™ã€‚ã¾ãš<code>inputs</code>ã¯ã“ã®flake(project)ã®ä¾å­˜å…ˆã‚’å®£è¨€ã—ã¦ã„ã¾ã™ã€‚<br> <code>nixpkgs.url = "github:NixOS/nixpkgs/nixos-unstable";</code>ã¨ã‚ã‚‹ã®ã§ã€githubã®nixpkgs repositoryã«ä¾å­˜ã—ã¦ã„ã¾ã™ã€‚<br> ã“ã®<a href=https://github.com/NixOS/nixpkgs rel=external>nixpkgs repositor</a>ã‚‚flakeã§ã€nix package managerãŒç®¡ç†ã—ã¦ã„ã‚‹packageã¯ã“ã“ã§ã™ã¹ã¦ç®¡ç†ã•ã‚Œã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚<br> packageã®æ¢ã—æ–¹ã¯<a href=https://search.nixos.org/packages rel=external>å…¬å¼</a>ã‹ã€<code>nix search nixpkgs xxx</code>ã§ã™ã€‚å…¬å¼ã‚’ã¿ã‚‹ã¨80,000 packageä»¥ä¸Šã‚ã‚‹ã¨æ›¸ã„ã¦ã‚ã‚Šã¾ã™ã€‚(cargo-nextestã®ã‚ˆã†ãªcargoã®subcommandã ã‘ã§100ä»¥ä¸Šã‚ã‚Šã¾ã—ãŸ)<br> ã“ã®<code>flake.nix</code>ã‚’å‚ç…§ã—ã¦æˆæœç‰©ã‚’ä½œæˆã™ã‚‹ã¨ã€<code>flake.lock</code>ãŒä½œæˆã•ã‚Œã¾ã™ã€‚ã“ã‚Œã¯ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªã®lock fileã¨åŒæ§˜ã«å®£è¨€ã•ã‚ŒãŸä¾å­˜ãŒå®Ÿéš›ã«è§£æ±ºã•ã‚ŒãŸéš›ã®revisionç­‰ã‚’è¨˜éŒ²ã™ã‚‹ã‚‚ã®ã§ã™ã€‚<br> å®Ÿéš›ã€ã«<code>flake.lock</code>ã«ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªæƒ…å ±ãŒè¨˜è¼‰ã•ã‚Œã¦ã„ã¾ã—ãŸã€‚<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=plain><span class=giallo-l><span>"nixpkgs": {</span></span>
<span class=giallo-l><span>  "locked": {</span></span>
<span class=giallo-l><span>    "lastModified": 1686020360,</span></span>
<span class=giallo-l><span>    "narHash": "sha256-Wee7lIlZ6DIZHHLiNxU5KdYZQl0iprENXa/czzI6Cj4=",</span></span>
<span class=giallo-l><span>    "owner": "NixOS",</span></span>
<span class=giallo-l><span>    "repo": "nixpkgs",</span></span>
<span class=giallo-l><span>    "rev": "4729ffac6fd12e26e5a8de002781ffc49b0e94b7",</span></span>
<span class=giallo-l><span>    "type": "github"</span></span>
<span class=giallo-l><span>  },</span></span>
<span class=giallo-l><span>  "original": {</span></span>
<span class=giallo-l><span>    "owner": "NixOS",</span></span>
<span class=giallo-l><span>    "ref": "nixos-unstable",</span></span>
<span class=giallo-l><span>    "repo": "nixpkgs",</span></span>
<span class=giallo-l><span>    "type": "github"</span></span>
<span class=giallo-l><span>  }</span></span>
<span class=giallo-l><span>},</span></span></code></pre><p>ä¾å­˜å…ˆã®flakeã«ã‚‚<code>flake.lock</code>ãŒã‚ã‚‹ã®ã§ã€çµæœçš„ã«buildæ™‚ã«å®Ÿéš›ã«ä¾å­˜ã—ã¦ã„ã‚‹ã‚‚ã®ãŒä¸€æ„ã«å®šã¾ã‚Šã¾ã™ã€‚<br> ã“ã‚ŒãŒnixãŒè¬³ã£ã¦ã„ã‚‹reproducibleãªç‚¹ã‚’å®Ÿç¾ã—ã¦ã„ã‚‹ã¨è€ƒãˆã¦ã„ã¾ã™ã€‚<br> ãªã‚“ã¨ã„ã†ã‹ã€rustã®å ´åˆã€projectã®buildå¯¾è±¡ã¯libraryã‹å®Ÿè¡Œã™ã‚‹binaryã‹ã ã¨æ€ã„ã¾ã™ãŒã€nixã¯ãã‚Œã‚‰ã‚’ãªã‚“ã‚‰ã‹ã®buildã™ã‚‹ã‚‚ã®ã«æ‹¡å¼µã—ãŸã‚ˆã†ãªä»•çµ„ã¿ãªã®ã‹ãªã¨æ€ã£ã¦ã„ã¾ã™ã€‚(ã¤ã¾ã‚Šprojectã®buildã‚’ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªã«ä¾ã‚‰ãšã«nixã§ç®¡ç†ã§ãã‚‹ã¨ã„ã†ã“ã¨)<p>ã“ã“ã§ãªã‚“ã‚‰ã‹ã®buildã§ãã‚‹ã‚‚ã®ã¨è¨€ã„ã¾ã—ãŸãŒã€å…·ä½“çš„ã«ã¯ä½•ã¨ã„ã†è©±ã«ãªã‚Šã¾ã™ã€‚<br> ä»Šå›ã¯<code>nixosConfiguration</code>ãªã®ã§ã€nixosã®è¨­å®šã§ã™ã€‚<br> ã“ã‚Œä»¥å¤–ã«ãªã«ãŒè¨­å®šã§ãã‚‹ã‹ã¯<a href=https://nixos.wiki/wiki/Flakes rel=external>wiki</a>ã«è¼‰ã£ã¦ã„ã¾ã—ãŸã€‚<h2 id=nixosconfiguration><a aria-label="Anchor link for: nixosconfiguration" class=zola-anchor href=#nixosconfiguration><code>nixosConfiguration</code></a></h2><p>æ¬¡ã«linux(nixos)ã®è¨­å®šç®‡æ‰€ã«ã¤ã„ã¦è¦‹ã¦ã„ãã¾ã™ã€‚<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=nix><span class=giallo-l><span style=color:#eceff4>{</span></span>
<span class=giallo-l><span style=color:#616e88>  # ...</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#8fbcbb>  outputs</span><span style=color:#81a1c1> =</span></span>
<span class=giallo-l><span style=color:#eceff4>    {</span><span> nixpkgs</span></span>
<span class=giallo-l><span style=color:#81a1c1>    ,</span><span> darwin</span></span>
<span class=giallo-l><span style=color:#81a1c1>    ,</span><span> home-manager</span></span>
<span class=giallo-l><span style=color:#81a1c1>    , ...</span></span>
<span class=giallo-l><span style=color:#eceff4>    }: {</span></span>
<span class=giallo-l><span style=color:#8fbcbb>      nixosConfigurations</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#8fbcbb>        xps15</span><span style=color:#81a1c1> =</span><span> nixpkgs</span><span style=color:#81a1c1>.</span><span>lib</span><span style=color:#81a1c1>.</span><span>nixosSystem</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#8fbcbb>          system</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> "</span><span style=color:#a3be8c>x86_64-linux</span><span style=color:#eceff4>"</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#8fbcbb>          modules</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> [</span></span>
<span class=giallo-l><span style=color:#a3be8c>            ./hosts/xps15</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span>            home-manager</span><span style=color:#81a1c1>.</span><span>nixosModules</span><span style=color:#81a1c1>.</span><span>home-manager</span></span>
<span class=giallo-l><span style=color:#eceff4>            {</span></span>
<span class=giallo-l><span style=color:#8fbcbb>              home-manager</span><span>.</span><span style=color:#8fbcbb>useGlobalPkgs</span><span style=color:#81a1c1> = true;</span></span>
<span class=giallo-l><span style=color:#8fbcbb>              home-manager</span><span>.</span><span style=color:#8fbcbb>useUserPackages</span><span style=color:#81a1c1> = true;</span></span>
<span class=giallo-l><span style=color:#8fbcbb>              home-manager</span><span>.</span><span style=color:#8fbcbb>users</span><span>.</span><span style=color:#8fbcbb>ymgyt</span><span style=color:#81a1c1> =</span><span style=color:#88c0d0> import</span><span style=color:#a3be8c> ./home/linux</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#eceff4>            }</span></span>
<span class=giallo-l><span style=color:#eceff4>          ]</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#eceff4>        }</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#eceff4>      }</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#eceff4>    }</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#eceff4>}</span></span></code></pre><p><code>xps15</code>ã¨ã„ã†ã®ã¯è¨­å®šå¯¾è±¡ã®hostã®åå‰ã§ä»»æ„ã§ã™ã€‚<code>system</code>ã«ã¯CPUã¨OSã‚’æŒ‡å®šã—ã¾ã™ã€‚(Macã®å ´åˆã¯<code>system = "aarch64-darwin"</code>ç­‰)<br> æ¬¡ã®<code>modules = [ ... ]</code>ã®ã¨ã“ã‚ãŒå…·ä½“çš„ãªè¨­å®šé …ç›®ã§ã™ã€‚<code>home-manager</code>ã¯å¾Œã»ã©è§¦ã‚Œã‚‹ã®ã§ã¾ãšã¯<code>./hosts/xps15</code>ã®ç®‡æ‰€ã‹ã‚‰è¦‹ã¦ã„ãã¾ã™ã€‚<br> è¨­å®šã®DSLã¨ã‚ã£ã¦ã€nix languageã§ã¯file pathå‹ã¯first classã§ã™ã€‚file pathã§directoryã‚’æŒ‡å®šã—ãŸå ´åˆãã®directoryé…ä¸‹ã®<code>default.nix</code>ãŒè©•ä¾¡ã•ã‚Œã¾ã™ã€‚<br> ã¾ãšã“ã“ã§repositoryã®directoryæ§‹é€ ã‚’ç¢ºèªã—ã¾ã™ã€‚<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=plain><span class=giallo-l><span>.</span></span>
<span class=giallo-l><span>â”œâ”€â”€ flake.lock</span></span>
<span class=giallo-l><span>â”œâ”€â”€ flake.nix</span></span>
<span class=giallo-l><span>â”œâ”€â”€ home</span></span>
<span class=giallo-l><span>â”œâ”€â”€ hosts</span></span>
<span class=giallo-l><span>â”‚  â”œâ”€â”€ fraim</span></span>
<span class=giallo-l><span>â”‚  â”‚  â””â”€â”€ default.nix</span></span>
<span class=giallo-l><span>â”‚  â”œâ”€â”€ prox86</span></span>
<span class=giallo-l><span>â”‚  â”‚  â””â”€â”€ default.nix</span></span>
<span class=giallo-l><span>â”‚  â””â”€â”€ xps15</span></span>
<span class=giallo-l><span>â”‚     â”œâ”€â”€ default.nix</span></span>
<span class=giallo-l><span>â”‚     â””â”€â”€ hardware-configuration.nix</span></span>
<span class=giallo-l><span>â”œâ”€â”€ Makefile.toml</span></span>
<span class=giallo-l><span>â”œâ”€â”€ modules</span></span>
<span class=giallo-l><span>â”‚  â”œâ”€â”€ darwin</span></span>
<span class=giallo-l><span>â”‚  â”‚  â””â”€â”€ default.nix</span></span>
<span class=giallo-l><span>â”‚  â”œâ”€â”€ font.nix</span></span>
<span class=giallo-l><span>â”‚  â”œâ”€â”€ nixos</span></span>
<span class=giallo-l><span>â”‚  â”‚  â”œâ”€â”€ default.nix</span></span>
<span class=giallo-l><span>â”‚  â”‚  â””â”€â”€ font.nix</span></span>
<span class=giallo-l><span>â”‚  â””â”€â”€ ssh.nix</span></span>
<span class=giallo-l><span>â”œâ”€â”€ README.md</span></span></code></pre><p><code>home</code>é…ä¸‹ã¯å‰²æ„›ã—ã¦ã„ã¾ã™ã€‚ä»Šå›ã®å‚ç…§å…ˆã¯<code>hosts/xps15</code>ã§ã™ã€‚åŸºæœ¬çš„ã«ã¯hostã”ã¨ã«<code>hosts</code>é…ä¸‹ã«directoryã‚’åˆ‡ã£ã¦ã„ã¾ã™ã€‚<br> ã“ã‚Œã¯nixosConfigurationã®è¦ç´„ç­‰ã§ã¯ãªã„ã§ã™ã€‚<br> hostã”ã¨ã«directoryã‚’åˆ‡ã£ã¦ã„ã‚‹ã®ã¯ã€hostã”ã¨ã®å›ºæœ‰ã®è¨­å®šã¯ã“ã“ã§å¸åã™ã‚‹ã‹ã‚‰ã§ã™ã€‚<br> <code>hosts/xps15/default.nix</code>ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ã€‚<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=nix><span class=giallo-l><span style=color:#eceff4>{</span><span style=color:#81a1c1> ...</span><span style=color:#eceff4> }: {</span></span>
<span class=giallo-l><span style=color:#8fbcbb>  imports</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> [</span></span>
<span class=giallo-l><span style=color:#a3be8c>    ../../modules/nixos</span></span>
<span class=giallo-l><span style=color:#a3be8c>    ./hardware-configuration.nix</span></span>
<span class=giallo-l><span style=color:#eceff4>  ]</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#8fbcbb>  users</span><span>.</span><span style=color:#8fbcbb>users</span><span>.</span><span style=color:#8fbcbb>ymgyt</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#8fbcbb>    isNormalUser</span><span style=color:#81a1c1> = true;</span></span>
<span class=giallo-l><span style=color:#8fbcbb>    description</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> "</span><span style=color:#a3be8c>ymgyt</span><span style=color:#eceff4>"</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#8fbcbb>    extraGroups</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> [ "</span><span style=color:#a3be8c>networkmanager</span><span style=color:#eceff4>" "</span><span style=color:#a3be8c>wheel</span><span style=color:#eceff4>" ]</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#8fbcbb>    openssh</span><span>.</span><span style=color:#8fbcbb>authorizedKeys</span><span>.</span><span style=color:#8fbcbb>keys</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> [</span></span>
<span class=giallo-l><span style=color:#eceff4>      "</span><span style=color:#a3be8c>ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIB8gnwsBvzfnFArlA8+tWWCJ64MjvzwoiTidWEgT3Mbf ymgyt</span><span style=color:#eceff4>"</span></span>
<span class=giallo-l><span style=color:#eceff4>    ]</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#eceff4>  }</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#8fbcbb>  networking</span><span>.</span><span style=color:#8fbcbb>hostName</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> "</span><span style=color:#a3be8c>xps15</span><span style=color:#eceff4>"</span><span style=color:#81a1c1>;</span><span style=color:#616e88> # Define your hostname.</span></span>
<span class=giallo-l><span style=color:#eceff4>}</span></span></code></pre><p>ã¾ãšå…¨ä½“ã¨ã—ã¦ã¯<code>{ ... }: {}</code>ã¨ãªã£ã¦ã„ã‚‹ã®ã§é–¢æ•°ã§ã‚ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚<code>...</code>ã¯ä»»æ„ã®fieldã«ãƒãƒƒãƒã—ã¾ã™ã€‚<br> ã“ã“ã§ã€<code>users.users.ymgyt = { /* ... */ }</code>ã‚’è¿”ã—ã¦ã„ã‚‹ã®ã§ã€ã©ã†ã‚„ã‚‰userã‚’è¨­å®šã—ã¦ã„ãã†ã§ã™ãŒã€å‹ã¨ã—ã¦ã¯ã©ã‚“ãªæƒ…å ±ã‚’è¿”ã›ã°ã‚ˆã„ã®ã§ã—ã‚‡ã†ã‹ã€‚<br> ã“ã®ã‚ãŸã‚Šã¯è‡ªåˆ†ã‚‚ã‚ã‹ã£ã¦ã„ãªã„ã¨ã“ã‚ãªã®ã§ã™ãŒã€<code>nixpkgs.lib.nixosSystem</code>ã®å¼•æ•°ã¯<a href=https://www.reddit.com/r/NixOS/comments/13oat7j/what_does_the_function_nixpkgslibnixossystem_do/ rel=external>ã“ã¡ã‚‰</a>ã§å®šç¾©ã•ã‚Œã¦ã„ã‚‹ã¿ãŸã„ã§ã™ã€‚<br> çµè«–ã¨ã—ã¦ã¯ã€<a href="https://search.nixos.org/options?channel=23.05&from=0&size=50&sort=relevance&type=packages&query=users.users" rel=external>search.nixos.org</a>ã§ã¯ã€packageã ã‘ã§ãªãã€NixOsOptionsã‚‚æ¤œç´¢ã§ãã€ãã“ã«<code>users.users</code>ã‚’ã„ã‚Œã‚‹ã¨è¨­å®šã§ãã‚‹å†…å®¹ãŒç¢ºèªã§ãã¾ã™ã€‚<br> é€†ã«ã„ã†ã¨ã“ã“ã§æ¤œç´¢ã§ãã‚‹é …ç›®ã¯ã™ã¹ã¦è¨­å®šã§ãã‚‹é …ç›®ã§ã™ã€‚<br> <a href=https://nixos.org/manual/nixos/stable/index.html#ch-configuration rel=external>Manual</a>ã«ã¯ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªèª¬æ˜ãŒè¼‰ã£ã¦ã„ã¾ã™ã€‚<br> ä»Šå›ã¯è¨­å®šã—ã¦ã„ã¾ã›ã‚“ãŒã€<a href=https://nixos.org/manual/nixos/stable/index.html#sec-kubernetes rel=external>kubernetesã®è¨­å®š</a>ã‚‚ã‚ã‚Šã€ä»¥ä¸‹ã®ã‚ˆã†ã«è¨­å®šã™ã‚‹ã¨kubernetesã®masterãªã‚Šworkerãªã‚Šã«ãªã‚‹ãã†ã§ã™ã€‚<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=plain><span class=giallo-l><span>services.kubernetes = {</span></span>
<span class=giallo-l><span>  apiserver.enable = true;</span></span>
<span class=giallo-l><span>  controllerManager.enable = true;</span></span>
<span class=giallo-l><span>  scheduler.enable = true;</span></span>
<span class=giallo-l><span>  addonManager.enable = true;</span></span>
<span class=giallo-l><span>  proxy.enable = true;</span></span>
<span class=giallo-l><span>  flannel.enable = true;</span></span>
<span class=giallo-l><span>};</span></span></code></pre><p>ã“ã“ã§ã¯hostå›ºæœ‰ã®è¨­å®šã‚’è¡Œã£ã¦ã„ã‚‹ã®ã§åŸºæœ¬çš„ã«ã¯userã®è¨­å®šã¨hostnameã‚’è¨­å®šã—ã¦ã„ã¾ã™ã€‚<br> ãŸã ã—ã€ã“ã®fileã«ã™ã¹ã¦ã‚’è¨­å®šã™ã‚‹ã¨ã‚‚ã†ä¸€å°ã€nixosã®hostãŒå¢—ãˆãŸéš›ã«é‡è¤‡ã™ã‚‹ç®‡æ‰€ãŒã§ã¦ãã‚‹ã‹ã¨æ€ã„ã¾ã™ã€‚<br> ãªã®ã§hostã«ä¾å­˜ã—ãªã„è¨­å®šã¯åˆ¥é€”ã€<code>modules/nixos</code>ã«å®šç¾©ã—ã¦ã„ã¾ã™ã€‚<br> ã¾ãŸhostå›ºæœ‰ã®hardwareã«é–¢é€£ã™ã‚‹è¨­å®šã¯<code>/hosts/xps15/hardware-configuration.nix</code>ã«å®šç¾©ã—ã¦ã„ã¾ã™ã€‚<code>hardware-configuration.nix</code>ã¯nixosã®installæ™‚ã«è‡ªå‹•ç”Ÿæˆã•ã‚ŒãŸã‚‚ã®ã§ã™ã€‚<br> æ¦‚ã­ä»¥ä¸‹ã®ã‚ˆã†ãªå†…å®¹ã«ãªã£ã¦ã„ã¾ã—ãŸã€‚<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=nix><span class=giallo-l><span style=color:#616e88># Do not modify this file!  It was generated by â€˜nixos-generate-configâ€™</span></span>
<span class=giallo-l><span style=color:#616e88># and may be overwritten by future invocations.  Please make changes</span></span>
<span class=giallo-l><span style=color:#616e88># to /etc/nixos/configuration.nix instead.</span></span>
<span class=giallo-l><span style=color:#eceff4>{</span><span> config</span><span style=color:#81a1c1>,</span><span> lib</span><span style=color:#81a1c1>,</span><span> pkgs</span><span style=color:#81a1c1>,</span><span> modulesPath</span><span style=color:#81a1c1>, ...</span><span style=color:#eceff4> }:</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#eceff4>{</span></span>
<span class=giallo-l><span style=color:#8fbcbb>  imports</span><span style=color:#81a1c1> =</span></span>
<span class=giallo-l><span style=color:#eceff4>    [</span></span>
<span class=giallo-l><span style=color:#eceff4>      (</span><span>modulesPath</span><span style=color:#81a1c1> +</span><span style=color:#eceff4> "</span><span style=color:#a3be8c>/installer/scan/not-detected.nix</span><span style=color:#eceff4>")</span></span>
<span class=giallo-l><span style=color:#eceff4>    ]</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#8fbcbb>  boot</span><span>.</span><span style=color:#8fbcbb>initrd</span><span>.</span><span style=color:#8fbcbb>availableKernelModules</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> [ "</span><span style=color:#a3be8c>xhci_pci</span><span style=color:#eceff4>" "</span><span style=color:#a3be8c>thunderbolt</span><span style=color:#eceff4>" "</span><span style=color:#a3be8c>vmd</span><span style=color:#eceff4>" "</span><span style=color:#a3be8c>nvme</span><span style=color:#eceff4>" "</span><span style=color:#a3be8c>usb_storage</span><span style=color:#eceff4>" "</span><span style=color:#a3be8c>sd_mod</span><span style=color:#eceff4>" "</span><span style=color:#a3be8c>rtsx_pci_sdmmc</span><span style=color:#eceff4>" ]</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#8fbcbb>  boot</span><span>.</span><span style=color:#8fbcbb>initrd</span><span>.</span><span style=color:#8fbcbb>kernelModules</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> [ ]</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#8fbcbb>  boot</span><span>.</span><span style=color:#8fbcbb>kernelModules</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> [ "</span><span style=color:#a3be8c>kvm-intel</span><span style=color:#eceff4>" ]</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#8fbcbb>  boot</span><span>.</span><span style=color:#8fbcbb>extraModulePackages</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> [ ]</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#8fbcbb>  fileSystems</span><span>.</span><span style=color:#eceff4>"</span><span style=color:#a3be8c>/</span><span style=color:#eceff4>"</span><span style=color:#81a1c1> =</span></span>
<span class=giallo-l><span style=color:#eceff4>    {</span></span>
<span class=giallo-l><span style=color:#8fbcbb>      device</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> "</span><span style=color:#a3be8c>/dev/disk/by-uuid/94af5bc6-cdac-489f-8212-fe089c3e155f</span><span style=color:#eceff4>"</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#8fbcbb>      fsType</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> "</span><span style=color:#a3be8c>ext4</span><span style=color:#eceff4>"</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#eceff4>    }</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#8fbcbb>  fileSystems</span><span>.</span><span style=color:#eceff4>"</span><span style=color:#a3be8c>/boot/efi</span><span style=color:#eceff4>"</span><span style=color:#81a1c1> =</span></span>
<span class=giallo-l><span style=color:#eceff4>    {</span></span>
<span class=giallo-l><span style=color:#8fbcbb>      device</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> "</span><span style=color:#a3be8c>/dev/disk/by-uuid/0C11-5D62</span><span style=color:#eceff4>"</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#8fbcbb>      fsType</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> "</span><span style=color:#a3be8c>vfat</span><span style=color:#eceff4>"</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#eceff4>    }</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#8fbcbb>  swapDevices</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> [ ]</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#616e88>  # Enables DHCP on each ethernet and wireless interface. In case of scripted networking</span></span>
<span class=giallo-l><span style=color:#616e88>  # (the default) this is the recommended approach. When using systemd-networkd it's</span></span>
<span class=giallo-l><span style=color:#616e88>  # still possible to use this option, but it's recommended to use it in conjunction</span></span>
<span class=giallo-l><span style=color:#616e88>  # with explicit per-interface declarations with `networking.interfaces.&lt;interface>.useDHCP`.</span></span>
<span class=giallo-l><span style=color:#8fbcbb>  networking</span><span>.</span><span style=color:#8fbcbb>useDHCP</span><span style=color:#81a1c1> =</span><span> lib</span><span style=color:#81a1c1>.</span><span>mkDefault</span><span style=color:#81a1c1> true;</span></span>
<span class=giallo-l><span style=color:#616e88>  # networking.interfaces.wlp0s20f3.useDHCP = lib.mkDefault true;</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#8fbcbb>  nixpkgs</span><span>.</span><span style=color:#8fbcbb>hostPlatform</span><span style=color:#81a1c1> =</span><span> lib</span><span style=color:#81a1c1>.</span><span>mkDefault</span><span style=color:#eceff4> "</span><span style=color:#a3be8c>x86_64-linux</span><span style=color:#eceff4>"</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#8fbcbb>  powerManagement</span><span>.</span><span style=color:#8fbcbb>cpuFreqGovernor</span><span style=color:#81a1c1> =</span><span> lib</span><span style=color:#81a1c1>.</span><span>mkDefault</span><span style=color:#eceff4> "</span><span style=color:#a3be8c>powersave</span><span style=color:#eceff4>"</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#8fbcbb>  hardware</span><span>.</span><span style=color:#8fbcbb>cpu</span><span>.</span><span style=color:#8fbcbb>intel</span><span>.</span><span style=color:#8fbcbb>updateMicrocode</span><span style=color:#81a1c1> =</span><span> lib</span><span style=color:#81a1c1>.</span><span>mkDefault config</span><span style=color:#81a1c1>.</span><span>hardware</span><span style=color:#81a1c1>.</span><span>enableRedistributableFirmware</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#616e88>  # high-resolution display</span></span>
<span class=giallo-l><span style=color:#616e88>  # disable for error</span></span>
<span class=giallo-l><span style=color:#616e88>  # hardware.video.hidpi.enable = lib.mkDefault true;</span></span>
<span class=giallo-l><span style=color:#eceff4>}</span></span></code></pre><p>Nixoså…±é€šã®<code>modules/nixos</code>ã¯é•·ã„ã®ã§ã“ã“ã§ã¯ã€Input methodã¨fontã®è¨­å®šã«ã¤ã„ã¦æ›¸ãã¾ã™ã€‚<h3 id=input-method><a aria-label="Anchor link for: input-method" class=zola-anchor href=#input-method>Input method</a></h3><pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=nix><span class=giallo-l><span style=color:#eceff4>{</span><span> config</span><span style=color:#81a1c1>,</span><span> pkgs</span><span style=color:#81a1c1>, ...</span><span style=color:#eceff4> }: {</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#8fbcbb>  imports</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> [</span></span>
<span class=giallo-l><span style=color:#a3be8c>    ../ssh.nix</span></span>
<span class=giallo-l><span style=color:#a3be8c>    ../font.nix</span></span>
<span class=giallo-l><span style=color:#a3be8c>    ./font.nix</span></span>
<span class=giallo-l><span style=color:#eceff4>  ]</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#616e88>  # https://nixos.org/manual/nixos/unstable/index.html#module-services-input-methods-fcitx</span></span>
<span class=giallo-l><span style=color:#8fbcbb>  i18n</span><span>.</span><span style=color:#8fbcbb>inputMethod</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#8fbcbb>    enabled</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> "</span><span style=color:#a3be8c>fcitx5</span><span style=color:#eceff4>"</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#8fbcbb>    fcitx5</span><span>.</span><span style=color:#8fbcbb>addons</span><span style=color:#81a1c1> = with</span><span> pkgs;</span><span style=color:#eceff4> [</span><span> fcitx5-mozc</span><span style=color:#eceff4> ]</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#eceff4>  }</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#eceff4>}</span></span></code></pre><p>Input methodã«fcitx5 + mozcã‚’åˆ©ç”¨ã™ã‚‹è¨­å®šã¯ã“ã‚Œã ã‘ã§ã™ã€‚<br> ä»–ã«ã©ã‚“ãªè¨­å®šãŒå¯èƒ½ã‹ã¯<a href=https://nixos.org/manual/nixos/stable/index.html#module-services-input-methods-fcitx rel=external>Manual</a>ã«è¨˜è¼‰ã•ã‚Œã¦ã„ã¾ã™ã€‚<br> Linuxåˆå¿ƒè€…ã«éå¸¸ã«ã‚„ã•ã—ã„ã§ã™ã€‚<h3 id=font><a aria-label="Anchor link for: font" class=zola-anchor href=#font>Font</a></h3><p>å€‹äººçš„ã«fontã‚’mac,linuxå…±é€šã§å®£è¨€çš„ã«ç®¡ç†ã§ãã‚‹ã®ã¯ã†ã‚Œã—ã„ã§ã™ã€‚<p>ã¾ãšinstallã™ã‚‹fontã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«å®šç¾©ã—ã¾ã—ãŸã€‚<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=nix><span class=giallo-l><span style=color:#616e88># Configure common options in nixos and darwin</span></span>
<span class=giallo-l><span style=color:#eceff4>{</span><span> pkgs</span><span style=color:#81a1c1>, ...</span><span style=color:#eceff4> }: {</span></span>
<span class=giallo-l><span style=color:#8fbcbb>  fonts</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#8fbcbb>    fontDir</span><span>.</span><span style=color:#8fbcbb>enable</span><span style=color:#81a1c1> = true;</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#8fbcbb>    fonts</span><span style=color:#81a1c1> = with</span><span> pkgs;</span><span style=color:#eceff4> [</span></span>
<span class=giallo-l><span>      noto-fonts</span></span>
<span class=giallo-l><span>      noto-fonts-cjk</span></span>
<span class=giallo-l><span>      noto-fonts-emoji</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#616e88>      # nerdfotns</span></span>
<span class=giallo-l><span style=color:#616e88>      # https://www.nerdfonts.com/font-downloads</span></span>
<span class=giallo-l><span style=color:#616e88>      # items are inferred from the actual downloaded file name</span></span>
<span class=giallo-l><span style=color:#eceff4>      (</span><span>nerdfonts</span><span style=color:#81a1c1>.</span><span>override</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#8fbcbb>        fonts</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> [</span></span>
<span class=giallo-l><span style=color:#eceff4>          "</span><span style=color:#a3be8c>JetBrainsMono</span><span style=color:#eceff4>"</span></span>
<span class=giallo-l><span style=color:#eceff4>        ]</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#eceff4>      })</span></span>
<span class=giallo-l><span style=color:#eceff4>    ]</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#eceff4>  }</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#eceff4>}</span></span></code></pre><p>åˆ©ç”¨ã§ãã‚‹fontã¯åŒæ§˜ã«<a href=https://search.nixos.org/packages rel=external>search.nixos.org</a>ã‹ã‚‰æ¤œç´¢ã§ãã¾ã™ã€‚<br> ã“ã“ã§<code>with</code>ãŒã§ã¦ããŸã®ã§ã€è£œè¶³ã™ã‚‹ã¨<code>with pkgs</code>ã¨ã™ã‚‹ã¨ã€<code>pkgs</code>ã®fieldåã«ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™ã€‚ã—ãŸãŒã£ã¦ä¸Šè¨˜ã¯ä»¥ä¸‹ã¨åŒã˜ã§ã™ã€‚<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=plain><span class=giallo-l><span>fonts = [ </span></span>
<span class=giallo-l><span>  pkgs.noto-fonts</span></span>
<span class=giallo-l><span>  pkgs.fonts-cjk</span></span>
<span class=giallo-l><span>  pkgs.noto-fonts-emoji</span></span>
<span class=giallo-l><span>  # ...</span></span>
<span class=giallo-l><span>];</span></span></code></pre><p>æ¬¡ã«nixosã®å ´åˆã¯default fontã‚’æŒ‡å®šã§ãã‚‹ã®ã§æŒ‡å®šã—ã¦ã„ã¾ã™ã€‚<br> darwin(mac)ã®å ´åˆã¯ã“ã®æŒ‡å®šãŒã§ãã¾ã›ã‚“ã§ã—ãŸã€‚<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=nix><span class=giallo-l><span style=color:#616e88># Configure nixos specific options</span></span>
<span class=giallo-l><span style=color:#eceff4>{</span><span> pkgs</span><span style=color:#81a1c1>, ...</span><span style=color:#eceff4> }: {</span></span>
<span class=giallo-l><span style=color:#8fbcbb>  fonts</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#8fbcbb>    enableDefaultFonts</span><span style=color:#81a1c1> = true;</span></span>
<span class=giallo-l><span style=color:#616e88>    # Make sure font match with alacritty font settings</span></span>
<span class=giallo-l><span style=color:#8fbcbb>    fontconfig</span><span>.</span><span style=color:#8fbcbb>defaultFonts</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#8fbcbb>      serif</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> [ "</span><span style=color:#a3be8c>Noto Serif</span><span style=color:#eceff4>" "</span><span style=color:#a3be8c>Noto Color Emoji</span><span style=color:#eceff4>" ]</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#8fbcbb>      sansSerif</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> [ "</span><span style=color:#a3be8c>Noto Sans CJK JP</span><span style=color:#eceff4>" "</span><span style=color:#a3be8c>Noto Sans</span><span style=color:#eceff4>" "</span><span style=color:#a3be8c>Noto Color Emoji</span><span style=color:#eceff4>" ]</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#8fbcbb>      monospace</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> [ "</span><span style=color:#a3be8c>Noto Sans Mono</span><span style=color:#eceff4>" "</span><span style=color:#a3be8c>Noto Color Emoji</span><span style=color:#eceff4>" ]</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#8fbcbb>      emoji</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> [ "</span><span style=color:#a3be8c>Noto Color Emoji</span><span style=color:#eceff4>" ]</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#eceff4>    }</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#eceff4>  }</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#eceff4>}</span></span></code></pre><p>ã‚³ãƒ¡ãƒ³ãƒˆã«<code># Make sure font match with alacritty font settings</code>ã¨ã‚ã‚Šã¾ã™ã‚ˆã†ã«ã€ã“ã“ã®æŒ‡å®šã¯alacrittyã®fontæŒ‡å®šã¨ä¸€è‡´ã—ã¦ã„ã¦ã»ã—ã„ã§ã™ã€‚<br> ãªã®ã§æœ¬æ¥ãªã‚‰å¼•æ•°ç­‰ã§æ¸¡ã—ãŸã„ã¨ã“ã‚ãªã®ã§ã™ãŒã€ã†ã¾ã„ã“ã¨æ¸¡ã›ã‚‹æ–¹æ³•ã‚’æ¨¡ç´¢ä¸­ã§ã™ã€‚(ãã‚Œã§ãã¦ãªã„ã®è‡´å‘½çš„ã˜ã‚ƒã‚“ã¨è¨€ã‚ã‚Œã‚‹ã¨ãã®é€šã‚Šã§ã™ã€‚)<p>ã–ã£ãã‚Šä¸Šè¨˜ã®ã‚ˆã†ãªè¦é ˜ã§ã€hostå›ºæœ‰ã®è¨­å®š + oså…±é€šã®è¨­å®šã‚’ã†ã¾ãdirectoryæ§‹é€ ã§è¡¨ç¾ã—ã¦é©ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚<br> æ¬¡ã«terminalã‚„shell, å„ç¨®ã‚³ãƒãƒ³ãƒ‰ã®installè¨­å®šã«ã¤ã„ã¦ã¿ã¦ã„ãã¾ã™ã€‚<h3 id=home-manager><a aria-label="Anchor link for: home-manager" class=zola-anchor href=#home-manager>home-manager</a></h3><p>å†ã³ã€<code>flake.nix</code>ã®è©²å½“éƒ¨åˆ†ã§ã™ã€‚ <code>.hosts/xps15</code>ã‚’ã¿ã¦ããŸã®ã§ã€æ¬¡ã¯home-managerã®ç®‡æ‰€ã‚’è¦‹ã¦ã„ãã¾ã™ã€‚<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=nix><span class=giallo-l><span>  nixosConfigurations</span><span style=background-color:#bf616a> =</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#8fbcbb>    xps15</span><span style=color:#81a1c1> =</span><span> nixpkgs</span><span style=color:#81a1c1>.</span><span>lib</span><span style=color:#81a1c1>.</span><span>nixosSystem</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#8fbcbb>      system</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> "</span><span style=color:#a3be8c>x86_64-linux</span><span style=color:#eceff4>"</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#8fbcbb>      modules</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> [</span></span>
<span class=giallo-l><span style=color:#a3be8c>        ./hosts/xps15</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span>        home-manager</span><span style=color:#81a1c1>.</span><span>nixosModules</span><span style=color:#81a1c1>.</span><span>home-manager</span></span>
<span class=giallo-l><span style=color:#eceff4>        {</span></span>
<span class=giallo-l><span style=color:#8fbcbb>          home-manager</span><span>.</span><span style=color:#8fbcbb>useGlobalPkgs</span><span style=color:#81a1c1> = true;</span></span>
<span class=giallo-l><span style=color:#8fbcbb>          home-manager</span><span>.</span><span style=color:#8fbcbb>useUserPackages</span><span style=color:#81a1c1> = true;</span></span>
<span class=giallo-l><span style=color:#8fbcbb>          home-manager</span><span>.</span><span style=color:#8fbcbb>users</span><span>.</span><span style=color:#8fbcbb>ymgyt</span><span style=color:#81a1c1> =</span><span style=color:#88c0d0> import</span><span style=color:#a3be8c> ./home/linux</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#eceff4>        }</span></span>
<span class=giallo-l><span style=color:#eceff4>      ]</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#eceff4>    }</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#eceff4>  }</span><span style=background-color:#bf616a>;</span></span></code></pre><p>home-managerã¯å€‹åˆ¥ã®userã”ã¨ã®homeé…ä¸‹ã‚’è¨­å®šã™ã‚‹moduleã§ã™ã€‚<br> é‡è¦ãªã®ã¯<code>home-manager.users.ymgyt = import ./home/linux;</code> ã®ç®‡æ‰€ã§ã“ã®å‡¦ç†ã§ã€<code>ymgyt</code> user(ã•ãã»ã©å®£è¨€ã—ãŸuser)ã®homeé…ä¸‹ã®è¨­å®šã‚’è¡Œã£ã¦ã„ã¾ã™ã€‚<br> home-managerã§ã¯ã©ã‚“ãªé …ç›®ãŒè¨­å®šã§ãã‚‹ã‹ã¯<a href=https://nix-community.github.io/home-manager/options.html rel=external>options</a>ã«è¨˜è¼‰ã•ã‚Œã¦ã„ã¾ã™ã€‚<br> ã¾ãšimportå…ˆã®<code>/home/linux/default.nix</code>ã§ã™ãŒ<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=nix><span class=giallo-l><span style=color:#eceff4>{</span><span> pkgs</span></span>
<span class=giallo-l><span style=color:#81a1c1>, ...</span></span>
<span class=giallo-l><span style=color:#eceff4>}: {</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#8fbcbb>  imports</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> [</span></span>
<span class=giallo-l><span style=color:#a3be8c>    ../base</span></span>
<span class=giallo-l><span style=color:#eceff4>  ]</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#8fbcbb>  home</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#8fbcbb>    username</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> "</span><span style=color:#a3be8c>ymgyt</span><span style=color:#eceff4>"</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#8fbcbb>    homeDirectory</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> "</span><span style=color:#a3be8c>/home/ymgyt</span><span style=color:#eceff4>"</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#8fbcbb>    stateVersion</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> "</span><span style=color:#a3be8c>23.05</span><span style=color:#eceff4>"</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#eceff4>  }</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#8fbcbb>  programs</span><span>.</span><span style=color:#8fbcbb>home-manager</span><span>.</span><span style=color:#8fbcbb>enable</span><span style=color:#81a1c1> = true;</span></span>
<span class=giallo-l><span style=color:#eceff4>}</span></span></code></pre><p>ã¨ãªã£ã¦ãŠã‚Šã€userã®home directoryã‚’ä½œæˆã—ãŸã‚Šã—ã¦ã„ã¾ã™ã€‚<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=plain><span class=giallo-l><span>.</span></span>
<span class=giallo-l><span>â”œâ”€â”€ flake.lock</span></span>
<span class=giallo-l><span>â”œâ”€â”€ flake.nix</span></span>
<span class=giallo-l><span>â”œâ”€â”€ home</span></span>
<span class=giallo-l><span>â”‚  â”œâ”€â”€ base</span></span>
<span class=giallo-l><span>â”‚  â”‚  â”œâ”€â”€ default.nix</span></span>
<span class=giallo-l><span>â”‚  â”‚  â”œâ”€â”€ editor</span></span>
<span class=giallo-l><span>â”‚  â”‚  â”‚  â”œâ”€â”€ default.nix</span></span>
<span class=giallo-l><span>â”‚  â”‚  â”‚  â””â”€â”€ helix</span></span>
<span class=giallo-l><span>â”‚  â”‚  â”‚     â””â”€â”€ default.nix</span></span>
<span class=giallo-l><span>â”‚  â”‚  â”œâ”€â”€ programs</span></span>
<span class=giallo-l><span>â”‚  â”‚  â”‚  â”œâ”€â”€ cloud</span></span>
<span class=giallo-l><span>â”‚  â”‚  â”‚  â”‚  â”œâ”€â”€ aws.nix</span></span>
<span class=giallo-l><span>â”‚  â”‚  â”‚  â”‚  â””â”€â”€ default.nix</span></span>
<span class=giallo-l><span>â”‚  â”‚  â”‚  â”œâ”€â”€ default.nix</span></span>
<span class=giallo-l><span>â”‚  â”‚  â”‚  â”œâ”€â”€ filesystem.nix</span></span>
<span class=giallo-l><span>â”‚  â”‚  â”‚  â”œâ”€â”€ git.nix</span></span>
<span class=giallo-l><span>â”‚  â”‚  â”‚  â”œâ”€â”€ kubernetes.nix</span></span>
<span class=giallo-l><span>â”‚  â”‚  â”‚  â””â”€â”€ languages</span></span>
<span class=giallo-l><span>â”‚  â”‚  â”‚     â”œâ”€â”€ default.nix</span></span>
<span class=giallo-l><span>â”‚  â”‚  â”‚     â”œâ”€â”€ go.nix</span></span>
<span class=giallo-l><span>â”‚  â”‚  â”‚     â”œâ”€â”€ nix.nix</span></span>
<span class=giallo-l><span>â”‚  â”‚  â”‚     â””â”€â”€ rust.nix</span></span>
<span class=giallo-l><span>â”‚  â”‚  â”œâ”€â”€ shell</span></span>
<span class=giallo-l><span>â”‚  â”‚  â”‚  â”œâ”€â”€ default.nix</span></span>
<span class=giallo-l><span>â”‚  â”‚  â”‚  â”œâ”€â”€ nushell</span></span>
<span class=giallo-l><span>â”‚  â”‚  â”‚  â”‚  â”œâ”€â”€ config.nu</span></span>
<span class=giallo-l><span>â”‚  â”‚  â”‚  â”‚  â”œâ”€â”€ default.nix</span></span>
<span class=giallo-l><span>â”‚  â”‚  â”‚  â”‚  â”œâ”€â”€ env.nu</span></span>
<span class=giallo-l><span>â”‚  â”‚  â”‚  â”‚  â””â”€â”€ starship.toml</span></span>
<span class=giallo-l><span>â”‚  â”‚  â”‚  â””â”€â”€ zsh</span></span>
<span class=giallo-l><span>â”‚  â”‚  â”‚     â””â”€â”€ default.nix</span></span>
<span class=giallo-l><span>â”‚  â”‚  â””â”€â”€ terminal</span></span>
<span class=giallo-l><span>â”‚  â”‚     â”œâ”€â”€ alacritty</span></span>
<span class=giallo-l><span>â”‚  â”‚     â”‚  â”œâ”€â”€ alacritty.yml</span></span>
<span class=giallo-l><span>â”‚  â”‚     â”‚  â””â”€â”€ default.nix</span></span>
<span class=giallo-l><span>â”‚  â”‚     â”œâ”€â”€ default.nix</span></span>
<span class=giallo-l><span>â”‚  â”‚     â””â”€â”€ zellij</span></span>
<span class=giallo-l><span>â”‚  â”‚        â”œâ”€â”€ config.kdl</span></span>
<span class=giallo-l><span>â”‚  â”‚        â””â”€â”€ default.nix</span></span>
<span class=giallo-l><span>â”‚  â”œâ”€â”€ darwin</span></span>
<span class=giallo-l><span>â”‚  â”‚  â””â”€â”€ default.nix</span></span>
<span class=giallo-l><span>â”‚  â””â”€â”€ linux</span></span>
<span class=giallo-l><span>â”‚     â””â”€â”€ default.nix</span></span>
<span class=giallo-l><span>â”œâ”€â”€ hosts</span></span>
<span class=giallo-l><span>â”œâ”€â”€ Makefile.toml</span></span>
<span class=giallo-l><span>â”œâ”€â”€ modules</span></span></code></pre><p>åŸºæœ¬çš„ã«ã¯linux, macã§å…±é€šã®è¨­å®šã‚’é©ç”¨ã—ã¦ã„ã¾ã™ã€‚<br> ã“ã‚Œã‚’å…¨éƒ¨ã¿ã¦ã„ãã¨é•·ããªã£ã¦ã—ã¾ã†ã®ã§è¦ç‚¹ã ã‘è¨˜è¼‰ã—ã¾ã™ã€‚<p>ã¾ãšpackageã®installã§ã™ãŒä»¥ä¸‹ã®ã‚ˆã†ã«æ›¸ãã¨packageãŒinstallã•ã‚ŒãŸç’°å¢ƒãŒã§ãã‚ãŒã‚Šã¾ã™ã€‚<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=nix><span class=giallo-l><span style=color:#eceff4>{</span><span> pkgs</span><span style=color:#81a1c1>, ...</span><span style=color:#eceff4> }: {</span></span>
<span class=giallo-l><span style=color:#8fbcbb>  home</span><span>.</span><span style=color:#8fbcbb>packages</span><span style=color:#81a1c1> = with</span><span> pkgs;</span><span style=color:#eceff4> [</span></span>
<span class=giallo-l><span>    rustup</span></span>
<span class=giallo-l><span>    cargo-criterion</span></span>
<span class=giallo-l><span>    cargo-deps</span></span>
<span class=giallo-l><span>    cargo-expand</span></span>
<span class=giallo-l><span>    cargo-insta</span></span>
<span class=giallo-l><span>    cargo-make</span></span>
<span class=giallo-l><span>    cargo-nextest</span></span>
<span class=giallo-l><span>    cargo-udeps</span></span>
<span class=giallo-l><span>    cargo-sort</span></span>
<span class=giallo-l><span>    cargo-vet</span></span>
<span class=giallo-l><span style=color:#eceff4>  ]</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#eceff4>}</span></span></code></pre><p>ã¾ãŸã€packageã§ã¯ãªãã€home-managerã§å€‹åˆ¥ã®è¨­å®šãŒã‚ã‚‹ã‚‚ã®ãŒã‚ã‚Šã¾ã™ã€‚ä¾‹ãˆã°nushellã«ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªoptionãŒã‚ã‚Šã¾ã™ã€‚<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=nix><span class=giallo-l><span style=color:#eceff4>{</span><span style=color:#81a1c1> ...</span><span style=color:#eceff4> }: {</span></span>
<span class=giallo-l><span style=color:#8fbcbb>  programs</span><span>.</span><span style=color:#8fbcbb>nushell</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#8fbcbb>    enable</span><span style=color:#81a1c1> = true;</span></span>
<span class=giallo-l><span style=color:#8fbcbb>    configFile</span><span>.</span><span style=color:#8fbcbb>source</span><span style=color:#81a1c1> =</span><span style=color:#a3be8c> ./config.nu</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#8fbcbb>    envFile</span><span>.</span><span style=color:#8fbcbb>source</span><span style=color:#81a1c1> =</span><span style=color:#a3be8c> ./env.nu</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#eceff4>  }</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#8fbcbb>  programs</span><span>.</span><span style=color:#8fbcbb>starship</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#8fbcbb>    enable</span><span style=color:#81a1c1> = true;</span></span>
<span class=giallo-l><span style=color:#8fbcbb>    enableNushellIntegration</span><span style=color:#81a1c1> = true;</span></span>
<span class=giallo-l><span style=color:#eceff4>  }</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#616e88>  # generate by `starship preset nerd-font-symbols -o ./starship.toml`</span></span>
<span class=giallo-l><span style=color:#8fbcbb>  xdg</span><span>.</span><span style=color:#8fbcbb>configFile</span><span>.</span><span style=color:#eceff4>"</span><span style=color:#a3be8c>starship.toml</span><span style=color:#eceff4>"</span><span>.</span><span style=color:#8fbcbb>source</span><span style=color:#81a1c1> =</span><span style=color:#a3be8c> ./starship.toml</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#eceff4>}</span></span></code></pre><p><code>programs.starship.enableNushellIntegration = true</code>ã‚’æŒ‡å®šã™ã‚‹ã¨ã€nushellã®èµ·å‹•æ™‚ã«èª­ã¿è¾¼ã¾ã‚Œã‚‹<code>env.nu</code>ã«<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=plain><span class=giallo-l><span>let starship_cache = "/home/ymgyt/.cache/starship"</span></span>
<span class=giallo-l><span>if not ($starship_cache | path exists) {</span></span>
<span class=giallo-l><span>  mkdir $starship_cache</span></span>
<span class=giallo-l><span>}</span></span>
<span class=giallo-l><span>/etc/profiles/per-user/ymgyt/bin/starship init nu | save --force /home/ymgyt/.cache/starship/init.nu</span></span></code></pre><p>ã®ã‚ˆã†ãªstarshipç”¨ã®åˆæœŸåŒ–å‡¦ç†ãŒæŒ¿å…¥ã•ã‚ŒãŸçŠ¶æ…‹ã§fileãŒç”Ÿæˆã•ã‚Œã¾ã™ã€‚<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=nix><span class=giallo-l><span style=color:#eceff4>{</span><span> pkgs</span></span>
<span class=giallo-l><span style=color:#81a1c1>, ...</span></span>
<span class=giallo-l><span style=color:#eceff4>}: {</span></span>
<span class=giallo-l><span style=color:#8fbcbb>  programs</span><span>.</span><span style=color:#8fbcbb>git</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#8fbcbb>    enable</span><span style=color:#81a1c1> = true;</span></span>
<span class=giallo-l><span style=color:#8fbcbb>    userName</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> "</span><span style=color:#a3be8c>ymgyt</span><span style=color:#eceff4>"</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#8fbcbb>    includes</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> [</span></span>
<span class=giallo-l><span style=color:#eceff4>      {</span><span style=color:#8fbcbb> path</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> "</span><span style=color:#a3be8c>~/.gitlocalconfig</span><span style=color:#eceff4>"</span><span style=color:#81a1c1>;</span><span style=color:#eceff4> }</span></span>
<span class=giallo-l><span style=color:#eceff4>    ]</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#8fbcbb>    aliases</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#8fbcbb>      a</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> "</span><span style=color:#a3be8c>add</span><span style=color:#eceff4>"</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#8fbcbb>      b</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> "</span><span style=color:#a3be8c>branch -vv</span><span style=color:#eceff4>"</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#8fbcbb>      d</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> "</span><span style=color:#a3be8c>diff</span><span style=color:#eceff4>"</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#8fbcbb>      s</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> "</span><span style=color:#a3be8c>status</span><span style=color:#eceff4>"</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#8fbcbb>      l</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> "</span><span style=color:#a3be8c>log</span><span style=color:#eceff4>"</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#8fbcbb>      co</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> "</span><span style=color:#a3be8c>checkout</span><span style=color:#eceff4>"</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#8fbcbb>      cm</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> "</span><span style=color:#a3be8c>commit</span><span style=color:#eceff4>"</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#eceff4>    }</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#eceff4>  }</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#8fbcbb>  home</span><span>.</span><span style=color:#8fbcbb>packages</span><span style=color:#81a1c1> = with</span><span> pkgs;</span><span style=color:#eceff4> [</span></span>
<span class=giallo-l><span>    git-trim</span></span>
<span class=giallo-l><span style=color:#eceff4>  ]</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#eceff4>}</span></span></code></pre><p>gitã®configã‚‚å®šç¾©ã§ãã‚‹ã®ã§ã€æœ€åˆã«pushã—ã‚ˆã†ã¨ã—ãŸã‚‰ã€nameã¨emailã‚’è¨­å®šã—ã¦ã­ã¨ã„ã†ã‚ˆã†ãªwarningãŒã§ãªãã¦æ¸ˆã¿ã¾ã™ã€‚<br> home-managerã®optionçµŒç”±ã§è¨­å®šã™ã‚‹ã‹ã€è¨­å®šfileã‚’ãã®ã¾ã¾ç®¡ç†ã™ã‚‹ã‹ã¯é¸ã¹ã¾ã™ã€‚<br> nixä¸Šã§å¤‰æ•°ã‚’æ“ä½œã—ãŸã‚Šã™ã‚‹å ´åˆã«ã¯home-managerçµŒç”±ã§ã®è¨­å®šãŒè‰¯ã„ã®ã‹ã‚‚ã¨æ€ã£ã¦ã„ãŸã‚Šã—ã¾ã™ã€‚<h2 id=shi-yong><a aria-label="Anchor link for: shi-yong" class=zola-anchor href=#shi-yong>é©ç”¨</a></h2><p>ã“ã‚Œã¾ã§è¨­å®šã®æ¦‚è¦ã‚’ã¿ã¦ãã¾ã—ãŸã®ã§ã€æ¬¡ã«ã“ã®è¨­å®šã‚’é©ç”¨ã—ã¾ã™ã€‚<br> taskã¯ä»¥ä¸‹ã®ã‚ˆã†ã«å®šç¾©ã—ã¦ã„ã¾ã™ã€‚<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=toml><span class=giallo-l><span style=color:#eceff4>[</span><span>env</span><span style=color:#eceff4>]</span></span>
<span class=giallo-l><span>HOST</span><span style=color:#eceff4> = {</span><span> script</span><span style=color:#eceff4> = ["</span><span style=color:#a3be8c>hostname</span><span style=color:#eceff4>"] }</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#eceff4>[</span><span>tasks.apply</span><span style=color:#eceff4>]</span></span>
<span class=giallo-l><span>linux_alias</span><span style=color:#eceff4> = "</span><span style=color:#a3be8c>nixos:apply</span><span style=color:#eceff4>"</span></span>
<span class=giallo-l><span>mac_alias</span><span style=color:#eceff4> = "</span><span style=color:#a3be8c>darwin:apply</span><span style=color:#eceff4>"</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#eceff4>[</span><span>tasks."xps15:apply"</span><span style=color:#eceff4>]</span></span>
<span class=giallo-l><span>description</span><span style=color:#eceff4> = "</span><span style=color:#a3be8c>Run nixos-rebuild switch</span><span style=color:#eceff4>"</span></span>
<span class=giallo-l><span>extend</span><span style=color:#eceff4> = "</span><span style=color:#a3be8c>nixos:apply</span><span style=color:#eceff4>"</span></span>
<span class=giallo-l><span>env</span><span style=color:#eceff4> = {</span><span> HOST</span><span style=color:#eceff4> = "</span><span style=color:#a3be8c>xps15</span><span style=color:#eceff4>" }</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#eceff4>[</span><span>tasks."nixos:apply"</span><span style=color:#eceff4>]</span></span>
<span class=giallo-l><span>script</span><span style=color:#eceff4> = '''</span></span>
<span class=giallo-l><span style=color:#a3be8c>sudo nixos-rebuild switch --flake ".#${HOST}" --show-trace</span></span>
<span class=giallo-l><span style=color:#eceff4>'''</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#eceff4>[</span><span>tasks."prox86:apply"</span><span style=color:#eceff4>]</span></span>
<span class=giallo-l><span>extend</span><span style=color:#eceff4> = "</span><span style=color:#a3be8c>darwin:apply</span><span style=color:#eceff4>"</span></span>
<span class=giallo-l><span>env</span><span style=color:#eceff4> = {</span><span> HOST</span><span style=color:#eceff4> = "</span><span style=color:#a3be8c>prox86</span><span style=color:#eceff4>" }</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#eceff4>[</span><span>tasks."fraim:apply"</span><span style=color:#eceff4>]</span></span>
<span class=giallo-l><span>extend</span><span style=color:#eceff4> = "</span><span style=color:#a3be8c>darwin:apply</span><span style=color:#eceff4>"</span></span>
<span class=giallo-l><span>env</span><span style=color:#eceff4> = {</span><span> HOST</span><span style=color:#eceff4> = "</span><span style=color:#a3be8c>fraim</span><span style=color:#eceff4>" }</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#eceff4>[</span><span>tasks."darwin:apply"</span><span style=color:#eceff4>]</span></span>
<span class=giallo-l><span>script</span><span style=color:#eceff4> = '''</span></span>
<span class=giallo-l><span style=color:#a3be8c>nix build .#darwinConfigurations.${HOST}.system --extra-experimental-features 'nix-command flakes' --debug</span></span>
<span class=giallo-l><span style=color:#a3be8c>sudo ./result/sw/bin/darwin-rebuild switch --flake ".#${HOST}"</span></span>
<span class=giallo-l><span style=color:#eceff4>'''</span></span></code></pre><p>task runnerã«ã¯cargo-maker(makers)ã‚’åˆ©ç”¨ã—ã¦ã„ã¾ã™ã€‚<br> æœ€çµ‚çš„ã«å®Ÿè¡Œã™ã‚‹commandã¯<code>sudo nixos-rebuild switch --flake .#xps15</code> ã¨ãªã‚Šã¾ã™ã€‚ã“ã®<code>--flake</code>ã®æŒ‡å®šã§ã™ãŒã€projectã®current directoryã«<code>flake.nix</code>ãŒã‚ã‚‹æƒ³å®šãªã®ã§ã€<code>.</code>ã‚’<code>#</code>ä»¥é™ã¯outputã‚’æŒ‡å®šã—ã¾ã™ã€‚<br> <code>nixos-rebuild switch</code>ã¯outputã®nixosConfigurationsã‚’å¯¾è±¡ã«ã™ã‚‹ã®ãŒå‰æã¨ãªã‚‹ã®ã§çµæœçš„ã«hoståã‚’æ¸¡ã—ã¾ã™ã€‚<br> ã“ã‚Œã‚’é©ç”¨ã™ã‚‹ã¨generationãªã‚‹ã‚‚ã®ãŒä½œæˆã•ã‚Œã¾ã™ã€‚ã“ã‚Œã¯PCèµ·å‹•æ™‚ã®BIOSã‹ã‚‰ã‚‚é¸æŠå¯èƒ½ãªã®ã§ã€è¨­å®šã®åˆ‡ã‚Šæˆ»ã—ç­‰ãŒè¡Œãªãˆã¾ã™ã€‚<p>è¨­å®šç®¡ç†ã—ã¦ã„ã‚‹ã®ã«ã€<code>cargo-make(makers)</code>ã«ä¾å­˜ã—ã¦ã„ã„ã®ã‹ã¨æ€ã‚ã‚Œã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒåˆå›ã ã‘ä»¥ä¸‹ã®ã‚ˆã†ã«ã™ã‚‹ã¨nixãŒgitã‚„cargo-makeã‚’ä½¿ãˆã‚‹ç’°å¢ƒã‚’ç”¨æ„ã—ã¦ãã‚Œã¾ã™ã€‚<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=plain><span class=giallo-l><span>nix run nixpkgs#git -- clone https://github.com/ymgyt/mynix.git</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span>nix shell nixpkgs#cargo-make -c makers `apply`</span></span></code></pre><h2 id=mac-darwin><a aria-label="Anchor link for: mac-darwin" class=zola-anchor href=#mac-darwin>Mac(darwin)</a></h2><p>ä»Šã¾ã§ã¯nixosã®è¨­å®šã‚’ã¿ã¦ãã¾ã—ãŸãŒã€darwinã‚‚åŸºæœ¬çš„ã«ã¯åŒã˜ã§ã™ã€‚é•ã†ã®ã¯nixosConfigurationã§ã¯ãªãã€<a href=https://daiderd.com/nix-darwin/manual/index.html rel=external>nix-darwin</a>ã®manualã‚’å‚ç…§ã™ã‚‹ç‚¹ã§ã™ã€‚<br> ã•ãã»ã©ã¾ã§çœç•¥ã—ã¦ã„ãŸdarwiné–¢é€£ã®<code>flake.nix</code>ã§ã™ã€‚<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=nix><span class=giallo-l><span style=color:#eceff4>{</span></span>
<span class=giallo-l><span style=color:#616e88>  # ...</span></span>
<span class=giallo-l><span style=color:#8fbcbb>  outputs</span><span style=color:#81a1c1> =</span></span>
<span class=giallo-l><span style=color:#eceff4>    {</span><span> nixpkgs</span></span>
<span class=giallo-l><span style=color:#81a1c1>    ,</span><span> darwin</span></span>
<span class=giallo-l><span style=color:#81a1c1>    ,</span><span> home-manager</span></span>
<span class=giallo-l><span style=color:#81a1c1>    , ...</span></span>
<span class=giallo-l><span style=color:#eceff4>    }: {</span></span>
<span class=giallo-l><span style=color:#8fbcbb>      darwinConfigurations</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#8fbcbb>        prox86</span><span style=color:#81a1c1> =</span><span> darwin</span><span style=color:#81a1c1>.</span><span>lib</span><span style=color:#81a1c1>.</span><span>darwinSystem</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#8fbcbb>          system</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> "</span><span style=color:#a3be8c>x86_64-darwin</span><span style=color:#eceff4>"</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#8fbcbb>          modules</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> [</span></span>
<span class=giallo-l><span style=color:#a3be8c>            ./hosts/prox86</span></span>
<span class=giallo-l><span>            home-manager</span><span style=color:#81a1c1>.</span><span>darwinModules</span><span style=color:#81a1c1>.</span><span>home-manager</span></span>
<span class=giallo-l><span style=color:#eceff4>            {</span></span>
<span class=giallo-l><span style=color:#8fbcbb>              home-manager</span><span>.</span><span style=color:#8fbcbb>useGlobalPkgs</span><span style=color:#81a1c1> = true;</span></span>
<span class=giallo-l><span style=color:#8fbcbb>              home-manager</span><span>.</span><span style=color:#8fbcbb>useUserPackages</span><span style=color:#81a1c1> = true;</span></span>
<span class=giallo-l><span style=color:#8fbcbb>              home-manager</span><span>.</span><span style=color:#8fbcbb>users</span><span>.</span><span style=color:#8fbcbb>me</span><span style=color:#81a1c1> =</span><span style=color:#88c0d0> import</span><span style=color:#a3be8c> ./home/darwin</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#eceff4>            }</span></span>
<span class=giallo-l><span style=color:#eceff4>          ]</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#eceff4>        }</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#8fbcbb>        fraim</span><span style=color:#81a1c1> =</span><span> darwin</span><span style=color:#81a1c1>.</span><span>lib</span><span style=color:#81a1c1>.</span><span>darwinSystem</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#8fbcbb>          system</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> "</span><span style=color:#a3be8c>aarch64-darwin</span><span style=color:#eceff4>"</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#8fbcbb>          modules</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> [</span></span>
<span class=giallo-l><span style=color:#a3be8c>            ./hosts/fraim</span></span>
<span class=giallo-l><span>            home-manager</span><span style=color:#81a1c1>.</span><span>darwinModules</span><span style=color:#81a1c1>.</span><span>home-manager</span></span>
<span class=giallo-l><span style=color:#eceff4>            {</span></span>
<span class=giallo-l><span style=color:#8fbcbb>              home-manager</span><span>.</span><span style=color:#8fbcbb>useGlobalPkgs</span><span style=color:#81a1c1> = true;</span></span>
<span class=giallo-l><span style=color:#8fbcbb>              home-manager</span><span>.</span><span style=color:#8fbcbb>useUserPackages</span><span style=color:#81a1c1> = true;</span></span>
<span class=giallo-l><span style=color:#8fbcbb>              home-manager</span><span>.</span><span style=color:#8fbcbb>users</span><span>.</span><span style=color:#8fbcbb>ymgyt</span><span style=color:#81a1c1> =</span><span style=color:#88c0d0> import</span><span style=color:#a3be8c> ./home/darwin</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#eceff4>            }</span></span>
<span class=giallo-l><span style=color:#eceff4>          ]</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#eceff4>        }</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#eceff4>      }</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#eceff4>    }</span><span style=color:#81a1c1>;</span></span>
<span class=giallo-l><span style=color:#eceff4>}</span></span></code></pre><p>ç¾çŠ¶ã¯ã€intel(<code>x86_64-darwin</code>)ã¨m1(<code>aarch64-darwin</code>)ã®hostã‚’ç®¡ç†ã—ã¦ã„ã‚‹ã®ã§è¨­å®šãŒ2ã¤ã‚ã‚Šã¾ã™ã€‚<br> ãŸã æ§‹æˆã®ç²’åº¦ã¯nixosã¨ã‹ã‚ã‚‰ãªã„ã¨æ€ã„ã¾ã™ã€‚macã§ã‚‚fontè¨­å®šã‚„packageã®installãŒã¾ã£ãŸãåŒã˜è¨­å®šã§è¡Œãˆã¦ã„ã¾ã™ã€‚<br> ã¾ãŸã€nix-darwinã‚’åˆ©ç”¨ã›ãšã«macã§ã¯home-managerã®ã¿ã§home directoryé…ä¸‹ã®ç®¡ç†ã«ç•™ã‚ã‚‹ã¨ã„ã†é¸æŠè‚¢ã‚‚ã‚ã‚Šã‹ã¨æ€ã„ã¾ã™ã€‚<h2 id=ke-ti><a aria-label="Anchor link for: ke-ti" class=zola-anchor href=#ke-ti>èª²é¡Œ</a></h2><p>ã¾ã å¯¾å¿œã§ãã¦ã„ãªã„ç®‡æ‰€ã¨ã—ã¦ã¯ä»¥ä¸‹ã®ç‚¹ã‚’èªè­˜ã—ã¦ã„ã¾ã™ã€‚<ul><li>Secretç®¡ç† <ul><li>å®Ÿéš›å•é¡Œã¨ã—ã¦ãªã‚“ã ã‹ã‚“ã localã«secretã¯ã‚ã‚‹ã®ã§ã“ã‚Œã‚’ã©ã†ã™ã‚‹ã‹(Yubikeyã§ãªãã›ã‚‹..?)<li><a href=https://nixos.wiki/wiki/Agenix rel=external>Agenix</a>ã¨ã„ã†æ©Ÿæ§‹ãŒã‚ã‚‹ã‚‰ã—ã„<li>å€‹äººçš„ã«ã¯vaultã¨ã†ã¾ãé€£æºã—ãŸã„ãŒå¤–éƒ¨APIã§ã¦ããŸã‚‰ã‚‚ã†pureã§ã¯ãªããªã£ã¦ã—ã¾ã†æ°—ã‚‚ã™ã‚‹</ul><li>Overlay <ul><li>Overlayã‚„overrideã¨ã„ã£ãŸä»•çµ„ã¿ã®ä½¿ã„æ‰€ãŒã‚ã‹ã£ã¦ã„ãªã„</ul><li>ãã‚‚ãã‚‚ã®Nixã®ä»•çµ„ã¿ <ul><li>Derivationsã‚„stdenvç­‰ã‚ã‹ã£ã¦ã„ãªã„<li><a href=https://nixos.org/guides/nix-pills/pr01.html rel=external>Nix Pills</a>ã‚„ã£ã¦ã¿ã‚ˆã†ã¨ã¯æ€ã£ã¦ã„ã‚‹</ul></ul><h2 id=can-kao><a aria-label="Anchor link for: can-kao" class=zola-anchor href=#can-kao>å‚è€ƒ</a></h2><p>ä»¥ä¸‹ã«è‡ªåˆ†ãŒå‚è€ƒã«ã•ã›ã¦ã„ãŸã ã„ãŸdocã‚„blogã‚’è¼‰ã›ã¦ãŠãã¾ã™ã€‚<br> å…¬å¼ã¯ã‚‚ã¡ã‚ã‚“ãªã®ã§è¼‰ã›ã¦ã„ãªã„ã§ã™ã€‚<table><thead><tr><th>Link<th>Description<tbody><tr><td><a href=https://zero-to-nix.com/ rel=external>Zero to Nix</a><td>nix-installerã‚’æä¾›ã—ã¦ã„ã‚‹Determinate SystemsãŒæä¾›ã—ã¦ã„ã‚‹tutorial<br>ã¨ã‚Šã‚ãˆãšè§¦ã£ã¦ã¿ã‚‹ã“ã¨ãŒã§ãã‚‹<br>å„ç¨®conseptã®è§£èª¬ã‚‚ã‚ã‚ŠãŒãŸã„<tr><td><a href=https://thiscute.world/en/posts/nixos-and-flake-basics/ rel=external>NixOS & Nix Flakes - A Guide for Beginners</a><td>ä¸€ç•ªã‚ªã‚¹ã‚¹ãƒ¡ã§ãã‚‹blogè¨˜äº‹ã€‚<br>ã“ã®è¨˜äº‹ã®ãŠã‹ã’ã§nixã‚’å§‹ã‚ã‚‹ã“ã¨ãŒã§ããŸ<tr><td><a href=https://serokell.io/blog/practical-nix-flakes rel=external>Practical Nix Flakes</a><td>Step by stepã§flakeã‚’è§£èª¬ã—ã¦ãã‚Œã¦ã‚ã‹ã‚Šã‚„ã™ã„ã€‚<tr><td><a href=https://serokell.io/blog/what-is-nix rel=external>What is Nix and Why You Should Use it</a><td>Nixã®èƒŒæ™¯ã‚„æ¦‚è¦ã®èª¬æ˜ãŒã‚ã‚ŠãŒãŸã„<tr><td><a href=https://xeiaso.net/blog/series/nix-flakes rel=external>Series: nix-flakes</a><td>å…¨7å›ã®nix-flakesã®blogè¨˜äº‹<tr><td><a href=https://shopify.engineering/what-is-nix rel=external>What Is Nix</a><td>2020å¹´ã ã‘ã©ã€Shopifyã®è¨˜äº‹<tr><td><a href=https://ianthehenry.com/posts/how-to-learn-nix/ rel=external>How to Learn Nix</a><td>å…¨47å›ã®nixå­¦ç¿’è¨˜éŒ²ã€‚è‡ªåˆ†ã®ç‰©ã®èª¿ã¹æ–¹ã¯ç”˜ã„ã‚“ã ãªã¨æ€ã‚ã•ã‚Œã‚‹ã€‚<tr><td><a href=https://www.tweag.io/blog/2020-05-25-flakes/ rel=external>NIX FLAKES, PART 1: AN INTORODUCTION AND TUTORIAL</a><td>flakeã®å®Ÿè£…ã‚’ä¸»å°ã—ãŸteamã«ã‚ˆã‚‹è¨˜äº‹<tr><td><a href=https://www.bekk.christmas/post/2021/16/dotfiles-with-nix-and-home-manager rel=external>Declarative management of dotfiles with Nix and Home manager</a><td>Home managerã®è§£èª¬è¨˜äº‹<tr><td><a href=https://lantian.pub/en/article/modify-website/nixos-why.lantian/ rel=external>NixOS Series 1: Why I fell in love</a><td>å…¨4å›ã®é€£è¼‰ã€nixãŒå¿…è¦ã ã£ãŸèƒŒæ™¯ã‚„ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ãŒå‚è€ƒã«ãªã‚‹<tr><td><a href=https://functor.tokyo/blog/2018-10-01-japanese-on-nixos rel=external>Japanese on NixOS</a><td>Nixã§æ—¥æœ¬èªç’°å¢ƒã©ã†ä½œã‚‹ã‹ã«ã¤ã„ã¦ã¨ã¦ã‚‚å‚è€ƒãªã£ãŸ<tr><td><a href=https://jorel.dev/NixOS4Noobs/intro.html rel=external>NixOS4Noobs</a><td>Flakeã§ã¯ãªãNixOSã®è§£èª¬<tr><td><a href=https://www.reddit.com/r/NixOS/comments/v2xpjm/big_list_of_flakes_tutorials/ rel=external>Big list of Flakes tutorials</a><td>Redditã®Flakeé–¢é€£ã®blogç­‰ã®ã¾ã¨ã‚</table><p>ä¸­ã§ã‚‚<a href=https://twitter.com/ryan4yin rel=external>ryan4yinã•ã‚“</a>ã®<a href=https://thiscute.world/en/posts/nixos-and-flake-basics/ rel=external>NixOS & Nix Flakes - A Guide for Beginners</a>ãŒã¨ã¦ã‚‚å‚è€ƒã«ãªã‚Šã¾ã—ãŸã€‚<br> ç¾åœ¨ã‚‚æ›´æ–°ãŒç¶šã„ã¦ãŠã‚Šã€<a href=https://github.com/ryan4yin/nix-config rel=external>repository</a>ã‚‚ã‚³ãƒ¡ãƒ³ãƒˆãŒæ²¢å±±æ›¸ã‹ã‚Œã¦ãŠã‚Šã€ãŠã™ã™ã‚ã§ã™ã€‚<h2 id=matome><a aria-label="Anchor link for: matome" class=zola-anchor href=#matome>ã¾ã¨ã‚</a></h2><p>éå¸¸ã«ç°¡å˜ã«ã§ã™ãŒnixã«å…¥é–€ã—ã¾ã—ãŸã€‚<br> Nixã™ã”ã„ãªã¨æ€ã„ã¾ã™ã€‚ã‚·ã‚¹ãƒ†ãƒ ã®æ§‹æˆç®¡ç†ã¨ã„ã†å‰¯ä½œç”¨ã®å¡Šã®ã‚ˆã†ãªé ˜åŸŸã§ã€pureã‚’ç›®æŒ‡ã™ã¨ã„ã†ç™ºæƒ³ãŒãªã‹ã£ãŸã§ã™ã€‚<p>æœ€å¾Œã«è‡ªå•è‡ªç­”ã—ãŸQï¼†A<ul><li><p>Ansibleã§ã‚ˆããªã„ã‹</p> <ul><li>ã¾ãšpythonã®ç’°å¢ƒä½œã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ã§ã‚‚templateã¯æ¬²ã—ããªã‚‹ã€‚</ul><li><p>dotfileç®¡ç†ã§ã‚„ã‚ŠãŸã„ã“ã¨ã®å¤§éƒ¨åˆ†ã§ããã†</p> <ul><li>terminal/shellã¾ã‚ã‚Šã®æ“ä½œæ„Ÿã‚’ç®¡ç†ã™ã‚‹ç‚¹ã«é–¢ã—ã¦ã¯ãã†æ€ã†ã€‚<li>nixã®ä»•çµ„ã¿ã§5å¹´,10å¹´æŒã¤ã®ã‹ã¨è¨€ã‚ã‚Œã‚‹ã¨ã‚ã‹ã‚‰ãªã„ã®ã§çµå±€ã‚·ãƒ³ãƒ—ãƒ«ãªä»•çµ„ã¿ã—ã‹æ®‹ã‚‰ãªã„ã®ã‹ã‚‚ã—ã‚Œãªã„ã¨ã‚‚æ€ã†ã€‚<li>ã‚„ã‚ŠãŸã„ã“ã¨ã®é †ç•ªã¨ã—ã¦ã¯Nixosã¨ã„ã†distributionã‚’ä½¿ã„ãŸã„ -> macã®è¨­å®šã‚‚ç®¡ç†ã§ãã‚‹ã‚‰ã—ã„ -> ãªã‚‰nixã§ä¸€å…ƒç®¡ç†ã—ã¦ã¿ã‚ˆã†ã¨ã„ã†æµã‚Œã ã£ãŸã®ã§ã€nixosã¯ä½¿ã„ãŸã„ã€‚</ul><li><p>ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•ã¯ã©ã‚“ãªç‚¹ã«ã‚ã‚Šãã†ã‹</p> <ul><li>storageã™ã”ã„ä½¿ã„ãã†ã€‚(<code>nix store gc</code>ã‚³ãƒãƒ³ãƒ‰ã¨ã‹ã‚ã‚‹)<li>å®£è¨€çš„(=ãƒ–ãƒ©ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹)ãªã®ã§å‡¦ç†ãŒçŸ¥ã‚ŠãŸã„ãªã‚‰ã‚½ãƒ¼ã‚¹èª­ã‚€å¿…è¦ãŒã‚ã‚‹ã€‚(ã§ã‚‚c++)</ul></ul></div></article></main><footer class=blog-footer><p>Â© 2026 <a href=https://blog.ymgyt.io> ymgyt </a> | Made with <a href=https://www.getzola.org rel=noopener target=_blank>Zola</a> | <a href=https://github.com/ymgyt/blog>Repository</a> | <a href=https://blog.ymgyt.io/atom.xml target=_blank title=rss> <svg viewbox="0 0 24 24" class=icon fill=none height=24 stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 width=24 xmlns=http://www.w3.org/2000/svg><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx=5 cy=19 r=1></circle></svg> </a></footer></div></div>