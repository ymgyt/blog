<!doctype html><html lang=ja><head><meta charset=UTF-8><meta content="width=device-width,initial-scale=1" name=viewport><link href=https://blog.ymgyt.io/favicon.ico rel=icon sizes=any><link href=https://blog.ymgyt.io/icon.svg rel=icon type=image/svg+xml><link href=https://blog.ymgyt.io/apple-touch-icon.png rel=apple-touch-icon><link href=https://blog.ymgyt.io/manifest.webmanifest rel=manifest><link href=https://blog.ymgyt.io/style.css rel=stylesheet><link href=https://blog.ymgyt.io/atom.xml rel=alternate title=Atom type=application/atom+xml><script src="https://www.googletagmanager.com/gtag/js?id=G-GTB0KMLN90" async></script><script>window.dataLayer = window.dataLayer || [];
	function gtag() {dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-GTB0KMLN90');</script><title>âœï¸ æœ€æ–°ã®Helixã§File explorerã‚’ä½¿ã„ãŸã„ | Happy developing</title><meta content="Helixã®master branchã§file tree explorerã‚’åˆ©ç”¨ã™ã‚‹ãŸã‚ã«è‡ªå‰ã§ç§»æ¤ã—ãŸ" name=description><meta content=summary name=twitter:card><meta content="@YAmaguchixt " name=twitter:site><meta content="âœï¸ æœ€æ–°ã®Helixã§File explorerã‚’ä½¿ã„ãŸã„" name=twitter:title><meta content="Helixã®master branchã§file tree explorerã‚’åˆ©ç”¨ã™ã‚‹ãŸã‚ã«è‡ªå‰ã§ç§»æ¤ã—ãŸ" name=twitter:description><meta content=https://blog.ymgyt.io/images/emoji/pencil2.png name=twitter:image><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><body><div class=world><div class=content-container><header class=blog-header-container><div class=blog-logo><a href=https://blog.ymgyt.io>Happy developing</a></div><div class=blog-nav><nav><ul><li><a href=https://blog.ymgyt.io/entry/>Entries</a><li><a href=https://blog.ymgyt.io/tags/>Tags</a><li><a href=https://blog.ymgyt.io/about/>About</a><li><a href=https://github.com/ymgyt> <img alt=Github class=icon src=https://blog.ymgyt.io/images/icon/github.svg> </a><li><a href="https://twitter.com/YAmaguchixt "> <img alt=Twitter class=icon src=https://blog.ymgyt.io/images/icon/twitter.svg> </a></ul></nav></div></header><main class=blog-main><article><header class=entry-header><h1 class=entry-title>âœï¸ æœ€æ–°ã®Helixã§File explorerã‚’ä½¿ã„ãŸã„</h1><div class=entry-meta><p class=entry-meta-item>ğŸ—“ 2024-01-17<p class=entry-meta-item>ğŸ· <span class=tag><a href=https://blog.ymgyt.io/tags/rust/>rust</a></span></div></header><aside class=entry-toc><nav><ul class=entry-toc-toplevel-list><li><a href=https://blog.ymgyt.io/entry/migrate-helix-file-explorer/#bei-jing>èƒŒæ™¯</a><li><a href=https://blog.ymgyt.io/entry/migrate-helix-file-explorer/#file-explorernobiao-shi>File explorerã®è¡¨ç¤º</a> <ul><li><a href=https://blog.ymgyt.io/entry/migrate-helix-file-explorer/#explorer-render>Explorer::render()</a><li><a href=https://blog.ymgyt.io/entry/migrate-helix-file-explorer/#treeview-render>TreeView::render()</a></ul><li><a href=https://blog.ymgyt.io/entry/migrate-helix-file-explorer/#yi-dong>ç§»å‹•</a><li><a href=https://blog.ymgyt.io/entry/migrate-helix-file-explorer/#filenobian-geng>Fileã®å¤‰æ›´</a><li><a href=https://blog.ymgyt.io/entry/migrate-helix-file-explorer/#shi-ifang>ä½¿ã„æ–¹</a><li><a href=https://blog.ymgyt.io/entry/migrate-helix-file-explorer/#matome>ã¾ã¨ã‚</a></ul></nav></aside><div class=entry-content><p>ç¾åœ¨ã®directoryæ§‹é€ ã‚’å·¦å´ã«è¡¨ç¤ºã™ã‚‹æ©Ÿèƒ½ã¯å„ç¨®editorã«ä¸€èˆ¬çš„ã«å‚™ã‚ã£ã¦ã„ã‚‹ã‚‚ã®ã‹ã¨æ€ã„ã¾ã™ã€‚<p><a href=https://github.com/helix-editor/helix rel=external>Helix</a>ã«ãã®æ©Ÿèƒ½ã‚’è¿½åŠ ã—ã‚ˆã†ã¨ã—ãŸ<a href=https://github.com/helix-editor/helix/pull/5768 rel=external>PR File explorer and tree helper (v3)</a>ã¯æ®‹å¿µãªãŒã‚‰mergeã«è‡³ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚<p>è‡ªåˆ†ã¯ã“ã®PR branchã‚’åˆ©ç”¨ã—ã¦ã„ãŸã®ã§ã™ãŒã€æ›´æ–°ã‹ã‚‰10ãƒ¶æœˆç¨‹åº¦çµŒã¡ã€masterã¨ã®ä¹–é›¢ãŒå¤§ãããªã£ã¦ãã¾ã—ãŸã€‚ ãã“ã§ã€<a href=https://github.com/helix-editor/helix rel=external>Helix</a>ã‚’<a href=https://github.com/ymgyt/helix/tree/explorer rel=external>fork</a>ã—ã¦ã€ã“ã®PRã‚’æœ€æ–°ã®masterã«ç§»æ¤ã—ã¦åˆ©ç”¨ã™ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚<p>æœ¬è¨˜äº‹ã§ã¯<a href=https://github.com/helix-editor/helix rel=external>Helix</a>ã«file explorerã¨ã„ã†directoryæ§‹é€ ã‚’è¡¨ç¤ºã™ã‚‹componentã‚’è¿½åŠ ã™ã‚‹ã†ãˆã§å¿…è¦ã ã£ãŸå¤‰æ›´ã«ã¤ã„ã¦æ›¸ãã¾ã™ã€‚<p>ãã‚‚ãã‚‚ã©ã†ã‚„ã£ã¦<a href=https://github.com/helix-editor/helix rel=external>Helix</a>ãŒfileã‚’è¡¨ç¤ºã—ã¦ã„ã‚‹ã‹ã«ã¤ã„ã¦ã¯ä»¥å‰ã€<a href=https://blog.ymgyt.io/entry/how-helix-render-file/ rel=external>HelixãŒfileã‚’renderingã™ã‚‹ä»•çµ„ã¿ã‚’ç†è§£ã™ã‚‹</a>ã§æ›¸ã„ãŸã‚Šã—ã¦ã„ã¾ã—ãŸã€‚<p>File explorerã¯ä¸‹è¨˜ã®ç”»åƒã®directoryæ§‹é€ ã‚’è¡¨ç¤ºã—ã¦ã„ã‚‹å·¦å´ã®componentã§ã™ã€‚<figure><div class=fig-images-row><img , alt src=images/helix-ss-1.png></div><figcaption>File explorer</figcaption></figure><p>(ãªãŠã€åŒæ§˜ã®æ©Ÿèƒ½ãŒfile treeã§ã‚ã£ãŸã‚Šã€file tree explorerã¨ã‚‚å‘¼ã°ã‚Œã‚‹ã“ã¨ã‚‚ã‚ã‚Šã¾ã™ãŒã€æœ¬è¨˜äº‹ã§ã¯file explorerã¨å‘¼ã³ã¾ã™)<h2 id=bei-jing><a aria-label="Anchor link for: bei-jing" class=zola-anchor href=#bei-jing>èƒŒæ™¯</a></h2><p><a href=https://github.com/helix-editor/helix rel=external>Helix</a>ã«file explorerã‚’è¿½åŠ ã—ã‚ˆã†ã¨ã„ã†<a href=https://github.com/helix-editor/helix/issues/200 rel=external>è¦æœ›</a>ã¯æ—©ãã‹ã‚‰ã‚ã‚Šã¾ã—ãŸã€‚<br> <a href=https://github.com/helix-editor/helix/pull/5768 rel=external>File explorer and tree helper (v3)</a>ã®PRãŒã§ããŸéš›ã¯ã™ãã«ä½¿ã£ã¦ã¿ã¦ã€ã¨ã¦ã‚‚æ°—ã«å…¥ã£ã¦ã„ã¾ã—ãŸã€‚<br> ã—ã‹ã—ãªãŒã‚‰ã€æœ€çµ‚çš„ã«file explorerã¯pluginã§å®Ÿè£…ã™ã¹ãã§ã€<a href=https://github.com/helix-editor/helix rel=external>Helix</a>ã®coreã«ã¯å«ã‚ãªã„ã¨ã®æ±ºæ–­ãŒãªã•ã‚Œã¾ã—ãŸã€‚<blockquote><p>A file tree explorer is a big feature and there's a lot of people who wouldn't benefit from it, including the maintainers, who would be "forced" to maintain it. This is precisely where plugins come into play, because they delegate maintenance to plugin authors and they are "opt-in" based.</blockquote><p>https://github.com/helix-editor/helix/pull/5768#issuecomment-1722508888<p><a href=https://github.com/helix-editor/helix rel=external>Helix</a>ã®ä¸»è¦ãªé–‹ç™ºè€…ã®ä¸€äººã§ã‚ã‚‰ã‚Œã‚‹pascalå…ˆç”Ÿã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãŠã£ã—ã‚ƒã‚‰ã‚Œã¦ã„ã¾ã—ãŸã€‚<blockquote><p>Utimately different people have different preferences and we can't please everyone. There are a billion different file navigation plugins/tuis around and building them all into helix would bloat it quite a lot and ultimately would not end well.</blockquote><p>https://matrix.to/#/!glLuldscRKMQxGWgjZ:matrix.org/$2zxk4ODb-g3lQcKTgRvSnCbC4szNhJxxkGgjO3cOXyQ?via=matrix.org&via=envs.net&via=tchncs.de<p><a href=https://github.com/helix-editor/helix rel=external>Helix</a>ã§ã¯pluginæ©Ÿæ§‹ã¯<a href=https://github.com/helix-editor/helix/issues/122 rel=external>è­°è«–</a>ã•ã‚Œã¦ã„ã‚‹ã‚‚ã®ã®ã€ã¾ã å®Ÿè£…ã«è‡³ã£ã¦ã„ãªã„ã®ã§çµæœçš„ã«æœ€æ–°ã®<a href=https://github.com/helix-editor/helix rel=external>Helix</a>ã‚’åˆ©ç”¨ã—ã¤ã¤ã€file explorerã‚’ä½¿ã†ã«ã¯è‡ªå‰ã§ã‚„ã‚‹ã—ã‹ãªã„ã“ã¨ã«ãªã‚Šã¾ã—ãŸã€‚<p>ã‚‚ã†ä¸€ã¤ã®é¸æŠè‚¢ã¨ã—ã¦ã¯<a href=https://github.com/helix-editor/helix/discussions/8314 rel=external>File explorer workaround until plugin system arrives #8314</a> discussionã§ææ¡ˆã•ã‚Œã¦ã„ã‚‹ã€zellijã‚„weztermç­‰ã®terminal multiplexer + brootã‚„yaziç­‰ã®file explorerã‚’çµ„ã¿åˆã‚ã›ã‚‹æ‰‹æ³•ã§ã™ã€‚<br> ã“ã¡ã‚‰ã®ã»ã†ãŒcomposableã§ç­‹ãŒè‰¯ã„ã‚ˆã†ã«æ€ãˆã¾ã™ãŒã€tool -> helixã®é€£æºã§èª²é¡ŒãŒã‚ã‚Šæ¡ç”¨ã—ã¾ã›ã‚“ã§ã—ãŸã€‚<p>ã“ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã§ã¯<a href=https://quantonganh.com/2023/08/19/turn-helix-into-ide.md rel=external>Turning Helix into an IDE with the help of WezTerm and CLI tools</a>ãŒå‚è€ƒã«ãªã‚Šã¾ã—ãŸã€‚<h2 id=file-explorernobiao-shi><a aria-label="Anchor link for: file-explorernobiao-shi" class=zola-anchor href=#file-explorernobiao-shi>File explorerã®è¡¨ç¤º</a></h2><p><a href=https://github.com/helix-editor/helix rel=external>Helix</a>(<code>hx</code> command)èµ·å‹•æ™‚ã‹ã‚‰ç·¨é›†å¯¾è±¡ã®fileãŒè¡¨ç¤ºã•ã‚Œã‚‹ã¾ã§ã®è©³ã—ã„èª¬æ˜ã¯<a href=https://blog.ymgyt.io/entry/how-helix-render-file/ rel=external>HelixãŒfileã‚’renderingã™ã‚‹ä»•çµ„ã¿ã‚’ç†è§£ã™ã‚‹</a>ã§æ›¸ãã¾ã—ãŸã€‚<br> æ¦‚è¦ã¨ã—ã¦ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«<code>EditorView</code>ãŒterminalã«å¯¾ã™ã‚‹renderingã‚’è¡Œã†ã®ã§ã€ãã“ã«file exploerã‚’å·®ã—è¾¼ã¿ã¾ã™ã€‚<figure><div class=fig-images-row><img , alt src=https://blog.ymgyt.io/entry/how-helix-render-file/images/helix_render_sequence.svg></div><figcaption>Helix rendering sequence</figcaption></figure><p><a href=https://github.com/helix-editor/helix rel=external>Helix</a>ã®å„ç¨®componentã¯<code>helix_term::compositor::Component</code> traitã‚’å®Ÿè£…ã—ã¾ã™ã€‚<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=rust><span class=giallo-l><span style=color:#81a1c1>pub trait</span><span style=color:#8fbcbb;font-weight:700> Component</span><span style=color:#81a1c1>:</span><span style=color:#8fbcbb> Any</span><span style=color:#81a1c1> +</span><span style=color:#8fbcbb> AnyComponent</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#616e88>    /// Process input events, return true if handled.</span></span>
<span class=giallo-l><span style=color:#81a1c1>    fn</span><span style=color:#88c0d0> handle_event</span><span style=color:#eceff4>(</span><span style=color:#81a1c1>&mut self</span><span style=color:#eceff4>,</span><span> _event</span><span style=color:#81a1c1>: &</span><span style=color:#8fbcbb>Event</span><span style=color:#eceff4>,</span><span> _ctx</span><span style=color:#81a1c1>: &mut</span><span style=color:#8fbcbb> Context</span><span style=color:#eceff4>)</span><span style=color:#81a1c1> -></span><span style=color:#8fbcbb> EventResult</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#8fbcbb>        EventResult</span><span style=color:#81a1c1>::</span><span style=color:#88c0d0>Ignored</span><span style=color:#eceff4>(</span><span style=color:#8fbcbb>None</span><span style=color:#eceff4>)</span></span>
<span class=giallo-l><span style=color:#eceff4>    }</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#616e88>    /// Render the component onto the provided surface.</span></span>
<span class=giallo-l><span style=color:#81a1c1>    fn</span><span style=color:#88c0d0> render</span><span style=color:#eceff4>(</span><span style=color:#81a1c1>&mut self</span><span style=color:#eceff4>,</span><span> area</span><span style=color:#81a1c1>:</span><span style=color:#8fbcbb> Rect</span><span style=color:#eceff4>,</span><span> frame</span><span style=color:#81a1c1>: &mut</span><span style=color:#8fbcbb> Surface</span><span style=color:#eceff4>,</span><span> ctx</span><span style=color:#81a1c1>: &mut</span><span style=color:#8fbcbb> Context</span><span style=color:#eceff4>);</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#616e88>    /// ...</span></span>
<span class=giallo-l><span style=color:#eceff4>}</span></span></code></pre><p>ä¸Šè¨˜ã®ã‚ˆã†ã«userã®keyå…¥åŠ›ã®å‡¦ç†ã‚’è¡Œã†<code>handle_event()</code>ã‚„terminalã«æç”»ã‚’è¡Œã†<code>render()</code>ã®å®Ÿè£…ãŒè¦æ±‚ã•ã‚Œã¾ã™ã€‚<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=rust><span class=giallo-l><span style=color:#81a1c1>impl</span><span style=color:#8fbcbb> Component</span><span style=color:#81a1c1> for</span><span style=color:#8fbcbb> EditorView</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#81a1c1>    fn</span><span style=color:#88c0d0> render</span><span style=color:#eceff4>(</span><span style=color:#81a1c1>&mut self</span><span style=color:#eceff4>,</span><span> area</span><span style=color:#81a1c1>:</span><span style=color:#8fbcbb> Rect</span><span style=color:#eceff4>,</span><span> surface</span><span style=color:#81a1c1>: &mut</span><span style=color:#8fbcbb> Surface</span><span style=color:#eceff4>,</span><span> cx</span><span style=color:#81a1c1>: &mut</span><span style=color:#8fbcbb> Context</span><span style=color:#eceff4>) {</span></span>
<span class=giallo-l><span style=color:#616e88>      // ...</span></span>
<span class=giallo-l><span style=color:#eceff4>    }</span></span>
<span class=giallo-l><span style=color:#eceff4>}</span></span></code></pre><p><code>Component::render()</code>ã®å¼•æ•°ã¨ã—ã¦ä»¥ä¸‹ãŒä¸ãˆã‚‰ã‚Œã¾ã™ã€‚<ul><li><code>Rect</code>: å„componentãŒrenderã™ã¹ãé ˜åŸŸ(x,yåº§æ¨™ã¨width,heightã‚’ä¿æŒ)<li><code>&mut Surface</code>: terminalã«æç”»ã•ã‚Œã‚‹buffer<li><code>&mut Context</code>: editorã®çŠ¶æ…‹ã‚„è¨­å®šã¸ã®accessã‚’æä¾›</ul><pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=rust><span class=giallo-l><span style=color:#81a1c1>pub struct</span><span style=color:#8fbcbb> EditorView</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#616e88>    // ...</span></span>
<span class=giallo-l><span style=color:#81a1c1>    pub</span><span style=color:#eceff4>(</span><span style=color:#81a1c1>crate</span><span style=color:#eceff4>)</span><span> explorer</span><span style=color:#81a1c1>:</span><span style=color:#8fbcbb> Option</span><span style=color:#eceff4>&lt;</span><span style=color:#8fbcbb>Explorer</span><span style=color:#eceff4>>,</span></span>
<span class=giallo-l><span style=color:#eceff4>}</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#81a1c1>impl</span><span style=color:#8fbcbb> Component</span><span style=color:#81a1c1> for</span><span style=color:#8fbcbb> EditorView</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#81a1c1>    fn</span><span style=color:#88c0d0> render</span><span style=color:#eceff4>(</span><span style=color:#81a1c1>&mut self</span><span style=color:#eceff4>,</span><span> area</span><span style=color:#81a1c1>:</span><span style=color:#8fbcbb> Rect</span><span style=color:#eceff4>,</span><span> surface</span><span style=color:#81a1c1>: &mut</span><span style=color:#8fbcbb> Surface</span><span style=color:#eceff4>,</span><span> cx</span><span style=color:#81a1c1>: &mut</span><span style=color:#8fbcbb> Context</span><span style=color:#eceff4>) {</span></span>
<span class=giallo-l><span style=color:#616e88>        // ...</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#81a1c1>        if let</span><span style=color:#8fbcbb> Some</span><span style=color:#eceff4>(</span><span>explorer</span><span style=color:#eceff4>)</span><span style=color:#81a1c1> = self.</span><span>explorer</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>as_mut</span><span style=color:#eceff4>() {</span></span>
<span class=giallo-l><span style=color:#616e88>            // ...</span></span>
<span class=giallo-l><span>            explorer</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>render</span><span style=color:#eceff4>(</span><span>area</span><span style=color:#eceff4>,</span><span> surface</span><span style=color:#eceff4>,</span><span> cx</span><span style=color:#eceff4>);</span></span>
<span class=giallo-l><span style=color:#eceff4>        }</span></span>
<span class=giallo-l><span style=color:#616e88>        // ...</span></span>
<span class=giallo-l><span style=color:#eceff4>    }</span></span>
<span class=giallo-l><span style=color:#eceff4>}</span></span></code></pre><p><code>EditorView::render()</code>ã§ã¯è‡ªèº«ãŒä»Šå›è¿½åŠ ã™ã‚‹<code>Explorer</code>ã‚’ä¿æŒã—ã¦ã„ã‚Œã°ãã®<code>render()</code>ã‚’å‘¼ã¶ã¨ã„ã†åˆ†å²ãŒå…¥ã£ã¦ã„ã¾ã™ã€‚<br> ã“ã‚Œã‚’è¡Œã†ã®ãŒã€<code>reveal_current_file</code> commandã§ã™ã€‚defaultã®è¨­å®šã§ã¯Space+eã§å®Ÿè¡Œã§ãã¾ã™ã€‚<figure><div class=fig-images-row><img , alt src=images/helix-ss-reveal.png></div><figcaption>ä¸‹ã‹ã‚‰2ç•ªç›®ã«reveal_current_file commandãŒã‚ã‚‹</figcaption></figure><p>ç‹¬è‡ªã®commandã‚’è¿½åŠ ã™ã‚‹ã«ã¯<code>helix_term::keymap::default::default()</code>ã«è¿½åŠ ã—ã¾ã™ã€‚<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=rust><span class=giallo-l><span style=color:#81a1c1>pub fn</span><span style=color:#88c0d0> default</span><span style=color:#eceff4>()</span><span style=color:#81a1c1> -></span><span style=color:#8fbcbb> HashMap</span><span style=color:#eceff4>&lt;</span><span style=color:#8fbcbb>Mode</span><span style=color:#eceff4>,</span><span style=color:#8fbcbb> KeyTrie</span><span style=color:#eceff4>> {</span></span>
<span class=giallo-l><span style=color:#81a1c1>    let</span><span> normal</span><span style=color:#81a1c1> =</span><span style=color:#88c0d0;font-weight:700> keymap!</span><span style=color:#eceff4>({ "</span><span style=color:#a3be8c>Normal mode</span><span style=color:#eceff4>"</span></span>
<span class=giallo-l><span style=color:#616e88>        // ...</span></span>
<span class=giallo-l><span style=color:#eceff4>        "</span><span style=color:#a3be8c>space</span><span style=color:#eceff4>"</span><span style=color:#81a1c1> =></span><span style=color:#eceff4> { "</span><span style=color:#a3be8c>Space</span><span style=color:#eceff4>"</span></span>
<span class=giallo-l><span style=color:#eceff4>            "</span><span style=color:#a3be8c>f</span><span style=color:#eceff4>"</span><span style=color:#81a1c1> =></span><span> file_picker</span><span style=color:#eceff4>,</span></span>
<span class=giallo-l><span style=color:#eceff4>            "</span><span style=color:#a3be8c>F</span><span style=color:#eceff4>"</span><span style=color:#81a1c1> =></span><span> file_picker_in_current_directory</span><span style=color:#eceff4>,</span></span>
<span class=giallo-l><span style=color:#616e88>            // ...</span></span>
<span class=giallo-l><span style=color:#eceff4>            "</span><span style=color:#a3be8c>e</span><span style=color:#eceff4>"</span><span style=color:#81a1c1> =></span><span> reveal_current_file</span><span style=color:#eceff4>,</span><span style=color:#616e88> // ğŸ‘ˆ </span></span>
<span class=giallo-l><span style=color:#eceff4>    })</span></span>
<span class=giallo-l><span style=color:#616e88>    // ...</span></span>
<span class=giallo-l><span style=color:#eceff4>}</span></span></code></pre><p>ã“ã®<code>keymap!</code> macroã«commandã®èµ·å‹•sequenceã‚’æ¸¡ã™ã¨Space+eã§æ¸¡ã—ãŸcommand(é–¢æ•°)ã‚’å‘¼ã³å‡ºã™ã“ã¨ãŒã§ãã¾ã™ã€‚<br> ã“ã‚Œã¯ã‚ãã¾ã§defaultã®è¨­å®šã§ã€è¨­å®šfileã‹ã‚‰ä»¥ä¸‹ã®ã‚ˆã†ã«ã™ã‚‹ã¨ä¸Šæ›¸ãã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=toml><span class=giallo-l><span style=color:#eceff4>[</span><span>keys.normal.space</span><span style=color:#eceff4>]</span></span>
<span class=giallo-l><span>E</span><span style=color:#eceff4> = "</span><span style=color:#a3be8c>reveal_current_file</span><span style=color:#eceff4>"</span></span></code></pre><p>(è¨­å®šfileã¯<code>:config-open</code>ã§é–‹ãã“ã¨ãŒã§ãã€<code>:config-reload</code>ã§åæ˜ ã§ãã¾ã™)<p><code>reveal_current_file()</code>ã¯ä¸‹è¨˜ã®ã‚ˆã†ã«å®Ÿè£…ã•ã‚Œã¦ã„ã¾ã™ã€‚<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=rust><span class=giallo-l><span style=color:#81a1c1>fn</span><span style=color:#88c0d0> reveal_file</span><span style=color:#eceff4>(</span><span>cx</span><span style=color:#81a1c1>: &mut</span><span style=color:#8fbcbb> Context</span><span style=color:#eceff4>,</span><span> path</span><span style=color:#81a1c1>:</span><span style=color:#8fbcbb> Option</span><span style=color:#eceff4>&lt;</span><span style=color:#8fbcbb>PathBuf</span><span style=color:#eceff4>>) {</span></span>
<span class=giallo-l><span>    cx</span><span style=color:#81a1c1>.</span><span>callback </span><span style=color:#81a1c1>=</span><span style=color:#8fbcbb> Some</span><span style=color:#eceff4>(</span><span style=color:#8fbcbb>Box</span><span style=color:#81a1c1>::</span><span style=color:#88c0d0>new</span><span style=color:#eceff4>(</span></span>
<span class=giallo-l><span style=color:#81a1c1>        |</span><span>compositor</span><span style=color:#81a1c1>: &mut</span><span style=color:#8fbcbb> Compositor</span><span style=color:#eceff4>,</span><span> cx</span><span style=color:#81a1c1>: &mut</span><span> compositor</span><span style=color:#81a1c1>::</span><span style=color:#8fbcbb>Context</span><span style=color:#81a1c1>|</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#81a1c1>            let</span><span style=color:#8fbcbb> Some</span><span style=color:#eceff4>(</span><span>editor</span><span style=color:#eceff4>)</span><span style=color:#81a1c1> =</span><span> compositor</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>find</span><span style=color:#81a1c1>::</span><span style=color:#eceff4>&lt;</span><span>ui</span><span style=color:#81a1c1>::</span><span style=color:#8fbcbb>EditorView</span><span style=color:#eceff4>>()</span><span style=color:#81a1c1> else</span><span style=color:#eceff4> {</span><span style=color:#81a1c1> return</span><span style=color:#eceff4> };</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#eceff4>            (</span><span style=color:#81a1c1>|| match</span><span> editor</span><span style=color:#81a1c1>.</span><span>explorer</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>as_mut</span><span style=color:#eceff4>() {</span></span>
<span class=giallo-l><span style=color:#8fbcbb>                Some</span><span style=color:#eceff4>(</span><span>explorer</span><span style=color:#eceff4>)</span><span style=color:#81a1c1> => match</span><span> path</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#8fbcbb>                    Some</span><span style=color:#eceff4>(</span><span>path</span><span style=color:#eceff4>)</span><span style=color:#81a1c1> =></span><span> explorer</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>reveal_file</span><span style=color:#eceff4>(</span><span>path</span><span style=color:#eceff4>),</span></span>
<span class=giallo-l><span style=color:#8fbcbb>                    None</span><span style=color:#81a1c1> =></span><span> explorer</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>reveal_current_file</span><span style=color:#eceff4>(</span><span>cx</span><span style=color:#eceff4>),</span></span>
<span class=giallo-l><span style=color:#eceff4>                },</span></span>
<span class=giallo-l><span style=color:#8fbcbb>                None</span><span style=color:#81a1c1> =></span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span>                    editor</span><span style=color:#81a1c1>.</span><span>explorer </span><span style=color:#81a1c1>=</span><span style=color:#8fbcbb> Some</span><span style=color:#eceff4>(</span><span>ui</span><span style=color:#81a1c1>::</span><span style=color:#8fbcbb>Explorer</span><span style=color:#81a1c1>::</span><span style=color:#88c0d0>new</span><span style=color:#eceff4>(</span><span>cx</span><span style=color:#eceff4>)</span><span style=color:#81a1c1>?</span><span style=color:#eceff4>);</span></span>
<span class=giallo-l><span>                    editor</span><span style=color:#81a1c1>.</span><span>explorer</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>as_mut</span><span style=color:#eceff4>()</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>unwrap</span><span style=color:#eceff4>()</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>reveal_current_file</span><span style=color:#eceff4>(</span><span>cx</span><span style=color:#eceff4>)</span><span style=color:#81a1c1>?</span><span style=color:#eceff4>;</span></span>
<span class=giallo-l><span style=color:#8fbcbb>                    Ok</span><span style=color:#eceff4>(())</span></span>
<span class=giallo-l><span style=color:#eceff4>                }</span></span>
<span class=giallo-l><span style=color:#eceff4>            })()</span></span>
<span class=giallo-l><span style=color:#81a1c1>            .</span><span style=color:#88c0d0>unwrap_or_else</span><span style=color:#eceff4>(</span><span style=color:#81a1c1>|</span><span>err</span><span style=color:#81a1c1>|</span><span> cx</span><span style=color:#81a1c1>.</span><span>editor</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>set_error</span><span style=color:#eceff4>(</span><span>err</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>to_string</span><span style=color:#eceff4>()))</span></span>
<span class=giallo-l><span style=color:#eceff4>        },</span></span>
<span class=giallo-l><span style=color:#eceff4>    ));</span></span>
<span class=giallo-l><span style=color:#eceff4>}</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#81a1c1>fn</span><span style=color:#88c0d0> reveal_current_file</span><span style=color:#eceff4>(</span><span>cx</span><span style=color:#81a1c1>: &mut</span><span style=color:#8fbcbb> Context</span><span style=color:#eceff4>) {</span></span>
<span class=giallo-l><span style=color:#88c0d0>    reveal_file</span><span style=color:#eceff4>(</span><span>cx</span><span style=color:#eceff4>,</span><span style=color:#8fbcbb> None</span><span style=color:#eceff4>)</span></span>
<span class=giallo-l><span style=color:#eceff4>}</span></span></code></pre><p>ã“ã“ã§ã€callbackã¨ã—ã¦è¨­å®šã—ã¦ãŠãã¨<a href=https://github.com/helix-editor/helix/blob/783ff27b1ba901e30dbf9897f4faaeb123bebb12/helix-term/src/compositor.rs#L170 rel=external>event handling</a>ã§å‘¼ã‚“ã§ã‚‚ã‚‰ãˆã¾ã™ã€‚<br> <code>Compositor</code>ã¯å„ç¨®componentã‚’ç®¡ç†ã™ã‚‹structã§ã€ãã“ã‹ã‚‰<code>EditorView</code>ã‚’å–å¾—ã—ã€<code>Explorer</code>ãŒä¿æŒã•ã‚Œã¦ã„ãªã‘ã‚Œã°ç”Ÿæˆã—ã¾ã™ã€‚<p>ã“ã‚Œã§ã€Space+eã‚’æŠ¼ã™ã¨<code>Explorer</code>ãŒç”Ÿæˆã•ã‚Œã€<code>render()</code>å‡¦ç†ãŒå‘¼ã°ã‚Œã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã—ãŸã€‚<h3 id=explorer-render><a aria-label="Anchor link for: explorer-render" class=zola-anchor href=#explorer-render><code>Explorer::render()</code></a></h3><p><code>Explorer</code>ã¯directoryæ§‹é€ ã‚’æç”»ã™ã‚‹ãŸã‚ã®componentã§ã€ä»¥ä¸‹ã®ã‚ˆã†ã«å®šç¾©ã•ã‚Œã¦ã„ã¾ã™ã€‚<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=rust><span class=giallo-l><span style=color:#81a1c1>pub struct</span><span style=color:#8fbcbb> Explorer</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span>    tree</span><span style=color:#81a1c1>:</span><span style=color:#8fbcbb> TreeView</span><span style=color:#eceff4>&lt;</span><span style=color:#8fbcbb>FileInfo</span><span style=color:#eceff4>>,</span></span>
<span class=giallo-l><span>    state</span><span style=color:#81a1c1>:</span><span style=color:#8fbcbb> State</span><span style=color:#eceff4>,</span></span>
<span class=giallo-l><span>    prompt</span><span style=color:#81a1c1>:</span><span style=color:#8fbcbb> Option</span><span style=color:#eceff4>&lt;(</span><span style=color:#8fbcbb>PromptAction</span><span style=color:#eceff4>,</span><span style=color:#8fbcbb> Prompt</span><span style=color:#eceff4>)>,</span></span>
<span class=giallo-l><span style=color:#616e88>    // ...</span></span>
<span class=giallo-l><span style=color:#eceff4>}</span></span></code></pre><ul><li><code>TreeView</code>ã¯directoryæ§‹é€ ã‚’ä¿æŒã™ã‚‹structã§ã™ã€‚<code>FileInfo</code>ã¯å¿…è¦ãªfilesystemã¸ã®accessã‚’æŠ½è±¡åŒ–ã—ã¦ã„ã¾ã™ã€‚<li><code>State</code>ã¯uiã®çŠ¶æ…‹ã‚’ä¿æŒã—ã¦ãŠã‚Šã€è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã‹ã‚„ã€focusã®æœ‰ç„¡ã‚’ç®¡ç†ã—ã¦ã„ã¾ã™ã€‚<li><code>Option&lt;(PromptAction,Prompt)></code>ã¯fileã®ä½œæˆã‚„renameæ™‚ã®å…¥åŠ›ã‚’ä¿æŒã—ã¦ã„ã¾ã™ã€‚</ul><p>å®Ÿéš›ã®file explorerã®renderingã¯ä»¥ä¸‹ã®ã‚ˆã†ã«å®šç¾©ã•ã‚Œã¦ã„ã¾ã™ã€‚<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=rust><span class=giallo-l><span style=color:#81a1c1>impl</span><span style=color:#8fbcbb> Component</span><span style=color:#81a1c1> for</span><span style=color:#8fbcbb> Explorer</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#616e88>    // ...</span></span>
<span class=giallo-l><span style=color:#81a1c1>    fn</span><span style=color:#88c0d0> render</span><span style=color:#eceff4>(</span><span style=color:#81a1c1>&mut self</span><span style=color:#eceff4>,</span><span> area</span><span style=color:#81a1c1>:</span><span style=color:#8fbcbb> Rect</span><span style=color:#eceff4>,</span><span> surface</span><span style=color:#81a1c1>: &mut</span><span style=color:#8fbcbb> Surface</span><span style=color:#eceff4>,</span><span> cx</span><span style=color:#81a1c1>: &mut</span><span style=color:#8fbcbb> Context</span><span style=color:#eceff4>) {</span></span>
<span class=giallo-l><span style=color:#81a1c1>        if</span><span> area</span><span style=color:#81a1c1>.</span><span>width</span><span style=color:#81a1c1> &lt;</span><span style=color:#b48ead> 10</span><span style=color:#81a1c1> ||</span><span> area</span><span style=color:#81a1c1>.</span><span>height</span><span style=color:#81a1c1> &lt;</span><span style=color:#b48ead> 5</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span>            cx</span><span style=color:#81a1c1>.</span><span>editor</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>set_error</span><span style=color:#eceff4>("</span><span style=color:#a3be8c>explorer render area is too small</span><span style=color:#eceff4>");</span></span>
<span class=giallo-l><span style=color:#81a1c1>            return</span><span style=color:#eceff4>;</span></span>
<span class=giallo-l><span style=color:#eceff4>        }</span></span>
<span class=giallo-l><span style=color:#81a1c1>        self.</span><span style=color:#88c0d0>render_embed</span><span style=color:#eceff4>(</span><span>area</span><span style=color:#eceff4>,</span><span> surface</span><span style=color:#eceff4>,</span><span> cx</span><span style=color:#eceff4>);</span></span>
<span class=giallo-l><span style=color:#eceff4>    }</span></span>
<span class=giallo-l><span style=color:#616e88>    // ...</span></span>
<span class=giallo-l><span style=color:#eceff4>}</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#81a1c1>impl</span><span style=color:#8fbcbb> Explorer</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#616e88>    // ...</span></span>
<span class=giallo-l><span style=color:#81a1c1>    fn</span><span style=color:#88c0d0> render_embed</span><span style=color:#eceff4>(</span><span style=color:#81a1c1>&mut self</span><span style=color:#eceff4>,</span><span> area</span><span style=color:#81a1c1>:</span><span style=color:#8fbcbb> Rect</span><span style=color:#eceff4>,</span><span> surface</span><span style=color:#81a1c1>: &mut</span><span style=color:#8fbcbb> Surface</span><span style=color:#eceff4>,</span><span> cx</span><span style=color:#81a1c1>: &mut</span><span style=color:#8fbcbb> Context</span><span style=color:#eceff4>) {</span></span>
<span class=giallo-l><span style=color:#81a1c1>        if !self.</span><span>state</span><span style=color:#81a1c1>.</span><span>open </span><span style=color:#eceff4>{</span></span>
<span class=giallo-l><span style=color:#81a1c1>            return</span><span style=color:#eceff4>;</span></span>
<span class=giallo-l><span style=color:#eceff4>        }</span></span>
<span class=giallo-l><span style=color:#81a1c1>        let</span><span> width</span><span style=color:#81a1c1> =</span><span> area</span><span style=color:#81a1c1>.</span><span>width</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>min</span><span style=color:#eceff4>(</span><span style=color:#81a1c1>self.</span><span>column_width </span><span style=color:#81a1c1>+</span><span style=color:#b48ead> 2</span><span style=color:#eceff4>);</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#616e88>        // for command prompt</span></span>
<span class=giallo-l><span style=color:#81a1c1>        let</span><span> side_area</span><span style=color:#81a1c1> =</span><span style=color:#8fbcbb> Rect</span><span style=color:#eceff4> {</span><span> width</span><span style=color:#eceff4>,</span><span style=color:#81a1c1> ..</span><span>area</span><span style=color:#eceff4> }</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>clip_bottom</span><span style=color:#eceff4>(</span><span style=color:#b48ead>1</span><span style=color:#eceff4>);</span></span>
<span class=giallo-l><span style=color:#81a1c1>        let</span><span> background</span><span style=color:#81a1c1> =</span><span> cx</span><span style=color:#81a1c1>.</span><span>editor</span><span style=color:#81a1c1>.</span><span>theme</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>get</span><span style=color:#eceff4>("</span><span style=color:#a3be8c>ui.background</span><span style=color:#eceff4>");</span></span>
<span class=giallo-l><span>        surface</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>clear_with</span><span style=color:#eceff4>(</span><span>side_area</span><span style=color:#eceff4>,</span><span> background</span><span style=color:#eceff4>);</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#81a1c1>        let</span><span> prompt_area</span><span style=color:#81a1c1> =</span><span> area</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>clip_top</span><span style=color:#eceff4>(</span><span>side_area</span><span style=color:#81a1c1>.</span><span>height</span><span style=color:#eceff4>);</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#81a1c1>        let</span><span> list_area</span><span style=color:#81a1c1> =</span></span>
<span class=giallo-l><span style=color:#88c0d0>            render_block</span><span style=color:#eceff4>(</span><span>side_area</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>clip_left</span><span style=color:#eceff4>(</span><span style=color:#b48ead>1</span><span style=color:#eceff4>),</span><span> surface</span><span style=color:#eceff4>,</span><span> Borders</span><span style=color:#81a1c1>::</span><span>RIGHT</span><span style=color:#eceff4>)</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>clip_bottom</span><span style=color:#eceff4>(</span><span style=color:#b48ead>1</span><span style=color:#eceff4>);</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#81a1c1>        self.</span><span style=color:#88c0d0>render_tree</span><span style=color:#eceff4>(</span><span>list_area</span><span style=color:#eceff4>,</span><span> prompt_area</span><span style=color:#eceff4>,</span><span> surface</span><span style=color:#eceff4>,</span><span> cx</span><span style=color:#eceff4>);</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#81a1c1>        if let</span><span style=color:#8fbcbb> Some</span><span style=color:#eceff4>((</span><span>_</span><span style=color:#eceff4>,</span><span> prompt</span><span style=color:#eceff4>))</span><span style=color:#81a1c1> = self.</span><span>prompt</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>as_mut</span><span style=color:#eceff4>() {</span></span>
<span class=giallo-l><span>            prompt</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>render_prompt</span><span style=color:#eceff4>(</span><span>prompt_area</span><span style=color:#eceff4>,</span><span> surface</span><span style=color:#eceff4>,</span><span> cx</span><span style=color:#eceff4>)</span></span>
<span class=giallo-l><span style=color:#eceff4>        }</span></span>
<span class=giallo-l><span style=color:#eceff4>    }</span></span>
<span class=giallo-l><span style=color:#eceff4>}</span></span></code></pre><p><code>render_embed()</code>ã®å¼•æ•°ã®<code>area</code>ã¯<code>EditorView</code>ã‚‚å«ã‚ãŸterminalå…¨ä½“ã‚’æŒ‡ã—ã¦ãŠã‚Šã€ãã“ã‹ã‚‰å·¦å´ã«file treeã‚’æç”»ã™ã‚‹é ˜åŸŸã‚’ä½œã£ã¦ã„ã¾ã™ã€‚<ul><li><code>Rect::clip_xxx()</code>ã¯æç”»é ˜åŸŸã‚’å‰Šã‚‹å½¹å‰²ã‚’ã‚‚ã¡ã€<code>clip_bottom(1)</code>ã‚’ã™ã‚‹ã¨ã€æç”»é ˜åŸŸãŒä¸‹ã‹ã‚‰1è¡ŒçŸ­ããªã‚Šã¾ã™ã€‚<li><code>cx.editor.theme.get("ui.background")</code>ã¯ç¾åœ¨ã®backgroundç”¨ã®<code>Style</code>ã‚’å‹•çš„ã«å–å¾—ã—ã¾ã™ã€‚(themeã¯<code>:theme</code> ã§å¤‰æ›´ã§ãã¾ã™)<li><code>surface.clear_with()</code>ã¯æŒ‡å®šç¯„å›²ã«<code>Style</code>ã‚’é©ç”¨ã—ã¾ã™ã€‚<li><code>let prompt_area = area.clip_top(side_area.height)</code>ã§terminalå…¨ä½“ã®ä¸‹1è¡Œã‚’ç¢ºä¿ã—ã¦ã„ã¾ã™ã€‚ã“ã“ã«fileã‚’å‰Šé™¤ã—ã¾ã™ã‹?ã¨ã„ã£ãŸpromptã‚’è¡¨ç¤ºã—ã¾ã™<li><code>let list_area = render_block(side_area.clip_left(1), surface, Borders::RIGHT).clip_bottom(1)</code> ã§file exploreré ˜åŸŸã«borderã‚’æç”»ã—ã¦ã„ã¾ã™<li><code>self.reder_tree(list_are, prompt_area, surface, cx)</code> æŒ‡å®šã—ãŸé ˜åŸŸã«directoryæ§‹é€ ã‚’æç”»ã—ã¾ã™<li><code>prompt.render_prompt(prompt_area, surface, cx</code> userã«è¡¨ç¤ºã™ã¹ãpromptãŒã‚ã‚Œã°æç”»ã—ã¾ã™ã€‚<code>Prompt</code>ã¯ã™ã§ã«helixã«å®Ÿè£…ã•ã‚Œã¦ã„ã¾ã™</ul><p>å„é ˜åŸŸã¯æ¦‚ã­ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ã€‚<figure><div class=fig-images-row><img , alt src=images/helix-explorer-area.png></div><figcaption>Explorer erea</figcaption></figure><h3 id=treeview-render><a aria-label="Anchor link for: treeview-render" class=zola-anchor href=#treeview-render><code>TreeView::render()</code></a></h3><p>æœ€çµ‚çš„ã«<code>TreeView::render()</code>ã§å®Ÿéš›ã®directoryæ§‹é€ ãŒrenderingã•ã‚Œã¾ã™ã€‚<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=rust><span class=giallo-l><span style=color:#81a1c1>impl</span><span style=color:#eceff4>&lt;</span><span style=color:#8fbcbb>T</span><span style=color:#81a1c1>:</span><span style=color:#8fbcbb> TreeViewItem</span><span style=color:#81a1c1> +</span><span style=color:#8fbcbb> Clone</span><span style=color:#eceff4>></span><span style=color:#8fbcbb> TreeView</span><span style=color:#eceff4>&lt;</span><span style=color:#8fbcbb>T</span><span style=color:#eceff4>> {</span></span>
<span class=giallo-l><span style=color:#81a1c1>    pub fn</span><span style=color:#88c0d0> render</span><span style=color:#eceff4>(</span></span>
<span class=giallo-l><span style=color:#81a1c1>        &mut self</span><span style=color:#eceff4>,</span></span>
<span class=giallo-l><span>        area</span><span style=color:#81a1c1>:</span><span style=color:#8fbcbb> Rect</span><span style=color:#eceff4>,</span><span style=color:#616e88> // list_area</span></span>
<span class=giallo-l><span>        prompt_area</span><span style=color:#81a1c1>:</span><span style=color:#8fbcbb> Rect</span><span style=color:#eceff4>,</span></span>
<span class=giallo-l><span>        surface</span><span style=color:#81a1c1>: &mut</span><span style=color:#8fbcbb> Surface</span><span style=color:#eceff4>,</span></span>
<span class=giallo-l><span>        cx</span><span style=color:#81a1c1>: &mut</span><span style=color:#8fbcbb> Context</span><span style=color:#eceff4>,</span></span>
<span class=giallo-l><span style=color:#eceff4>    ) {</span></span>
<span class=giallo-l><span style=color:#81a1c1>        let</span><span> style</span><span style=color:#81a1c1> =</span><span> cx</span><span style=color:#81a1c1>.</span><span>editor</span><span style=color:#81a1c1>.</span><span>theme</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>get</span><span style=color:#eceff4>("</span><span style=color:#a3be8c>ui.text</span><span style=color:#eceff4>");</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#81a1c1>        let</span><span> ancestor_style</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#616e88>          // ...</span></span>
<span class=giallo-l><span style=color:#eceff4>        };</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#616e88>        // ã“ã“ã§filesystemã‹ã‚‰directory entryã‚’å–å¾—ã—ã€é¸æŠã•ã‚Œã¦ã„ã‚‹ç­‰ã®çŠ¶æ…‹ã‚’åŠ å‘³ã—ã¦</span></span>
<span class=giallo-l><span style=color:#616e88>        // è¡¨ç¤ºã™ã¹ãentryã‚’ç”Ÿæˆã—ã¾ã™ã€‚</span></span>
<span class=giallo-l><span style=color:#81a1c1>        let</span><span> iter</span><span style=color:#81a1c1> = self.</span><span style=color:#88c0d0>render_lines</span><span style=color:#eceff4>(</span><span>area</span><span style=color:#eceff4>)</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>into_iter</span><span style=color:#eceff4>()</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>enumerate</span><span style=color:#eceff4>();</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#81a1c1>        for</span><span style=color:#eceff4> (</span><span>index</span><span style=color:#eceff4>,</span><span> line</span><span style=color:#eceff4>)</span><span style=color:#81a1c1> in</span><span> iter</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#616e88>            // 1 entryã”ã¨ã«æç”»ã™ã‚‹ã®ã§ã€yè»¸ã‚’iterationæ¯ã«åŠ ç®—ã—ã¦ã„ã¾ã™</span></span>
<span class=giallo-l><span style=color:#81a1c1>            let</span><span> area</span><span style=color:#81a1c1> =</span><span style=color:#8fbcbb> Rect</span><span style=color:#81a1c1>::</span><span style=color:#88c0d0>new</span><span style=color:#eceff4>(</span><span>area</span><span style=color:#81a1c1>.</span><span>x</span><span style=color:#eceff4>,</span><span> area</span><span style=color:#81a1c1>.</span><span>y</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>saturating_add</span><span style=color:#eceff4>(</span><span>index</span><span style=color:#81a1c1> as</span><span style=color:#8fbcbb> u16</span><span style=color:#eceff4>),</span><span> area</span><span style=color:#81a1c1>.</span><span>width</span><span style=color:#eceff4>,</span><span style=color:#b48ead> 1</span><span style=color:#eceff4>);</span></span>
<span class=giallo-l><span style=color:#81a1c1>            let</span><span> indent_len</span><span style=color:#81a1c1> =</span><span> line</span><span style=color:#81a1c1>.</span><span>indent</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>chars</span><span style=color:#eceff4>()</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>count</span><span style=color:#eceff4>()</span><span style=color:#81a1c1> as</span><span style=color:#8fbcbb> u16</span><span style=color:#eceff4>;</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#616e88>            // directoryéšå±¤ã‚’è¡¨ç¾ã™ã‚‹ãŸã‚ã®indentã‚’æç”»</span></span>
<span class=giallo-l><span style=color:#616e88>            // set_stringn()ã¯æ–‡å­—åˆ—æç”»ç”¨ã®helper</span></span>
<span class=giallo-l><span>            surface</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>set_stringn</span><span style=color:#eceff4>(</span></span>
<span class=giallo-l><span>                area</span><span style=color:#81a1c1>.</span><span>x</span><span style=color:#eceff4>,</span></span>
<span class=giallo-l><span>                area</span><span style=color:#81a1c1>.</span><span>y</span><span style=color:#eceff4>,</span></span>
<span class=giallo-l><span>                line</span><span style=color:#81a1c1>.</span><span>indent</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>as_str</span><span style=color:#eceff4>(),</span></span>
<span class=giallo-l><span>                indent_len</span><span style=color:#81a1c1> as</span><span style=color:#8fbcbb> usize</span><span style=color:#eceff4>,</span></span>
<span class=giallo-l><span>                style</span><span style=color:#eceff4>,</span></span>
<span class=giallo-l><span style=color:#eceff4>            );</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#616e88>            // é¸æŠçŠ¶æ…‹ã‚’è¡¨ç¾ã™ã‚‹ãŸã‚ã®style</span></span>
<span class=giallo-l><span style=color:#81a1c1>            let</span><span> style</span><span style=color:#81a1c1> = if</span><span> line</span><span style=color:#81a1c1>.</span><span>selected </span><span style=color:#eceff4>{</span></span>
<span class=giallo-l><span>                style</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>add_modifier</span><span style=color:#eceff4>(</span><span>Modifier</span><span style=color:#81a1c1>::</span><span>REVERSED</span><span style=color:#eceff4>)</span></span>
<span class=giallo-l><span style=color:#eceff4>            }</span><span style=color:#81a1c1> else</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span>                style</span></span>
<span class=giallo-l><span style=color:#eceff4>            };</span></span>
<span class=giallo-l><span style=color:#616e88>            // indentã¯æç”»ã—ãŸã®ã§xè»¸ã‚’èª¿æ•´</span></span>
<span class=giallo-l><span style=color:#81a1c1>            let</span><span> x</span><span style=color:#81a1c1> =</span><span> area</span><span style=color:#81a1c1>.</span><span>x</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>saturating_add</span><span style=color:#eceff4>(</span><span>indent_len</span><span style=color:#eceff4>);</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#616e88>            // directory entryã‚’æç”»</span></span>
<span class=giallo-l><span>            surface</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>set_stringn</span><span style=color:#eceff4>(</span></span>
<span class=giallo-l><span>                x</span><span style=color:#eceff4>,</span></span>
<span class=giallo-l><span>                area</span><span style=color:#81a1c1>.</span><span>y</span><span style=color:#eceff4>,</span></span>
<span class=giallo-l><span>                line</span><span style=color:#81a1c1>.</span><span>content</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>as_str</span><span style=color:#eceff4>(),</span></span>
<span class=giallo-l><span style=color:#616e88>                // fileåãŒæç”»é ˜åŸŸã‚’ã¯ã¿å‡ºã•ãªã„ã‚ˆã†ã«èª¿æ•´</span></span>
<span class=giallo-l><span>                area</span><span style=color:#81a1c1>.</span><span>width</span></span>
<span class=giallo-l><span style=color:#81a1c1>                    .</span><span style=color:#88c0d0>saturating_sub</span><span style=color:#eceff4>(</span><span>indent_len</span><span style=color:#eceff4>)</span></span>
<span class=giallo-l><span style=color:#81a1c1>                    .</span><span style=color:#88c0d0>saturating_sub</span><span style=color:#eceff4>(</span><span style=color:#b48ead>1</span><span style=color:#eceff4>)</span></span>
<span class=giallo-l><span style=color:#81a1c1>                    .</span><span style=color:#88c0d0>into</span><span style=color:#eceff4>(),</span></span>
<span class=giallo-l><span style=color:#81a1c1>                if</span><span> line</span><span style=color:#81a1c1>.</span><span>is_ancestor_of_current_item </span><span style=color:#eceff4>{</span></span>
<span class=giallo-l><span>                    ancestor_style</span></span>
<span class=giallo-l><span style=color:#eceff4>                }</span><span style=color:#81a1c1> else</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span>                    style</span></span>
<span class=giallo-l><span style=color:#eceff4>                },</span></span>
<span class=giallo-l><span style=color:#eceff4>            );</span></span>
<span class=giallo-l><span style=color:#eceff4>        }</span></span>
<span class=giallo-l><span style=color:#eceff4>    }</span></span>
<span class=giallo-l><span style=color:#eceff4>}</span></span></code></pre><p>ã“ã‚Œã§ã¤ã„ã«directoryæ§‹é€ ãŒæç”»ã§ãã¾ã—ãŸã€‚<br> <code>surface.set_stringn()</code>ã«fileã®ç¨®åˆ¥ã«å¿œã˜ãŸiconã‚’æ¸¡ã›ã°ã€ã‚ˆã‚Šä¸€èˆ¬çš„ãªfile explorerã«è¿‘ã¥ããã†ã§ã™ã€‚<br> ã‚„ã£ã¦ã¿ã‚ˆã†ã‹ã¨ã‚‚æ€ã£ãŸã®ã§ã™ãŒã€<a href=https://github.com/helix-editor/helix rel=external>Helix</a>æœ¬ä½“ã§<a href=https://github.com/helix-editor/helix/pull/2869 rel=external>iconã®ç®¡ç†æ–¹æ³•</a>ãŒè­°è«–ã•ã‚Œã¦ã„ã‚‹ã®ã§ã€ãã‚Œã‚’å¾…ã£ã¦ã‹ã‚‰ã«ã™ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚<h2 id=yi-dong><a aria-label="Anchor link for: yi-dong" class=zola-anchor href=#yi-dong>ç§»å‹•</a></h2><p>Directoryæ§‹é€ ã‚’æç”»ã§ããŸã®ã§ã€æ¬¡ã¯file explorerä¸Šã§ã®ç§»å‹•ã‚’å®Ÿè£…ã—ã¾ã™ã€‚<br> åŸºæœ¬çš„ã«ã¯ã€userãŒfile explorerã‚’focusã—ã¦ã„ã‚‹ã‹ã‚’ç®¡ç†ã—ã¦ã€focusã—ã¦ã„ã‚‹å ´åˆã¯<code>j</code>ãŒæŠ¼ã•ã‚ŒãŸã‚‰ç¾åœ¨ã®file explorerä¸Šã®é¸æŠã‚’ä¸‹ã«ä¸€ã¤ç§»å‹•ã•ã›ã‚‹ã€‚ã¨ã„ã†ã‚ˆã†ãªå‡¦ç†ã‚’è¿½åŠ ã—ã¾ã™ã€‚<p>ã¾ãšã¯å…ˆã»ã©ã¨åŒæ§˜ã«<code>EditorView</code>ã‹ã‚‰ã§ã™ã€‚<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=rust><span class=giallo-l><span style=color:#81a1c1>impl</span><span style=color:#8fbcbb> Component</span><span style=color:#81a1c1> for</span><span style=color:#8fbcbb> EditorView</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#81a1c1>    fn</span><span style=color:#88c0d0> handle_event</span><span style=color:#eceff4>(</span></span>
<span class=giallo-l><span style=color:#81a1c1>        &mut self</span><span style=color:#eceff4>,</span></span>
<span class=giallo-l><span>        event</span><span style=color:#81a1c1>: &</span><span style=color:#8fbcbb>Event</span><span style=color:#eceff4>,</span></span>
<span class=giallo-l><span>        context</span><span style=color:#81a1c1>: &mut crate::</span><span>compositor</span><span style=color:#81a1c1>::</span><span style=color:#8fbcbb>Context</span><span style=color:#eceff4>,</span></span>
<span class=giallo-l><span style=color:#eceff4>    )</span><span style=color:#81a1c1> -></span><span style=color:#8fbcbb> EventResult</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#81a1c1>        if let</span><span style=color:#8fbcbb> Some</span><span style=color:#eceff4>(</span><span>explorer</span><span style=color:#eceff4>)</span><span style=color:#81a1c1> = self.</span><span>explorer</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>as_mut</span><span style=color:#eceff4>() {</span></span>
<span class=giallo-l><span style=color:#81a1c1>            if let</span><span style=color:#8fbcbb> EventResult</span><span style=color:#81a1c1>::</span><span style=color:#88c0d0>Consumed</span><span style=color:#eceff4>(</span><span>callback</span><span style=color:#eceff4>)</span><span style=color:#81a1c1> =</span><span> explorer</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>handle_event</span><span style=color:#eceff4>(</span><span>event</span><span style=color:#eceff4>,</span><span> context</span><span style=color:#eceff4>) {</span></span>
<span class=giallo-l><span style=color:#81a1c1>                return</span><span style=color:#8fbcbb> EventResult</span><span style=color:#81a1c1>::</span><span style=color:#88c0d0>Consumed</span><span style=color:#eceff4>(</span><span>callback</span><span style=color:#eceff4>);</span></span>
<span class=giallo-l><span style=color:#eceff4>            }</span></span>
<span class=giallo-l><span style=color:#eceff4>        }</span></span>
<span class=giallo-l><span style=color:#616e88>        // ...</span></span>
<span class=giallo-l><span style=color:#eceff4>    }</span></span>
<span class=giallo-l><span style=color:#eceff4>}</span></span></code></pre><p>ã¨ã‚Šã‚ãˆãšé›‘ã«eventã‚’<code>Explorer</code>ã«æ¸¡ã—ã¦ã„ã¾ã™ã€‚<br> EventãŒå‡¦ç†ã§ããŸã‚‰ã€<code>EventResult::Consumed()</code>ã§ãã‚Œã‚’è¡¨ç¾ã—ã¾ã™ã€‚eventãŒconsumeã•ã‚ŒãŸå ´åˆã¯ã€<code>EditorView</code>ã¨ã—ã¦ã¯ãã“ã§event handlingã‚’çµ‚äº†ã—ã¾ã™ã€‚<br> Pluginæ©Ÿæ§‹ãŒãªã„ãŸã‚ã€å„ç¨®å‡¦ç†ã«hookã‚’ã¯ã•ã‚ãªã„ã®ã§ã€event handlingã®å…ˆé ­ã«ifã‚’è¿½åŠ ã™ã‚‹ã¨ã„ã†åŠ›æŠ€ã§ã™ã€‚<p>ç§»å‹•ã¯<code>TreeView::handle_event()</code>ã§å‡¦ç†ã•ã‚Œã¾ã™ã€‚<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=rust><span class=giallo-l><span style=color:#81a1c1>impl</span><span style=color:#eceff4>&lt;</span><span style=color:#8fbcbb>T</span><span style=color:#81a1c1>:</span><span style=color:#8fbcbb> TreeViewItem</span><span style=color:#81a1c1> +</span><span style=color:#8fbcbb> Clone</span><span style=color:#eceff4>></span><span style=color:#8fbcbb> TreeView</span><span style=color:#eceff4>&lt;</span><span style=color:#8fbcbb>T</span><span style=color:#eceff4>> {</span></span>
<span class=giallo-l><span style=color:#81a1c1>    pub fn</span><span style=color:#88c0d0> handle_event</span><span style=color:#eceff4>(</span></span>
<span class=giallo-l><span style=color:#81a1c1>        &mut self</span><span style=color:#eceff4>,</span></span>
<span class=giallo-l><span>        event</span><span style=color:#81a1c1>: &</span><span style=color:#8fbcbb>Event</span><span style=color:#eceff4>,</span></span>
<span class=giallo-l><span>        cx</span><span style=color:#81a1c1>: &mut</span><span style=color:#8fbcbb> Context</span><span style=color:#eceff4>,</span></span>
<span class=giallo-l><span>        params</span><span style=color:#81a1c1>: &mut</span><span> T</span><span style=color:#81a1c1>::</span><span style=color:#8fbcbb>Params</span><span style=color:#eceff4>,</span></span>
<span class=giallo-l><span style=color:#eceff4>    )</span><span style=color:#81a1c1> -></span><span style=color:#8fbcbb> EventResult</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#81a1c1>        let</span><span> key_event</span><span style=color:#81a1c1> = match</span><span> event</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#8fbcbb>            Event</span><span style=color:#81a1c1>::</span><span style=color:#88c0d0>Key</span><span style=color:#eceff4>(</span><span>event</span><span style=color:#eceff4>)</span><span style=color:#81a1c1> =></span><span> event</span><span style=color:#eceff4>,</span></span>
<span class=giallo-l><span>            _</span><span style=color:#81a1c1> => return</span><span style=color:#8fbcbb> EventResult</span><span style=color:#81a1c1>::</span><span style=color:#88c0d0>Ignored</span><span style=color:#eceff4>(</span><span style=color:#8fbcbb>None</span><span style=color:#eceff4>),</span></span>
<span class=giallo-l><span style=color:#eceff4>        };</span></span>
<span class=giallo-l><span style=color:#eceff4>        (</span><span style=color:#81a1c1>|| -></span><span style=color:#8fbcbb> Result</span><span style=color:#eceff4>&lt;</span><span style=color:#8fbcbb>EventResult</span><span style=color:#eceff4>> {</span></span>
<span class=giallo-l><span style=color:#81a1c1>            match</span><span> key_event</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#88c0d0;font-weight:700>                key!</span><span style=color:#eceff4>('</span><span style=color:#a3be8c>j</span><span style=color:#eceff4>')</span><span style=color:#81a1c1> => self.</span><span style=color:#88c0d0>move_down</span><span style=color:#eceff4>(</span><span style=color:#b48ead>1</span><span style=color:#eceff4>),</span></span>
<span class=giallo-l><span style=color:#88c0d0;font-weight:700>                key!</span><span style=color:#eceff4>('</span><span style=color:#a3be8c>k</span><span style=color:#eceff4>')</span><span style=color:#81a1c1> => self.</span><span style=color:#88c0d0>move_up</span><span style=color:#eceff4>(</span><span style=color:#b48ead>1</span><span style=color:#eceff4>),</span></span>
<span class=giallo-l><span style=color:#88c0d0;font-weight:700>                key!</span><span style=color:#eceff4>(</span><span style=color:#8fbcbb>Enter</span><span style=color:#eceff4>)</span><span style=color:#81a1c1> => self.</span><span style=color:#88c0d0>on_enter</span><span style=color:#eceff4>(</span><span>cx</span><span style=color:#eceff4>,</span><span> params</span><span style=color:#eceff4>,</span><span style=color:#81a1c1> self.</span><span>selected</span><span style=color:#eceff4>)</span><span style=color:#81a1c1>?</span><span style=color:#eceff4>,</span></span>
<span class=giallo-l><span style=color:#616e88>                // ...</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span>                _</span><span style=color:#81a1c1> => return</span><span style=color:#8fbcbb> Ok</span><span style=color:#eceff4>(</span><span style=color:#8fbcbb>EventResult</span><span style=color:#81a1c1>::</span><span style=color:#88c0d0>Ignored</span><span style=color:#eceff4>(</span><span style=color:#8fbcbb>None</span><span style=color:#eceff4>)),</span></span>
<span class=giallo-l><span style=color:#eceff4>            };</span></span>
<span class=giallo-l><span style=color:#8fbcbb>            Ok</span><span style=color:#eceff4>(</span><span style=color:#8fbcbb>EventResult</span><span style=color:#81a1c1>::</span><span style=color:#88c0d0>Consumed</span><span style=color:#eceff4>(</span><span style=color:#8fbcbb>None</span><span style=color:#eceff4>))</span></span>
<span class=giallo-l><span style=color:#eceff4>        })()</span></span>
<span class=giallo-l><span style=color:#81a1c1>        .</span><span style=color:#88c0d0>unwrap_or_else</span><span style=color:#eceff4>(</span><span style=color:#81a1c1>|</span><span>err</span><span style=color:#81a1c1>|</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span>            cx</span><span style=color:#81a1c1>.</span><span>editor</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>set_error</span><span style=color:#eceff4>(</span><span style=color:#88c0d0;font-weight:700>format!</span><span style=color:#eceff4>("</span><span style=color:#ebcb8b>{</span><span style=color:#a3be8c>err</span><span style=color:#ebcb8b>}</span><span style=color:#eceff4>"));</span></span>
<span class=giallo-l><span style=color:#8fbcbb>            EventResult</span><span style=color:#81a1c1>::</span><span style=color:#88c0d0>Consumed</span><span style=color:#eceff4>(</span><span style=color:#8fbcbb>None</span><span style=color:#eceff4>)</span></span>
<span class=giallo-l><span style=color:#eceff4>        })</span></span>
<span class=giallo-l><span style=color:#eceff4>    }</span></span>
<span class=giallo-l><span style=color:#81a1c1>    fn</span><span style=color:#88c0d0> move_up</span><span style=color:#eceff4>(</span><span style=color:#81a1c1>&mut self</span><span style=color:#eceff4>,</span><span> rows</span><span style=color:#81a1c1>:</span><span style=color:#8fbcbb> usize</span><span style=color:#eceff4>) {</span></span>
<span class=giallo-l><span style=color:#81a1c1>        self.</span><span style=color:#88c0d0>set_selected</span><span style=color:#eceff4>(</span><span style=color:#81a1c1>self.</span><span>selected</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>saturating_sub</span><span style=color:#eceff4>(</span><span>rows</span><span style=color:#eceff4>))</span></span>
<span class=giallo-l><span style=color:#eceff4>    }</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#81a1c1>    fn</span><span style=color:#88c0d0> move_down</span><span style=color:#eceff4>(</span><span style=color:#81a1c1>&mut self</span><span style=color:#eceff4>,</span><span> rows</span><span style=color:#81a1c1>:</span><span style=color:#8fbcbb> usize</span><span style=color:#eceff4>) {</span></span>
<span class=giallo-l><span style=color:#81a1c1>        self.</span><span style=color:#88c0d0>set_selected</span><span style=color:#eceff4>(</span><span style=color:#81a1c1>self.</span><span>selected</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>saturating_add</span><span style=color:#eceff4>(</span><span>rows</span><span style=color:#eceff4>))</span></span>
<span class=giallo-l><span style=color:#eceff4>    }</span></span>
<span class=giallo-l><span style=color:#eceff4>}</span></span></code></pre><p>ã“ã“ã§ç§»å‹•ã«å¯¾å¿œã™ã‚‹key(<code>j</code>|<code>k</code>)ã ã£ãŸå ´åˆã¯è‡ªèº«ã®çŠ¶æ…‹ã‚’æ›´æ–°ã—ã¾ã™ã€‚<br> ç¾åœ¨é¸æŠä¸­ã®entryã¯<code>TreeView.selected</code>ã§ä¿æŒã—ã¦ã„ã¾ã™ã€‚<br> keyã‚’hard codeã—ãªã„ã§è¨­å®šã‹ã‚‰å‹•çš„ã«å–å¾—ã—ã¦ã‚‚ã‚ˆã„ã®ã§ã™ãŒã€è‡ªåˆ†å°‚ç”¨ãªã®ã§ã§ãã‚‹ã ã‘ãƒ¡ãƒ³ãƒ†ã™ã‚‹codeã‚’æ¸›ã‚‰ãã†ã¨ã—ã¦ã„ã¾ã™ã€‚<p><code>Enter</code>ãŒæŠ¼ã•ã‚ŒãŸå ´åˆã¯<code>TreeView::on_enter()</code>ã§editorã«å½“è©²fileãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚<br> èµ·å‹•ä¸­ã®helixã«å¤–ã‹ã‚‰ç‰¹å®šã®fileã‚’é–‹ã‹ã›ã‚‹APIã¯ç¾çŠ¶ãªã„ã®ã§ã€<code>Editor::open()</code>ã‚’ç›´æ¥ã‚ˆã³ã ã›ã‚‹code levelã®çµ±åˆã«ãƒ¡ãƒªãƒƒãƒˆãŒã‚ã‚Šã¾ã™ã€‚<h2 id=filenobian-geng><a aria-label="Anchor link for: filenobian-geng" class=zola-anchor href=#filenobian-geng>Fileã®å¤‰æ›´</a></h2><p>æœ€å¾Œã«file explorerã‹ã‚‰fileã‚’create, delete, renameã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=rust><span class=giallo-l><span style=color:#81a1c1>impl</span><span style=color:#8fbcbb> Component</span><span style=color:#81a1c1> for</span><span style=color:#8fbcbb> Explorer</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#81a1c1>    fn</span><span style=color:#88c0d0> handle_event</span><span style=color:#eceff4>(</span><span style=color:#81a1c1>&mut self</span><span style=color:#eceff4>,</span><span> event</span><span style=color:#81a1c1>: &</span><span style=color:#8fbcbb>Event</span><span style=color:#eceff4>,</span><span> cx</span><span style=color:#81a1c1>: &mut</span><span style=color:#8fbcbb> Context</span><span style=color:#eceff4>)</span><span style=color:#81a1c1> -></span><span style=color:#8fbcbb> EventResult</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#616e88>        // keyå…¥åŠ›ã«ã ã‘é–¢å¿ƒãŒã‚ã‚‹</span></span>
<span class=giallo-l><span style=color:#81a1c1>        let</span><span> key_event</span><span style=color:#81a1c1> = match</span><span> event</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#8fbcbb>            Event</span><span style=color:#81a1c1>::</span><span style=color:#88c0d0>Key</span><span style=color:#eceff4>(</span><span>event</span><span style=color:#eceff4>)</span><span style=color:#81a1c1> =></span><span> event</span><span style=color:#eceff4>,</span></span>
<span class=giallo-l><span>            _</span><span style=color:#81a1c1> => return</span><span style=color:#8fbcbb> EventResult</span><span style=color:#81a1c1>::</span><span style=color:#88c0d0>Ignored</span><span style=color:#eceff4>(</span><span style=color:#8fbcbb>None</span><span style=color:#eceff4>),</span></span>
<span class=giallo-l><span style=color:#eceff4>        };</span></span>
<span class=giallo-l><span style=color:#616e88>        // focusã•ã‚Œã¦ã„ãªã„å ´åˆã¯editorå´ã®æ“ä½œã§ã‚ã‚‹ã¨ã—ã€early returnã™ã‚‹</span></span>
<span class=giallo-l><span style=color:#81a1c1>        if !self.</span><span style=color:#88c0d0>is_focus</span><span style=color:#eceff4>() {</span></span>
<span class=giallo-l><span style=color:#81a1c1>            return</span><span style=color:#8fbcbb> EventResult</span><span style=color:#81a1c1>::</span><span style=color:#88c0d0>Ignored</span><span style=color:#eceff4>(</span><span style=color:#8fbcbb>None</span><span style=color:#eceff4>);</span></span>
<span class=giallo-l><span style=color:#eceff4>        }</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#616e88>        // fileä½œæˆæ™‚ã¯ä½œæˆã—ãŸã„fileåã‚’å…¥åŠ›ã—ã¦ã‚‚ã‚‰ã†å¿…è¦ãŒã‚ã‚‹ã®ã§</span></span>
<span class=giallo-l><span style=color:#616e88>        // userã®å…¥åŠ›ã‚’promptã«æ¸¡ã™å¿…è¦ãŒã‚ã‚‹</span></span>
<span class=giallo-l><span style=color:#616e88>        // handle delete | rename prompt</span></span>
<span class=giallo-l><span style=color:#81a1c1>        if let</span><span style=color:#8fbcbb> EventResult</span><span style=color:#81a1c1>::</span><span style=color:#88c0d0>Consumed</span><span style=color:#eceff4>(</span><span>c</span><span style=color:#eceff4>)</span><span style=color:#81a1c1> = self.</span><span style=color:#88c0d0>handle_prompt_event</span><span style=color:#eceff4>(</span><span>key_event</span><span style=color:#eceff4>,</span><span> cx</span><span style=color:#eceff4>) {</span></span>
<span class=giallo-l><span style=color:#81a1c1>            return</span><span style=color:#8fbcbb> EventResult</span><span style=color:#81a1c1>::</span><span style=color:#88c0d0>Consumed</span><span style=color:#eceff4>(</span><span>c</span><span style=color:#eceff4>);</span></span>
<span class=giallo-l><span style=color:#eceff4>        }</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#eceff4>        (</span><span style=color:#81a1c1>|| -></span><span style=color:#8fbcbb> Result</span><span style=color:#eceff4>&lt;()> {</span></span>
<span class=giallo-l><span style=color:#81a1c1>            match</span><span> key_event</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#88c0d0;font-weight:700>                key!</span><span style=color:#eceff4>(</span><span style=color:#8fbcbb>Esc</span><span style=color:#eceff4>)</span><span style=color:#81a1c1> => self.</span><span style=color:#88c0d0>unfocus</span><span style=color:#eceff4>(),</span></span>
<span class=giallo-l><span style=color:#88c0d0;font-weight:700>                key!</span><span style=color:#eceff4>('</span><span style=color:#a3be8c>q</span><span style=color:#eceff4>')</span><span style=color:#81a1c1> => self.</span><span style=color:#88c0d0>close</span><span style=color:#eceff4>(),</span></span>
<span class=giallo-l><span style=color:#88c0d0;font-weight:700>                key!</span><span style=color:#eceff4>('</span><span style=color:#a3be8c>a</span><span style=color:#eceff4>')</span><span style=color:#81a1c1> => self.</span><span style=color:#88c0d0>new_create_file_or_directory_prompt</span><span style=color:#eceff4>(</span><span>cx</span><span style=color:#eceff4>)</span><span style=color:#81a1c1>?</span><span style=color:#eceff4>,</span></span>
<span class=giallo-l><span style=color:#88c0d0;font-weight:700>                key!</span><span style=color:#eceff4>('</span><span style=color:#a3be8c>d</span><span style=color:#eceff4>')</span><span style=color:#81a1c1> => self.</span><span style=color:#88c0d0>new_remove_prompt</span><span style=color:#eceff4>()</span><span style=color:#81a1c1>?</span><span style=color:#eceff4>,</span></span>
<span class=giallo-l><span style=color:#88c0d0;font-weight:700>                key!</span><span style=color:#eceff4>('</span><span style=color:#a3be8c>r</span><span style=color:#eceff4>')</span><span style=color:#81a1c1> => self.</span><span style=color:#88c0d0>new_rename_prompt</span><span style=color:#eceff4>(</span><span>cx</span><span style=color:#eceff4>)</span><span style=color:#81a1c1>?</span><span style=color:#eceff4>,</span></span>
<span class=giallo-l><span>                _</span><span style=color:#81a1c1> =></span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#81a1c1>                    self.</span><span>tree</span></span>
<span class=giallo-l><span style=color:#81a1c1>                        .</span><span style=color:#88c0d0>handle_event</span><span style=color:#eceff4>(</span><span style=color:#81a1c1>&</span><span>Event</span><span style=color:#81a1c1>::</span><span style=color:#88c0d0>Key</span><span style=color:#eceff4>(</span><span style=color:#81a1c1>*</span><span>key_event</span><span style=color:#eceff4>),</span><span> cx</span><span style=color:#eceff4>,</span><span style=color:#81a1c1> &mut self.</span><span>state</span><span style=color:#eceff4>);</span></span>
<span class=giallo-l><span style=color:#eceff4>                }</span></span>
<span class=giallo-l><span style=color:#eceff4>            };</span></span>
<span class=giallo-l><span style=color:#8fbcbb>            Ok</span><span style=color:#eceff4>(())</span></span>
<span class=giallo-l><span style=color:#eceff4>        })()</span></span>
<span class=giallo-l><span style=color:#81a1c1>        .</span><span style=color:#88c0d0>unwrap_or_else</span><span style=color:#eceff4>(</span><span style=color:#81a1c1>|</span><span>err</span><span style=color:#81a1c1>|</span><span> cx</span><span style=color:#81a1c1>.</span><span>editor</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>set_error</span><span style=color:#eceff4>(</span><span style=color:#88c0d0;font-weight:700>format!</span><span style=color:#eceff4>("</span><span style=color:#ebcb8b>{</span><span style=color:#a3be8c>err</span><span style=color:#ebcb8b>}</span><span style=color:#eceff4>")));</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#8fbcbb>        EventResult</span><span style=color:#81a1c1>::</span><span style=color:#88c0d0>Consumed</span><span style=color:#eceff4>(</span><span style=color:#8fbcbb>None</span><span style=color:#eceff4>)</span></span>
<span class=giallo-l><span style=color:#eceff4>    }</span></span>
<span class=giallo-l><span style=color:#eceff4>}</span></span></code></pre><p>ä½œæˆã¯<code>a</code>, deleteã¯<code>d</code>, renameã¯<code>r</code>ã‚’å‰²ã‚Šå½“ã¦ã¦ã„ã¾ã™ã€‚<br> ä¾‹ãˆã°ã€file explorerã‚’focusä¸­ã«<code>a</code>ã‚’æŠ¼ã™ã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ã«ä½œæˆã™ã‚‹fileã‚’å—ã‘ä»˜ã‘ã‚‹promptãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚<figure><div class=fig-images-row><img , alt src=images/helix-ss-prompt.png></div><figcaption>Prompt</figcaption></figure><pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=rust><span class=giallo-l><span style=color:#81a1c1>    fn</span><span style=color:#88c0d0> new_create_file_or_directory_prompt</span><span style=color:#eceff4>(</span><span style=color:#81a1c1>&mut self</span><span style=color:#eceff4>,</span><span> cx</span><span style=color:#81a1c1>: &mut</span><span style=color:#8fbcbb> Context</span><span style=color:#eceff4>)</span><span style=color:#81a1c1> -></span><span style=color:#8fbcbb> Result</span><span style=color:#eceff4>&lt;()> {</span></span>
<span class=giallo-l><span style=color:#81a1c1>        let</span><span> dir_path</span><span style=color:#81a1c1> = self.</span><span style=color:#88c0d0>nearest_directory</span><span style=color:#eceff4>()</span><span style=color:#81a1c1>?</span><span style=color:#eceff4>;</span></span>
<span class=giallo-l><span style=color:#81a1c1>        self.</span><span>prompt </span><span style=color:#81a1c1>=</span><span style=color:#8fbcbb> Some</span><span style=color:#eceff4>((</span></span>
<span class=giallo-l><span style=color:#8fbcbb>            PromptAction</span><span style=color:#81a1c1>::</span><span style=color:#8fbcbb>CreateFileOrDirectory</span><span style=color:#eceff4>,</span></span>
<span class=giallo-l><span style=color:#8fbcbb>            Prompt</span><span style=color:#81a1c1>::</span><span style=color:#88c0d0>new</span><span style=color:#eceff4>(</span></span>
<span class=giallo-l><span style=color:#88c0d0;font-weight:700>                format!</span><span style=color:#eceff4>(</span></span>
<span class=giallo-l><span style=color:#eceff4>                    "</span><span style=color:#a3be8c>ğŸ“ New file or directory (ends with '</span><span style=color:#ebcb8b>{}</span><span style=color:#a3be8c>') </span><span style=color:#eceff4>",</span></span>
<span class=giallo-l><span>                    std</span><span style=color:#81a1c1>::</span><span>path</span><span style=color:#81a1c1>::</span><span>MAIN_SEPARATOR</span></span>
<span class=giallo-l><span style=color:#eceff4>                )</span></span>
<span class=giallo-l><span style=color:#81a1c1>                .</span><span style=color:#88c0d0>into</span><span style=color:#eceff4>(),</span></span>
<span class=giallo-l><span style=color:#8fbcbb>                None</span><span style=color:#eceff4>,</span></span>
<span class=giallo-l><span>                ui</span><span style=color:#81a1c1>::</span><span>completers</span><span style=color:#81a1c1>::</span><span>none</span><span style=color:#eceff4>,</span></span>
<span class=giallo-l><span style=color:#81a1c1>                |</span><span>_</span><span style=color:#eceff4>,</span><span> _</span><span style=color:#eceff4>,</span><span> _</span><span style=color:#81a1c1>|</span><span style=color:#eceff4> {},</span></span>
<span class=giallo-l><span style=color:#eceff4>            )</span></span>
<span class=giallo-l><span style=color:#81a1c1>            .</span><span style=color:#88c0d0>with_line</span><span style=color:#eceff4>(</span><span style=color:#88c0d0;font-weight:700>format!</span><span style=color:#eceff4>("</span><span style=color:#ebcb8b>{}</span><span style=color:#a3be8c>/</span><span style=color:#eceff4>",</span><span> dir_path</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>display</span><span style=color:#eceff4>()),</span><span> cx</span><span style=color:#81a1c1>.</span><span>editor</span><span style=color:#eceff4>),</span></span>
<span class=giallo-l><span style=color:#eceff4>        ));</span></span>
<span class=giallo-l><span style=color:#8fbcbb>        Ok</span><span style=color:#eceff4>(())</span></span>
<span class=giallo-l><span style=color:#eceff4>    }</span></span></code></pre><p>promptã®ä½œæˆã¯è‡ªèº«ã®fieldã«<code>Prompt</code>ã¨è¦æ±‚ã•ã‚ŒãŸactionã®enumã‚’ä¿æŒã™ã‚‹ã“ã¨ã§è¡Œã„ã¾ã™ã€‚<br> promptã¯ä¸Šè¨˜ã®prompt_areaã«æç”»ã—ã¾ã™ã€‚promptä¸­ã¯<code>Explorer::handle_prompt_event()</code>ã§å…¥åŠ›ã‚’å‡¦ç†ã—ã¾ã™ã€‚<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=rust><span class=giallo-l><span style=color:#81a1c1>impl</span><span style=color:#8fbcbb> Explorer</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#81a1c1>    fn</span><span style=color:#88c0d0> handle_prompt_event</span><span style=color:#eceff4>(</span><span style=color:#81a1c1>&mut self</span><span style=color:#eceff4>,</span><span> event</span><span style=color:#81a1c1>: &</span><span style=color:#8fbcbb>KeyEvent</span><span style=color:#eceff4>,</span><span> cx</span><span style=color:#81a1c1>: &mut</span><span style=color:#8fbcbb> Context</span><span style=color:#eceff4>)</span><span style=color:#81a1c1> -></span><span style=color:#8fbcbb> EventResult</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#81a1c1>        let</span><span> result</span><span style=color:#81a1c1> =</span><span style=color:#eceff4> (</span><span style=color:#81a1c1>|| -></span><span style=color:#8fbcbb> Result</span><span style=color:#eceff4>&lt;</span><span style=color:#8fbcbb>EventResult</span><span style=color:#eceff4>> {</span></span>
<span class=giallo-l><span style=color:#81a1c1>            let</span><span style=color:#eceff4> (</span><span>action</span><span style=color:#eceff4>,</span><span style=color:#81a1c1> mut</span><span> prompt</span><span style=color:#eceff4>)</span><span style=color:#81a1c1> = match self.</span><span>prompt</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>take</span><span style=color:#eceff4>() {</span></span>
<span class=giallo-l><span style=color:#8fbcbb>                Some</span><span style=color:#eceff4>((</span><span>action</span><span style=color:#eceff4>,</span><span> p</span><span style=color:#eceff4>))</span><span style=color:#81a1c1> =></span><span style=color:#eceff4> (</span><span>action</span><span style=color:#eceff4>,</span><span> p</span><span style=color:#eceff4>),</span></span>
<span class=giallo-l><span>                _</span><span style=color:#81a1c1> => return</span><span style=color:#8fbcbb> Ok</span><span style=color:#eceff4>(</span><span style=color:#8fbcbb>EventResult</span><span style=color:#81a1c1>::</span><span style=color:#88c0d0>Ignored</span><span style=color:#eceff4>(</span><span style=color:#8fbcbb>None</span><span style=color:#eceff4>)),</span></span>
<span class=giallo-l><span style=color:#eceff4>            };</span></span>
<span class=giallo-l><span style=color:#81a1c1>            let</span><span> line</span><span style=color:#81a1c1> =</span><span> prompt</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>line</span><span style=color:#eceff4>();</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span style=color:#81a1c1>            let</span><span> current_item_path</span><span style=color:#81a1c1> = self.</span><span>tree</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>current</span><span style=color:#eceff4>()</span><span style=color:#81a1c1>?.</span><span style=color:#88c0d0>item</span><span style=color:#eceff4>()</span><span style=color:#81a1c1>.</span><span>path</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>clone</span><span style=color:#eceff4>();</span></span>
<span class=giallo-l><span style=color:#81a1c1>            match</span><span style=color:#eceff4> (</span><span style=color:#81a1c1>&</span><span>action</span><span style=color:#eceff4>,</span><span> event</span><span style=color:#eceff4>) {</span></span>
<span class=giallo-l><span style=color:#eceff4>                (</span><span style=color:#8fbcbb>PromptAction</span><span style=color:#81a1c1>::</span><span style=color:#8fbcbb>CreateFileOrDirectory</span><span style=color:#eceff4>,</span><span style=color:#88c0d0;font-weight:700> key!</span><span style=color:#eceff4>(</span><span style=color:#8fbcbb>Enter</span><span style=color:#eceff4>))</span><span style=color:#81a1c1> =></span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#81a1c1>                    if</span><span> line</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>ends_with</span><span style=color:#eceff4>(</span><span>std</span><span style=color:#81a1c1>::</span><span>path</span><span style=color:#81a1c1>::</span><span>MAIN_SEPARATOR</span><span style=color:#eceff4>) {</span></span>
<span class=giallo-l><span style=color:#81a1c1>                        self.</span><span style=color:#88c0d0>new_directory</span><span style=color:#eceff4>(</span><span>line</span><span style=color:#eceff4>)</span><span style=color:#81a1c1>?</span></span>
<span class=giallo-l><span style=color:#eceff4>                    }</span><span style=color:#81a1c1> else</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#81a1c1>                        self.</span><span style=color:#88c0d0>new_file</span><span style=color:#eceff4>(</span><span>line</span><span style=color:#eceff4>)</span><span style=color:#81a1c1>?</span></span>
<span class=giallo-l><span style=color:#eceff4>                    }</span></span>
<span class=giallo-l><span style=color:#eceff4>                }</span></span>
<span class=giallo-l><span style=color:#eceff4>                (</span><span style=color:#8fbcbb>PromptAction</span><span style=color:#81a1c1>::</span><span style=color:#8fbcbb>RemoveDirectory</span><span style=color:#eceff4>,</span><span> key</span><span style=color:#eceff4>)</span><span style=color:#81a1c1> =></span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#81a1c1>                    if let</span><span style=color:#88c0d0;font-weight:700> key!</span><span style=color:#eceff4>('</span><span style=color:#a3be8c>y</span><span style=color:#eceff4>')</span><span style=color:#81a1c1> =</span><span> key</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#88c0d0>                        close_documents</span><span style=color:#eceff4>(</span><span>current_item_path</span><span style=color:#eceff4>,</span><span> cx</span><span style=color:#eceff4>)</span><span style=color:#81a1c1>?</span><span style=color:#eceff4>;</span></span>
<span class=giallo-l><span style=color:#81a1c1>                        self.</span><span style=color:#88c0d0>remove_directory</span><span style=color:#eceff4>()</span><span style=color:#81a1c1>?</span><span style=color:#eceff4>;</span></span>
<span class=giallo-l><span style=color:#eceff4>                    }</span></span>
<span class=giallo-l><span style=color:#eceff4>                }</span></span>
<span class=giallo-l><span style=color:#eceff4>                (</span><span style=color:#8fbcbb>PromptAction</span><span style=color:#81a1c1>::</span><span style=color:#8fbcbb>RemoveFile</span><span style=color:#eceff4>,</span><span> key</span><span style=color:#eceff4>)</span><span style=color:#81a1c1> =></span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#81a1c1>                    if let</span><span style=color:#88c0d0;font-weight:700> key!</span><span style=color:#eceff4>('</span><span style=color:#a3be8c>y</span><span style=color:#eceff4>')</span><span style=color:#81a1c1> =</span><span> key</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#88c0d0>                        close_documents</span><span style=color:#eceff4>(</span><span>current_item_path</span><span style=color:#eceff4>,</span><span> cx</span><span style=color:#eceff4>)</span><span style=color:#81a1c1>?</span><span style=color:#eceff4>;</span></span>
<span class=giallo-l><span style=color:#81a1c1>                        self.</span><span style=color:#88c0d0>remove_file</span><span style=color:#eceff4>()</span><span style=color:#81a1c1>?</span><span style=color:#eceff4>;</span></span>
<span class=giallo-l><span style=color:#eceff4>                    }</span></span>
<span class=giallo-l><span style=color:#eceff4>                }</span></span>
<span class=giallo-l><span style=color:#eceff4>                (</span><span style=color:#8fbcbb>PromptAction</span><span style=color:#81a1c1>::</span><span style=color:#8fbcbb>RenameFile</span><span style=color:#eceff4>,</span><span style=color:#88c0d0;font-weight:700> key!</span><span style=color:#eceff4>(</span><span style=color:#8fbcbb>Enter</span><span style=color:#eceff4>))</span><span style=color:#81a1c1> =></span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#88c0d0>                    close_documents</span><span style=color:#eceff4>(</span><span>current_item_path</span><span style=color:#eceff4>,</span><span> cx</span><span style=color:#eceff4>)</span><span style=color:#81a1c1>?</span><span style=color:#eceff4>;</span></span>
<span class=giallo-l><span style=color:#81a1c1>                    self.</span><span style=color:#88c0d0>rename_current</span><span style=color:#eceff4>(</span><span>line</span><span style=color:#eceff4>)</span><span style=color:#81a1c1>?</span><span style=color:#eceff4>;</span></span>
<span class=giallo-l><span style=color:#eceff4>                }</span></span>
<span class=giallo-l><span style=color:#616e88>                // cancel</span></span>
<span class=giallo-l><span style=color:#eceff4>                (</span><span>_</span><span style=color:#eceff4>,</span><span style=color:#88c0d0;font-weight:700> key!</span><span style=color:#eceff4>(</span><span style=color:#8fbcbb>Esc</span><span style=color:#eceff4>))</span><span style=color:#81a1c1> =></span><span style=color:#eceff4> {}</span></span>
<span class=giallo-l><span style=color:#616e88>                // continue input</span></span>
<span class=giallo-l><span>                _</span><span style=color:#81a1c1> =></span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span>                    prompt</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>handle_event</span><span style=color:#eceff4>(</span><span style=color:#81a1c1>&</span><span>Event</span><span style=color:#81a1c1>::</span><span style=color:#88c0d0>Key</span><span style=color:#eceff4>(</span><span style=color:#81a1c1>*</span><span>event</span><span style=color:#eceff4>),</span><span> cx</span><span style=color:#eceff4>);</span></span>
<span class=giallo-l><span style=color:#81a1c1>                    self.</span><span>prompt </span><span style=color:#81a1c1>=</span><span style=color:#8fbcbb> Some</span><span style=color:#eceff4>((</span><span>action</span><span style=color:#eceff4>,</span><span> prompt</span><span style=color:#eceff4>));</span></span>
<span class=giallo-l><span style=color:#eceff4>                }</span></span>
<span class=giallo-l><span style=color:#eceff4>            }</span></span>
<span class=giallo-l><span style=color:#8fbcbb>            Ok</span><span style=color:#eceff4>(</span><span style=color:#8fbcbb>EventResult</span><span style=color:#81a1c1>::</span><span style=color:#88c0d0>Consumed</span><span style=color:#eceff4>(</span><span style=color:#8fbcbb>None</span><span style=color:#eceff4>))</span></span>
<span class=giallo-l><span style=color:#eceff4>        })();</span></span>
<span class=giallo-l><span style=color:#81a1c1>        match</span><span> result</span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span style=color:#8fbcbb>            Ok</span><span style=color:#eceff4>(</span><span>event_result</span><span style=color:#eceff4>)</span><span style=color:#81a1c1> =></span><span> event_result</span><span style=color:#eceff4>,</span></span>
<span class=giallo-l><span style=color:#8fbcbb>            Err</span><span style=color:#eceff4>(</span><span>err</span><span style=color:#eceff4>)</span><span style=color:#81a1c1> =></span><span style=color:#eceff4> {</span></span>
<span class=giallo-l><span>                cx</span><span style=color:#81a1c1>.</span><span>editor</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>set_error</span><span style=color:#eceff4>(</span><span>err</span><span style=color:#81a1c1>.</span><span style=color:#88c0d0>to_string</span><span style=color:#eceff4>());</span></span>
<span class=giallo-l><span style=color:#8fbcbb>                EventResult</span><span style=color:#81a1c1>::</span><span style=color:#88c0d0>Consumed</span><span style=color:#eceff4>(</span><span style=color:#8fbcbb>None</span><span style=color:#eceff4>)</span></span>
<span class=giallo-l><span style=color:#eceff4>            }</span></span>
<span class=giallo-l><span style=color:#eceff4>        }</span></span>
<span class=giallo-l><span style=color:#eceff4>}</span></span></code></pre><p>ãªãŠã€helixå´ã§ç®¡ç†ã—ã¦ã„ãŸfileã‚’å‰Šé™¤ã™ã‚‹éš›ã¯ã€helixæœ¬ä½“ã®cleanupå‡¦ç†ã‚’å‘¼ã¶å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚<br> ã“ã®ã‚ãŸã‚Šã¯æœ€æ–°ã®masterã‚’åæ˜ ã™ã‚‹éš›ã«å¾Œå‡¦ç†ã®æ­£ã—ã•ã«è²¬ä»»ã‚’ã‚‚ã¤å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚<h2 id=shi-ifang><a aria-label="Anchor link for: shi-ifang" class=zola-anchor href=#shi-ifang>ä½¿ã„æ–¹</a></h2><p>æœ€å¾Œã«ä»Šå›forkã—ã¦å¤‰æ›´ã—ãŸexplorerç‰ˆhelixã¯Nix userã§ã‚ã‚Œã°ä»¥ä¸‹ã®ã‚ˆã†ã«ã—ã¦åˆ©ç”¨ã§ãã¾ã™ã€‚<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=shellscript><span class=giallo-l><span style=color:#88c0d0>nix</span><span style=color:#a3be8c> profile install github:ymgyt/helix/explorer</span></span></code></pre><h2 id=matome><a aria-label="Anchor link for: matome" class=zola-anchor href=#matome>ã¾ã¨ã‚</a></h2><p>ç°¡å˜ã«ã§ã™ãŒã€<a href=https://github.com/helix-editor/helix rel=external>Helix</a>ã«file explorerã‚’ç§»æ¤ã—ãŸéš›ã®æ¦‚è¦ã«ã¤ã„ã¦æ›¸ã„ã¦ã¿ã¾ã—ãŸã€‚<br> è‡ªå‰ã®componentã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã§ã€å†…éƒ¨æ§‹é€ ãŒå°‘ã—ã ã‘ã‚ã‹ã‚Šæ¥½ã—ã‹ã£ãŸã§ã™ã€‚</div></article></main><footer class=blog-footer><p>Â© 2026 <a href=https://blog.ymgyt.io> ymgyt </a> | Made with <a href=https://www.getzola.org rel=noopener target=_blank>Zola</a> | <a href=https://github.com/ymgyt/blog>Repository</a> | <a href=https://blog.ymgyt.io/atom.xml target=_blank title=rss> <svg viewbox="0 0 24 24" class=icon fill=none height=24 stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 width=24 xmlns=http://www.w3.org/2000/svg><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx=5 cy=19 r=1></circle></svg> </a></footer></div></div>